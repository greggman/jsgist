{"version":3,"sources":["libs/SubscriptionManager.ts","globals.js","libs/StorageManager.ts","scrollbars.js","components/EditLine.js","libs/GitHub.js","components/Head.js","components/Dialog.js","components/Help.js","libs/css-utils.js","ServiceContext.js","components/Log.js","libs/url.js","libs/WindowMessageManager.ts","components/Runner.js","libs/model.js","libs/start-query.js","libs/ui-model.js","components/Layout1.js","components/CodeCodeMirror.js","libs/utils.ts","components/CodeMonaco.js","components/Code.js","components/CodeArea.js","components/File.js","components/Files.js","components/Layout3Vertical.js","components/Layout3Horizontal.js","components/Layout2x2.js","components/LayoutTabbed.js","components/IDE.js","libs/gists.js","components/LoadGist.tsx","components/LoadJSON.js","components/LoadURL.js","components/Section.js","components/Load.js","libs/compression.js","libs/loader.js","components/Embed.js","components/Export.js","components/SaveAsGist.js","components/SaveAsJSON.js","components/SaveAsURL.js","components/Save.js","components/Settings.js","components/Toolbar.js","libs/UserManager.js","components/App.js","components/BackupManager.js","libs/OAuthManager.ts","serviceWorker.js","index.js","icons/vertical-layout.svg","icons/horizontal-layout.svg","icons/two-by-two-layout.svg","icons/tabbed-layout.svg"],"names":["SubscriptionManager","itemToSubscriptionMap","this","Map","item","fn","unsubscribe","fns","get","set","push","ndx","indexOf","splice","length","delete","slice","storageManager","prefix","subscriptionManager","_handleNewValue","e","key","startsWith","unPrefixedKey","substr","notify","window","addEventListener","subscribe","session","k","_addPrefix","v","sessionStorage","getItem","localStorage","value","setItem","removeItem","removeEventListener","parent","document","createElement","setAttribute","classList","add","child","appendChild","body","firstChild","clientWidth","removeChild","EditLine","props","type","onChange","target","placeholder","emptyValue","getEmptyFileHack","file","content","getGistContent","gist","data","JSON","parse","files","filenames","map","name","Object","entries","filter","concat","createGistData","secret","gist_id","reduce","trim","saveData","jsGistData","keys","stringify","lowerCaseFiles","n","toLowerCase","includes","location","origin","filename","description","public","GitHub","pat","user","unAuthorizedOctokit","Octokit","userAgent","userData","owner","login","avatarURL","avatar_url","undefined","getUserData","assign","event","Event","dispatchEvent","authorizedOctokit","auth","users","getAuthenticated","response","status","Error","message","since","paginate","gists","list","per_page","octokit","rawData","gistData","create","_updateUserData","updateGist","id","update","date","updated_at","fork","result","createComment","EventTarget","Head","className","rel","href","src","alt","hostname","Dialog","handleKeyDown","keyCode","onClose","title","children","onClick","tabIndex","stopPropagation","React","Component","Help","camelCaseRE","toDash","_","left","right","camelCaseToDash","s","replace","classNames","names","args","arg","join","ServiceContext","createContext","LogManager","clear","_msgs","_notify","_addMsg","lastData","oldMsg","newMsg","isMsgSame","count","addMsg","addMsgs","msgs","showStack","Log","handleChange","forceUpdate","logMessagesRef","createRef","context","logManager","prevProps","prevState","snapshot","elem","current","scrollTop","scrollHeight","parentElement","clientHeight","onGoToLine","ref","getMsgs","msg","tooltip","section","fileLink","data-tooltip","url","lineNo","lastIndexOf","basename","createURL","base","params","URL","searchParams","URLSearchParams","search","toString","contextType","nullHandlers","fromToHandlersMap","on","from","remove","handlers","size","callHandler","source","Runner","handleJSLog","handleJSError","handleJSUnhandledRejection","handleInfoMessages","handleGimmeDaCodez","iframe","contentWindow","postMessage","handleMessage","runnerRef","registerAPI","debug","fromEntries","extra","run","blank","removeIFrame","style","background","winMsgMgr","validator","Ajv","compile","schema","trackedValues","getValueOrMakeNew","trackedValue","subscriptions","Set","initialValue","newValue","newTestData","getBlankData","getData","incVersion","incDataVersion","incFilesVersion","setFileName","newName","setFileContent","setData","newData","errors","dataPath","validate","settings","query","canMonaco","codeMirror","test","navigator","initialized","defaultSettings","layout","screen","width","height","editor","lineNumbers","tabs","showWhitespace","json","model","init","uiStateValidator","Layout","onSetVSizes","sizes","setState","vSizes","uiModel","state","registerRunnerAPI","direction","minSize","onSetSizes","handleGoToLine","darkMatcher","matchMedia","noop","CodeCodeMirror","registerEditor","setOption","Tab","cm","str","padEnd","getOption","replaceSelection","hackKey","goToLine","colNo","focus","doc","setCursor","refresh","options","onValueChange","ui","isDarkMode","matches","codeMirrorOptions","mode","scrollbarStyle","theme","matchBrackets","matchTags","onBeforeChange","editorDidMount","findNdx","endings","ending","findIndex","endsWith","getOrFindNdx","f","getOrFind","sep","getText","a","fetch","req","text","addTypes","monaco","languages","typescript","javascriptDefaults","addExtraLib","once","CodeMonaco","handleEditorDidMount","getModel","updateOptions","tabSize","setPosition","lineNumber","column","revealPosition","language","split","pop","codeMirrorModeToLanguage","onMount","minimap","enabled","glyphMargin","folding","insertSpaces","renderWhitespace","Code","newProps","CodeArea","heading","File","handleRegisterAPI","api","codeAPI","register","unregister","mimeType","mime","lookup","Files","kUIStateKey","handleRegister","handleUnregister","fileToKeyMap","uiStateKey","i","Date","now","Math","random","forEach","computeNewSizesFn","moveGuttersComputeNewSizes","getFileKey","desc","onTitleChange","Layout3Vertical","onSetHSizes","hSizes","registerFilesAPI","filesAPI","Layout3Horizontal","onSetTSizes","tSizes","onSetBSizes","bSizes","NamedFile","Layout2x2","onSetV1Sizes","v1Sizes","onSetV2Sizes","v2Sizes","mainHTMLNdx","mainJSNdx","mainCSSNdx","fixSizes","lastSizes","show","oldSize","availableSpace","len","sum","newSizes","layoutModes","setSizes","currentNdx","showResult","showLow","handleOnChange","toggleShowLog","showLog","toggleShowResult","previousNdx","resultStyle","display","logStyle","Fragment","checked","htmlFor","IDE","fullscreen","layoutMode","Layout1","gistSchema","gistsSchema","ajv","gistsValidator","gistValidator","getStoredGists","addGist","_public","locallySaved","saveGistsToLocalStorage","removeGist","setGists","gistsToSortedArray","checks","sortKey","sortDir","compareDirMult","compFn","b","ap","bp","sign","has","getSortFn","sort","SortBy","selected","getDateOfNewestNonLocallySavedGist","gistsById","values","LoadGist","handleNewGists","toggleCheck","onUserStatusChange","userManager","loadGists","updateSort","console","log","shift","shiftKey","handleKeyUp","addError","github","loading","existingGists","getUserGists","gistArray","deleteSelected","_gists","ids","deleteGist","clearBackup","backupManager","canLoad","disabled","dir","substring","matchFilter","encodeURIComponent","renderLoad","renderLogin","LoadJSON","useState","setJSON","useContext","onLoad","LoadURL","setUrl","Section","Load","utf8Encoder","TextEncoder","utf8Decoder","TextDecoder","isCompressedBase64","compressedBase64ToJSON","isCompressed","base64","raw","Uint8Array","decode","bin","inflate","idRE","isGistId","loadGistFromSrc","getGist","res","Embed","gistId","exampleId","userSelect","indent4","Export","asModule","exportToCodepen","mainHTML","mainJS","mainCSS","pen","editors","html","css","js","innerHTML","querySelector","submit","openInCodepen","exportToJSFiddle","openInJSFiddle","overflow","makeSnippet","module","makeHTML","SaveAsGist","onPatChange","toggleSecret","saveNew","saving","onSave","success","createGist","saveOverExisting","forkAndSave","forkGist","newId","gistOwnerId","canUpdate","canFork","data-type","renderSave","SaveAsJSON","SaveAsURL","encode","compressed","deflate","useCompressed","jsonToCompressedBase64","class","Save","RadioOption","radioSelected","Radio","newChildren","Children","isValidElement","isSelected","cloneElement","Checkbox","label","elemId","Logout","handleLogout","logout","Settings","handleLayoutChange","handleEditorChange","handleLineNumbersChange","handleTabsChange","handleShowWhitespaceChange","verticalIcon","horizontalIcon","twoByTwoIcon","tabbedIcon","Toolbar","toolbarFns","handleRun","handleStop","handleSave","handleNew","handleLoad","handleFullscreen","handleSettings","handleHelp","UserManager","oauthManager","_handleNewAuth","setPat","getAuthenticatedUser","noJSX","App","handleUIChange","handleNewGist","warn","error","messages","setTimeout","addInfo","closeDialog","dialog","runnerAPI","setBackup","renderSettings","renderHelp","handleOnLoad","handleOnSave","history","pushState","handleAbort","abort","path","pathname","dark","updateVersion","cleanup","newGist","opener","backup","getBackup","loaded","loadData","updateTitle","firstTry","Provider","BackupManager","getTokenURL","process","OAuthManager","_popup","_state","_storageManager","requestToken","client","code","access_token","_closePopup","client_id","scope","config","top","screenY","outerHeight","screenX","outerWidth","open","createPopup","close","Boolean","match","ReactDOM","render","StrictMode","getElementById","serviceWorker","ready","then","registration","catch","exports"],"mappings":"0LACqBA,E,WAEnB,aAAe,yBADfC,2BACc,EACZC,KAAKD,sBAAwB,IAAIE,I,sDAEzBC,EAAcC,GACtBH,KAAKI,YAAYF,EAAMC,GACvB,IAAIE,EAAML,KAAKD,sBAAsBO,IAAIJ,GACpCG,IACHA,EAAM,GACNL,KAAKD,sBAAsBQ,IAAIL,EAAMG,IAEvCA,EAAIG,KAAKL,K,kCAECD,EAAcC,GACxB,IAAME,EAAML,KAAKD,sBAAsBO,IAAIJ,GAC3C,GAAIG,EAAK,CACP,IAAMI,EAAMJ,EAAIK,QAAQP,GACpBM,GAAO,IACTJ,EAAIM,OAAOF,EAAK,GACG,IAAfJ,EAAIO,QACNZ,KAAKD,sBAAsBc,OAAOX,O,6BAKnCA,GACL,IAAMG,EAAML,KAAKD,sBAAsBO,IAAIJ,GAC3C,GAAIG,EAAK,CAAC,IAAD,gBACUA,EAAIS,SADd,IACP,2BAA8B,EAC5BX,EAD4B,YADvB,oC,KC1BN,IAAMY,EAAiB,I,WCG5B,WAAYC,GAAiB,IAAD,gCAH5BA,YAG4B,OAF5BC,yBAE4B,OAKpBC,gBAAkB,SAACC,GACzB,IAAMC,EAAMD,EAAEC,IACd,GAAIA,GAAOA,EAAIC,WAAW,EAAKL,QAAS,CACtC,IAAMM,EAAgBF,EAAIG,OAAO,EAAKP,OAAOJ,QAC7C,EAAKK,oBAAoBO,OAAOF,KARlCtB,KAAKgB,OAAL,UAAiBA,EAAjB,KACAhB,KAAKiB,oBAAsB,IAAInB,EAC/B2B,OAAOC,iBAAiB,UAAW1B,KAAKkB,iB,uDASvBE,GACjB,MAAM,GAAN,OAAUpB,KAAKgB,QAAf,OAAwBI,K,gCAEhBA,EAAajB,GACrBH,KAAKiB,oBAAoBU,UAAUP,EAAKjB,K,kCAE9BiB,EAAajB,GACvBH,KAAKiB,oBAAoBb,YAAYgB,EAAKjB,K,0BAExCiB,GAA+B,IAAlBQ,EAAiB,wDAC1BC,EAAI7B,KAAK8B,WAAWV,GAC1B,GAAIQ,EAAS,CACX,IAAMG,EAAIC,eAAeC,QAAQJ,GACjC,GAAIE,EACF,OAAOA,EAGX,OAAOG,aAAaD,QAAQJ,K,0BAE1BT,EAAae,GAAiC,IAAlBP,EAAiB,wDACzCC,EAAI7B,KAAK8B,WAAWV,GACtBQ,GACFI,eAAeI,QAAQP,EAAGM,GAE5BD,aAAaE,QAAQP,EAAGM,GACxBnC,KAAKiB,oBAAoBO,OAAOJ,K,6BAE3BA,GAA+B,IAAlBQ,EAAiB,wDAC7BC,EAAI7B,KAAK8B,WAAWV,GACtBQ,GACFI,eAAeK,WAAWR,GAE5BK,aAAaG,WAAWR,GACxB7B,KAAKiB,oBAAoBO,OAAOJ,K,gCAGhCK,OAAOa,oBAAoB,UAAWtC,KAAKkB,qB,KDnDjB,CAAmB,UEG3CqB,G,YAASC,SAASC,cAAc,QACtCF,EAAOG,aAAa,QAAS,2BAC7BH,EAAOI,UAAUC,IAAI,kBAErB,IAAMC,EAAQL,SAASC,cAAc,OACrCI,EAAMH,aAAa,QAAS,0BAC5BH,EAAOO,YAAYD,GACnBL,SAASO,KAAKD,YAAYP,GAIH,GAAKA,EAAOS,WAAWC,aAE5CT,SAASO,KAAKJ,UAAUC,IAAI,8BAG9BJ,SAASO,KAAKG,YAAYX,G,iDCpBX,SAASY,EAASC,GAC/B,OACE,2BACEC,KAAK,OACLC,SAAU,SAACnC,GAAOiC,EAAME,SAASnC,EAAEoC,OAAOpB,QAC1CqB,YAAaJ,EAAMI,YACnBrB,MAAOiB,EAAMjB,Q,mCCLbsB,EAAa,iDAEnB,SAASC,EAAiBC,GACxB,OAAOA,EAAKC,QAAQvC,WAAWoC,GACfE,EAAKC,QAAQrC,OAAOkC,EAAW7C,QAC/B+C,EAAKC,QAShB,SAASC,EAAeC,GAC7B,IAAMC,EAAOC,KAAKC,MAAMH,EAAKI,MAAM,eAAeN,SAqBlD,OAlBIG,EAAKI,UACPJ,EAAKG,MAAQH,EAAKI,UAAUC,KAAI,SAAAC,GAC9B,MAAO,CACLA,KAAMA,EACNT,QAASF,EAAiBI,EAAKI,MAAMG,QAKzCN,EAAKG,MAAQI,OAAOC,QAAQT,EAAKI,OAC9BM,QAAO,kBAAqB,gBAArB,uBACPJ,KAAI,YAAmB,IAAD,mBACrB,MAAO,CACLC,KAFmB,KAGnBT,QAASF,EAHU,UAKpBe,OAAOV,EAAKG,OAAS,IAErBH,EAmKT,SAASW,EAAeX,EAAMY,EAAQC,GACpC,IAAIV,EAAQH,EAAKG,MAAMW,QAAO,SAACX,EAAOP,GAIpC,OAHAO,EAAMP,EAAKU,MAAQ,CACjBT,QAASD,EAAKC,QAAQkB,OAASnB,EAAKC,QAA3B,UAAwCH,GAAxC,OAAqDE,EAAKC,UAE9DM,IACN,IACGa,EAAQ,eACThB,GAECiB,EAAa,GAanB,GAZAd,EAAM,eAAiBc,EACEV,OAAOW,KAAKf,GAAOtD,SAAWmD,EAAKG,MAAMtD,OAAS,UAElEmE,EAASb,MAChBa,EAASZ,UAAYJ,EAAKG,MAAME,KAAI,qBAAEC,SAGtCH,EAAQ,CACN,cAAec,GAGnBA,EAAWpB,QAAUI,KAAKkB,UAAUH,GAChCH,EAAS,CAIX,IAAMO,EAAiBb,OAAOW,KAAKf,GAAOE,KAAI,SAAAgB,GAAC,OAAIA,EAAEC,iBAKrD,KAHIF,EAAeG,SAAS,cACxBH,EAAeG,SAAS,eACxBH,EAAeG,SAAS,WACZ,CACd,IAAM1B,EAAO,aAASG,EAAKM,KAAd,gCAA0C5C,OAAO8D,SAASC,OAA1D,gBAAwEZ,EAAxE,KACbV,EAAM,aAAe,CAACN,WAIxB,cAA+BU,OAAOC,QAAQL,GAA9C,eAAsD,CAAC,IAAD,sBAA1CuB,EAA0C,UAC/CA,SAAWA,GAGpB,OAAO,yBACLvB,QACAwB,YAAa3B,EAAKM,OACbO,GAAW,CAACe,QAAShB,IACtBC,GAAW,CAACA,Y,IAICgB,E,kDACnB,aAAe,IAAD,8BACZ,gBACKC,IAAM,GACX,EAAKC,KAAO,GACZ,EAAKC,oBAAsB,IAAIC,IAAQ,CACrCC,UAhQY,kBA2PF,E,4DAYElC,GACd,IAAMmC,EAzEH,SAAqBnC,GAC1B,OAAQA,GAAQA,EAAKoC,MACf,CACE9B,KAAMN,EAAKoC,MAAMC,MACjBC,UAAWtC,EAAKoC,MAAMG,iBAExBC,EAmEaC,CAAYzC,GAC7B,GAAImC,EAAU,CACZ5B,OAAOmC,OAAOzG,KAAK8F,KAAMI,GACzB,IAAMQ,EAAQ,IAAIC,MAAM,YACxBD,EAAM3C,KAAN,eAAiB/D,KAAK8F,MACtB9F,KAAK4G,cAAcF,M,6BAGhBb,GACDA,IAAQ7F,KAAK6F,MACf7F,KAAK6F,IAAMA,EAET7F,KAAK6G,kBADHhB,EACuB,IAAIG,IAAQ,CACnCc,KAAMjB,EACNI,UAtRQ,uBAyReM,K,6KAyCNvG,KAAK6G,kBAAkBE,MAAMC,mB,UAC5B,OADlBC,E,QACOC,O,sBACL,IAAIC,MAAMF,EAASG,S,gCAEpBH,EAASlD,M,kLAGCsD,G,uFACGrH,KAAK6G,kBAAkBS,SACvCtH,KAAK6G,kBAAkBU,MAAMC,KADb,aAGdC,SAAU,KACNJ,GAAS,CAACA,W,cAJdE,E,yBAMCA,EAAM/C,QAAO,SAAAV,GAAI,QAAMA,EAAKI,MAAM,mB,8KAI7BU,G,gFAGN8C,EAAU1H,KAAK6G,mBAAqB7G,KAAK0H,Q,SAC5BA,EAAQH,MAAMjH,IAAI,CAACsE,Y,cAAhCd,E,yBACC,CACLC,KAAMF,EAAeC,EAAKC,MAC1B4D,QAAS7D,EAAKC,O,iLAIDA,G,8FAAMY,E,gCAIfiD,EAAWlD,EAAeX,EAAMY,G,SACnB3E,KAAK6G,kBAAkBU,MAAMM,OAAOD,G,cAAjD9D,E,OACN9D,KAAK8H,gBAAgBhE,EAAKC,M,SACb/D,KAAK+H,WAAWjE,EAAKC,KAAKiE,GAAIjE,G,yNAE5Ba,EAASb,G,gFAClB6D,EAAWlD,EAAeX,GAAM,EAAOa,G,SAC1B5E,KAAK6G,kBAAkBU,MAAMU,OAAOL,G,cAAjD9D,E,yBACC,CACLkE,GAAIlE,EAAKC,KAAKiE,GACd3D,KAAMP,EAAKC,KAAK2B,YAChBwC,KAAMpE,EAAKC,KAAKoE,WAChBxC,OAAQ7B,EAAKC,KAAK4B,S,iLAGPf,G,uFACM5E,KAAK6G,kBAAkBU,MAAMa,KAAK,CAACxD,Y,cAAhDd,E,yBACC,CACLkE,GAAIlE,EAAKC,KAAKiE,K,iLAGDpD,G,uFACM5E,KAAK6G,kBAAkBU,MAAM1G,OAAO,CAAC+D,Y,cAApDyD,E,yBACCA,G,wLAEezD,EAAS7B,G,uFACV/C,KAAK6G,kBAAkBU,MAAMe,cAAc,CAC9D1D,UACA7B,S,aAFIsF,E,QAIKnB,OAAS,KAAOmB,EAAOnB,QAAU,K,sBACpC,IAAIC,MAAMkB,EAAOjB,S,gCAElBiB,EAAOtE,M,uIAhId,OAAO/D,KAAK6G,mBAAqB7G,KAAK+F,wB,eAVNwC,cC1PrB,SAASC,IACtB,OACE,yBAAKC,UAAU,QACb,6BACE,uBAAGlF,OAAO,SAASmF,IAAI,sBAAsBC,KAAMlH,OAAO8D,SAASC,QACnE,yBAAKoD,IAAI,mCAAmCC,IAAI,SACjDpH,OAAO8D,SAASuD,WAEjB,yBAAKL,UAAU,uBACb,yBAAKA,UAAU,WACb,uBAAGlF,OAAO,SAASmF,IAAI,sBAAsBC,KAAK,uCAChD,yBAAKE,IAAI,SAASD,IAAI,2C,ICXbG,E,4MAOnBC,cAAgB,SAAC7H,GACG,KAAdA,EAAE8H,SACJ,EAAK7F,MAAM8F,W,kEAPbzH,OAAOC,iBAAiB,UAAW1B,KAAKgJ,iB,6CAGxCvH,OAAOa,oBAAoB,UAAWtC,KAAKgJ,iB,+BAOnC,IAAD,EAC4ChJ,KAAKoD,MAAjD+F,EADA,EACAA,MAAOC,EADP,EACOA,SAAUF,EADjB,EACiBA,QADjB,IAC0BT,iBAD1B,MACsC,GADtC,EAEP,OACE,yBAAKY,QAASH,EAAST,UAAS,UAAKA,EAAL,YAC9B,yBACEa,SAAS,KACTD,QAAS,SAAClI,GAAMA,EAAEoI,oBAElB,yBAAKd,UAAU,kBACb,yBAAKA,UAAU,gBAAgBU,GAC/B,yBAAKV,UAAU,gBACb,4BAAQY,QAASH,GAAjB,OAGJ,yBAAKT,UAAU,kBACZW,S,GA3BuBI,IAAMC,WCC3B,SAASC,EAAKtG,GAAQ,IAC5B8F,EAAW9F,EAAX8F,QACP,OACE,kBAAC,EAAD,CAAQC,MAAM,SAASD,QAASA,GAC9B,yBAAKT,UAAU,YACf,0EACA,yDACA,2BACE,uBAAGlF,OAAO,SAASmF,IAAI,sBAAsBC,KAAK,sCAAlD,uCAEF,uCAAY,uBAAGpF,OAAO,SAASmF,IAAI,sBAAsBC,KAAK,yBAAlD,kBACZ,sCACA,wEACA,4BACE,mEACA,2DACE,2FAEC,6CAFD,kDAIA,gFAGA,uDAC0B,qEAD1B,KAGA,uCACU,uBAAGpF,OAAO,SAASmF,IAAI,sBAAsBC,KAAK,4DAAlD,8DAGZ,+DACE,uKAGgB,+DAHhB,4CAOF,4DACE,qH,8CC1CJgB,EAAc,kBACdC,EAAS,SAACC,EAAGC,EAAMC,GAAV,gBAAuBD,EAAvB,YAA+BC,IACxCC,EAAkB,SAAAC,GAAC,OAAIA,EAAEC,QAAQP,EAAaC,GAAQvE,eAErD,SAAS8E,IAAoB,IAClC,IAAMC,EAAQ,GADoB,mBAANC,EAAM,yBAANA,EAAM,gBAElC,cAAkBA,EAAlB,eAAwB,CAAnB,IAAMC,EAAG,KACZ,GAAmB,kBAARA,EACTF,EAAM5J,KAAK8J,QAEX,cAA2BhG,OAAOC,QAAQ+F,GAA1C,eAAgD,CAAC,IAAD,sBAApClJ,EAAoC,KAA/Be,EAA+B,KAC1CA,GACFiI,EAAM5J,KAAKwJ,EAAgB5I,KAKnC,OAAOgJ,EAAMG,KAAK,KCfpB,IACeC,EADQhB,IAAMiB,gBCwBtB,IAAMC,EAAb,kDACE,aAAe,IAAD,8BACZ,gBAMFC,MAAQ,WACN,EAAKC,MAAQ,GACb,EAAKC,WATO,EAWdC,QAAU,SAAC/G,GACT,IAAMgH,EAAW,EAAKH,MAAM,EAAKA,MAAMhK,OAAS,IA7BpD,SAAmBoK,EAAQC,GACzB,KAAMD,MAAaC,EACjB,OAAO,EAET,IAAMhG,EAAOX,OAAOW,KAAK+F,GAAQxG,QAAO,SAAApD,GAAG,MAAY,UAARA,KAC/C,GAAI6D,EAAKrE,SAAW0D,OAAOW,KAAKgG,GAAQrK,OACtC,OAAO,EANwB,oBAQfqE,GARe,IAQjC,2BAAwB,CAAC,IAAd7D,EAAa,QACtB,GAAI4J,EAAO5J,KAAS6J,EAAO7J,GACzB,OAAO,GAVsB,8BAajC,OAAO,EAiBD8J,CAAUH,EAAUhH,GAGtB,EAAK6G,MAAMpK,KAAKuD,GAFhBgH,EAASI,OAASJ,EAASI,OAAS,GAAK,GAd/B,EAmBdC,OAAS,SAACrH,GACR,EAAK+G,QAAQ/G,GACb,EAAK8G,WArBO,EAuBdQ,QAAU,SAACC,GAAU,IAAD,gBACSA,GADT,IAClB,2BAAiC,CAAC,IAAD,UAArBjI,EAAqB,EAArBA,KAAMU,EAAe,EAAfA,KAChB,OAAQV,GACN,IAAK,UAGL,IAAK,uBACH,EAAKyH,QAAL,2BAAiB/G,GAAjB,IAAuBV,KAAM,QAASkI,WAAW,KACjD,MACF,QACE,EAAKT,QAAQ/G,KAVD,8BAclB,EAAK8G,WAnCL,EAAKD,MAAQ,GAFD,EADhB,sDAMI5K,KAAK4G,cAAc,IAAID,MAAM,aANjC,gCAyCI,OAAO3G,KAAK4K,UAzChB,eAAgCrC,cA6CXiD,E,kDACnB,WAAYpI,GAAQ,IAAD,8BACjB,cAAMA,IAGRqI,aAAe,WACb,EAAKC,eAHL,EAAKC,eAAiBnC,IAAMoC,YAFX,E,gEAQI5L,KAAK6L,QAAnBC,WACIpK,iBAAiB,SAAU1B,KAAKyL,gB,6CAGtBzL,KAAK6L,QAAnBC,WACIxJ,oBAAoB,SAAUtC,KAAKyL,gB,yCAE7BM,EAAWC,EAAWC,GACvC,GAAiB,OAAbA,GAGEA,EAAW,EAAG,CAChB,IAAMC,EAAOlM,KAAK2L,eAAeQ,QACjCD,EAAKE,UAAYF,EAAKG,aAAeH,EAAKI,cAAcC,gB,8CAItCR,EAAWC,GACjC,IAAME,EAAOlM,KAAK2L,eAAeQ,QACjC,OAAOD,EAAKG,cAAgBH,EAAKE,UAAYF,EAAKI,cAAcC,gB,+BAExD,IACDC,EAAcxM,KAAKoD,MAAnBoJ,WACAV,EAAc9L,KAAK6L,QAAnBC,WACP,OACE,yBAAKrD,UAAU,UACb,yBAAKA,UAAU,gCAAgCgE,IAAKzM,KAAK2L,gBACrDG,EAAWY,UAAUtI,KAAI,SAACuI,EAAKlM,GAC7B,IAAMmM,GAAWD,EAAIE,QACrB,OACE,yBAAKpE,UAAW0B,EAAW,WAAD,eAAcwC,EAAItJ,MAAO,IAAQjC,IAAG,WAAMX,IAClE,yBAAKgI,UAAWkE,EAAIxB,MAAQ,QAAU,YAAawB,EAAIxB,MAAQwB,EAAIxB,MAAQ,IAC3E,yBAAK1C,UAAU,OACZkE,EAAIA,IACL,sCAFF,IAGE,yBACElE,UAAW0B,EAAW,OAAQ,CAACyC,UAASE,SAAUH,EAAIE,UACtDxD,QAAS,kBAAMmD,EAAWG,IAC1BI,eAAA,UAAiBJ,EAAIE,SAAWF,EAAIK,IAApC,YAA2CL,EAAIM,SAE9CN,EAAIE,SAnH3B,SAAkBG,GAChB,IAAMvM,EAAMuM,EAAIE,YAAY,KAC5B,OAAOzM,GAAO,EAAIuM,EAAIzL,OAAOd,EAAM,GAAKuM,EAiHJG,CAASR,EAAIK,KAAO,IALtC,IAK4CL,EAAIM,mB,GAjDnCzD,IAAMC,WCvEhC,SAAS2D,EAAUC,EAAMC,GAG9B,IAFA,IAAMN,EAAM,IAAIO,IAAIF,GACdG,EAAe,IAAIC,gBAAgBT,EAAIU,QAC7C,MAA2BpJ,OAAOC,QAAQ+I,GAA1C,eAAmD,CAAC,IAAD,sBAAvClM,EAAuC,KAAlCe,EAAkC,UACnCoE,IAAVpE,EACFqL,EAAa3M,OAAOO,GAEpBoM,EAAajN,IAAIa,EAAKe,GAI1B,OADA6K,EAAIU,OAASF,EAAaG,WACnBX,EAAIrE,KDyHb6C,EAAIoC,YAAcpD,EElIlB,IAAMqD,EAAkC,IAAI5N,IACtC6N,EAA2D,IAAI7N,IAAI,CAAC,CAAC,KAAM4N,KAE1E,SAASE,EAAG1K,EAAc2K,EAAqB7N,GACpD8N,EAAO5K,EAAM2K,EAAM7N,GACnB,IAAI+N,EAAWJ,EAAkBxN,IAAI0N,GAChCE,IACHA,EAAW,IAAIjO,IACf6N,EAAkBvN,IAAIyN,EAAME,IAE9B,IAAI7N,EAAM6N,EAAS5N,IAAI+C,GAClBhD,IACHA,EAAM,GACN6N,EAAS3N,IAAI8C,EAAMhD,IAErBA,EAAIG,KAAKL,GAGJ,SAAS8N,EAAO5K,EAAc2K,EAAqB7N,GACxD,IAAI+N,EAAWJ,EAAkBxN,IAAI0N,GACrC,GAAKE,EAAL,CAGA,IAAM7N,EAAM6N,EAAS5N,IAAI+C,GACzB,GAAIhD,EAAK,CACP,IAAMI,EAAMJ,EAAIK,QAAQP,GACpBM,GAAO,GACTJ,EAAIM,OAAOF,EAAK,GAEC,IAAfJ,EAAIO,SACNsN,EAASrN,OAAOwC,GACM,IAAlB6K,EAASC,MAAcH,GACzBF,EAAkBjN,OAAOmN,MAMjC,SAASI,EAAYF,EAA4B7K,EAAcU,GAC7D,IAAM1D,EAAM6N,EAAS5N,IAAI+C,GACzB,GAAIhD,EAAK,CAAC,IAAD,gBACUA,GADV,IACP,2BAAsB,EACpBF,EADoB,SACjB4D,IAFE,8BAIP,OAAO,EAET,OAAO,EAGTtC,OAAOC,iBAAiB,WAAW,SAACP,GAAqB,IAAD,EACjCA,EAAE4C,KAAhBV,EAD+C,EAC/CA,KAAMU,EADyC,EACzCA,KACPmK,EAAWJ,EAAkBxN,IAAIa,EAAEkN,QACrCH,GACEE,EAAYF,EAAU7K,EAAMU,IAIlCqK,EAAYP,EAAcxK,EAAMU,M,ICpDbuK,E,kDACnB,WAAYlL,GAAQ,IAAD,8BACjB,cAAMA,IAGRmL,YAAc,SAACxK,GACQ,EAAK8H,QAAnBC,WACIV,OAAOrH,IAND,EAQnByK,cAAgB,SAACzK,GACM,EAAK8H,QAAnBC,WACIV,OAAX,2BAAsBrH,GAAtB,IAA4BV,KAAM,QAASkI,WAAW,MAVrC,EAYnBkD,2BAA6B,SAAC1K,GACP,EAAK8H,QAAnBC,WACIV,OAAX,2BAAsBrH,GAAtB,IAA4BV,KAAM,QAASkI,WAAW,MAdrC,EAgBnBmD,mBAAqB,SAAC3K,GACC,EAAK8H,QAAnBC,WACIT,QAAQtH,IAlBF,EAoBnB4K,mBAAqB,WACnB,EAAKC,OAAOC,cAAcC,YAAY,CACpCzL,KAAM,MACNU,KAAM,EAAKA,MACV,MAxBc,EAsEnBgL,cAAgB,SAAC5N,GAAO,IAAD,EACCA,EAAE4C,KAAjBV,EADc,EACdA,KAAMU,EADQ,EACRA,KACP5D,EAAK,EAAK+N,SAAS7K,GACrBlD,GACFA,EAAG4D,IAxEL,EAAKiL,UAAYxF,IAAMoC,YAFN,E,gEA0BE,IAAD,OACXqD,EAAejP,KAAKoD,MAApB6L,YAEAC,EAAS5K,OAAO6K,YAAY,IAAI1B,gBAAgBhM,OAAO8D,SAASmI,QAAQnJ,WAAxE2K,MACDE,EAAK,eACLF,GAAS,CAACA,UAGhBD,EAAY,CACVI,IAAK,SAACtL,EAAMuL,GACV,EAAKvL,KAAOA,EACZ,EAAKwL,eACL,IAAMX,EAASpM,SAASC,cAAc,UACtC,EAAKmM,OAASA,EACdA,EAAOhG,IAEDwE,EAAU,sDAAD,aAAyDJ,IAAK,uCAA0CoC,IACnHE,IACFV,EAAOY,MAAMC,WAAa,QAE5B,EAAKT,UAAU7C,QAAQrJ,YAAY8L,MAGvCc,EAAa,eAAgB,KAAM1P,KAAK2O,oBACxCe,EAAa,QAAS,KAAM1P,KAAKuO,aACjCmB,EAAa,UAAW,KAAM1P,KAAKwO,eACnCkB,EAAa,uBAAwB,KAAM1P,KAAKyO,4BAChDiB,EAAa,eAAgB,KAAM1P,KAAK0O,sB,qCAGpC1O,KAAK4O,SACP5O,KAAK4O,OAAOX,SACZjO,KAAK4O,OAAOhG,IAAM,cAClB5I,KAAK4O,YAASrI,K,6CAIhBvG,KAAKuP,eACLG,EAAiB,eAAgB,KAAM1P,KAAK2O,oBAC5Ce,EAAiB,QAAS,KAAM1P,KAAKuO,aACrCmB,EAAiB,UAAW,KAAM1P,KAAKwO,eACvCkB,EAAiB,uBAAwB,KAAM1P,KAAKyO,4BACpDiB,EAAiB,eAAgB,KAAM1P,KAAK0O,sB,+BAU5C,OACE,yBAAKjG,UAAU,SAASgE,IAAKzM,KAAKgP,gB,GAhFJxF,IAAMC,WAqF1C6E,EAAOV,YAAcpD,E,YCtFfmF,GADM,IAAIC,KACMC,QAAQC,GAExBC,GAAgB,GAEtB,SAASC,GAAkB3L,GACzB,IAAM4L,EAAeF,GAAc1L,IAAS,CAC1C6L,cAAe,IAAIC,KAGrB,OADAJ,GAAc1L,GAAQ4L,EACfA,EAGF,SAASrN,GAAIyB,EAAM+L,GACxB,IAAMH,EAAeD,GAAkB3L,GAIvC,YAHqBkC,IAAjB6J,IACFH,EAAa9N,MAAQiO,GAEhBH,EAGF,SAAS3P,GAAI+D,GAClB,OAAO0L,GAAc1L,GAAMlC,MAGtB,SAAS5B,GAAI8D,EAAMgM,GACxB,IAAMJ,EAAeF,GAAc1L,GACnC,IAAK4L,EACH,MAAM,IAAI9I,MAAJ,+BAAkC9C,IAE1C4L,EAAa9N,MAAQkO,EACrB,IANkC,EAM5BhQ,EAAG,YAAO4P,EAAaC,cAAcjL,QANT,cAOjB5E,GAPiB,IAOlC,2BAAsB,EACpBF,EADoB,SACjBkQ,EAAUhM,IARmB,+BAY7B,SAAS1C,GAAU0C,EAAMlE,GACT6P,GAAkB3L,GAC1B6L,cAActN,IAAIzC,GAG1B,SAASC,GAAYiE,EAAMlE,GACX6P,GAAkB3L,GAC1B6L,cAAcrP,OAAOV,GAGpC,IA0DI4D,GA1DEuM,GAAc,CAClB,KAAQ,YACR,SAAY,GACZ,MAAS,CACP,CACEjM,KAAM,aACNT,QAAS,IAEX,CACES,KAAM,YACNT,QAAS,IAEX,CACES,KAAM,WACNT,QAAS,MAOR,SAAS2M,KACd,IAAMvD,EAAG,UAAMvL,OAAO8D,SAASC,OAAtB,8BACT,OAAOxB,KAAKC,MAAMD,KAAKkB,UAAU,CAC/B,KAAQ,SACR,SAAY,GACZ,MAAS,CACP,CACE,KAAQ,aACR,QAAU,IAEZ,CACE,KAAQ,YACR,QAAU,4IAAV,OAK4B8H,EAL5B,qTAiBF,CACE,KAAQ,WACR,QAAW,QAOZ,SAASwD,KACd,OAAOzM,GAOTnB,GAJ8B,cAIV,GACpBA,GAJgC,gBAIV,GACtBA,GAJ+B,eAIV,GAErB,IAAM6N,GAAa,SAAArP,GAAG,OAAIb,GAAIa,EAAKd,GAAIc,GAAO,IACxCsP,GAAiB,SAAA7G,GAAC,OAAI4G,GATE,gBAUxBE,GAAkB,SAAA9G,GAAC,OAAI4G,GARE,iBAyCxB,SAASG,GAAYnQ,EAAKoQ,GAC/B9M,GAAKG,MAAMzD,GAAK4D,KAAOwM,EACvBH,KAGK,SAASI,GAAerQ,EAAKmD,GAClCG,GAAKG,MAAMzD,GAAKmD,QAAUA,EAC1B8M,KAoBK,SAASK,GAAQC,IANjB,SAAkBjN,GACvB,IAAK4L,EAAU5L,GACb,MAAM,IAAIoD,MAAJ,2BAA8BwI,EAAUsB,OAAO7M,KAAI,SAAAjD,GAAC,gBAAOA,EAAEiG,QAAT,aAAqBjG,EAAE+P,eAKnFC,CAASH,GACTjN,GAAOiN,EA5DPP,GAX8B,iBAY9BC,KACAC,KAiEFI,GA3HS/M,KAAKC,MAAMD,KAAKkB,UAAUoL,MCvEnC,ICUIc,GDTWC,GADD/M,OAAO6K,YAAY,IAAI1B,gBAAgBhM,OAAO8D,SAASmI,QAAQnJ,WCOvE+M,IAAaD,GAAME,aAAgB,4BAA4BC,KAAKC,UAAUxL,WAEhFyL,IAAc,EAGZC,GAAkB,CACtBC,OAASnQ,OAAOoQ,OAAOC,MAAQ,KAAOrQ,OAAOoQ,OAAOE,OAAS,IAAO,EAAI,EACxEC,OAAQV,GAAY,SAAW,aAC/BW,aAAa,EACbC,MAAM,EACNC,gBAAgB,GAyBX,SAAS5R,GAAI8D,EAAMlC,GACxBiP,GAAS/M,GAAQlC,EACjB,IAAMiQ,EAAOpO,KAAKkB,UAAUkM,IAC5BrQ,EAAeR,IAzCG,cAyCc6R,GAAM,GACtCC,GAAU,WAAYjB,IAGjB,SAAS9Q,KAEd,OA/BF,WACE,IAAIoR,GAAJ,CAGAA,IAAc,EACd,IAEE,KADAN,GAAWpN,KAAKC,MAAMlD,EAAeT,IAtBrB,eAsBsC,KAEpD,MAAM,IAAI6G,MAAM,eAElB,MAAOhG,GACPiQ,GAAQ,eAAOO,IAEjB,cAA2BrN,OAAOC,QAAQoN,IAA1C,eAA4D,CAAC,IAAD,sBAAhDvQ,EAAgD,KAA3Ce,EAA2C,YAC/CA,WAAiBiP,GAAShQ,KACnCgQ,GAAShQ,GAAOe,KAepBmQ,GACOlB,GAGF,SAASzP,GAAUxB,GACxBkS,GAAgB,WAAYlS,GAGvB,SAASC,GAAYD,GAC1BkS,GAAkB,WAAYlS,GAnBhCkS,GAAU,WAAYjB,ICjCtB,IAUMmB,IADM,IAAI3C,KACaC,QARP,CACpB,KAAQ,SACR,WAAc,CACZ,UAAW,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,IAEzE,SAAY,CAAC,YAKM2C,G,kDACnB,WAAYpP,GAAQ,IAAD,uBACjB,cAAMA,IAMRqP,YAAc,SAACC,GACb,EAAKC,SAAS,CAACC,OAAQF,IACvBG,GAtBgB,UAsBS,EAAKC,QAP9B,IAAMA,EAAQD,KAAA,QAFG,OAGjB,EAAKC,MAAQP,GAAiBO,GAASA,EAAQ,CAC7CF,OAAQ,CAAC,IAAM,MAJA,E,qDAWT,IACDG,EAAqB/S,KAAKoD,MAA1B2P,kBACAH,EAAU5S,KAAK8S,MAAfF,OACP,OACE,kBAAC,IAAD,CAAOI,UAAU,WAAWC,QAAS,EAAGP,MAAOE,EAAQM,WAAYlT,KAAKyS,aACtE,kBAAC,EAAD,CAAQxD,YAAa8D,IACrB,kBAAC,EAAD,CAAKvG,WAAYxM,KAAKmT,sB,GAlBM3J,IAAMC,W,6BCCpC2J,I,kHAAc3R,OAAO4R,WACrB5R,OAAO4R,WAAW,gCAClB,IAGAC,GAAO,aAEQC,G,kDACnB,WAAYnQ,GAAQ,IAAD,uBACjB,cAAMA,IA2BRoQ,eAAiB,SAACxB,GAChB,EAAKA,OAASA,EACdA,EAAOyB,UAAU,YAAa,CAC5BC,IAAK,SAACC,GACJ,IAAMC,EAAM,EAAK1B,KAAO,KAAO,GAAG2B,OAAOF,EAAGG,UAAU,cAAgB,GACtEH,EAAGI,iBAAiBH,OAjCP,IAEVzR,EAAkBiB,EAAlBjB,MAAO6R,EAAW5Q,EAAX4Q,QAFG,OAGjB,EAAKlB,MAAQ,CAAC3Q,QAAO6R,WAHJ,E,gEAWE,IAAD,OACX/E,EAAejP,KAAKoD,MAApB6L,YACHA,GACFA,EAAY,CACVgF,SAAU,SAAChH,EAAQiH,GACjB,EAAKlC,OAAOmC,QACZ,EAAKnC,OAAOoC,IAAIC,UAAUpH,EAAS,EAAGiH,EAAQ,IAEhDI,QAAS,SAAAzK,GACP,EAAKmI,OAAOsC,WAEdH,MAAO,SAAAtK,GACL,EAAKmI,OAAOmC,a,+BAcV,IAAD,SAC0CnU,KAAKoD,MAD/C,IACAmR,eADA,MACU,GADV,MACcC,qBADd,MAC8BlB,GAD9B,EACoCmB,EADpC,EACoCA,GACpCtS,EAAUnC,KAAK8S,MAAf3Q,MACDuS,EAAatB,GAAYuB,QAC/B3U,KAAKkS,KAAOuC,EAAGvC,KACf,IAAM0C,EAAiB,aACrBC,KAAM,aACNC,eAAgB,UAChBC,MAAOL,EAAa,WAAa,UACjCM,eAAe,EACf/C,YAAawC,EAAGxC,aACZsC,EAAQvC,QAAUuC,EAAQvC,QAKhC,OAHI4C,EAAkBC,KAAKnU,QAAQ,SAAW,IAC5CkU,EAAkBK,WAAY,GAG9B,kBAAC,cAAD,CACE9S,MAAOA,EACPoS,QAASK,EACTM,eAAgB,SAAClD,EAAQjO,EAAM5B,GAC7B,EAAKwQ,SAAS,CAACxQ,WAEjBmB,SAAU,SAAC0O,EAAQjO,EAAM5B,GACvBqS,EAAcrS,IAEhBgT,eAAgBnV,KAAKwT,oB,gDA1DKpQ,EAAO0P,GAErC,OADoBA,EAAMkB,UAAY5Q,EAAM4Q,QAEvC,CAACA,QAAS5Q,EAAM4Q,QAAS7R,MAAOiB,EAAMjB,OACtC,S,GAVmCqH,IAAMC,W,SClBlD,SAAS2L,GAAQlR,EAAYmR,GAAmB,oBAEzBA,GAFyB,yBAEnCC,EAFmC,QAGtC7U,EAAMyD,EAAMqR,WAAU,SAAC5R,GAAD,OAAeA,EAAKU,KAAKgB,cAAcmQ,SAASF,EAAOjQ,kBACnF,GAAI5E,GAAO,EACT,MAAM,CAAN,EAAOA,IAHX,2BAA8B,CAAC,IAAD,yCAFgB,8BAQ9C,OAAQ,EAGH,SAASgV,GAAavR,EAAcG,GACzC,IAAM5D,EAAMyD,EAAMqR,WAAU,SAAAG,GAAC,OAAIA,EAAErR,KAAKgB,gBAAkBhB,EAAKgB,eAC/D,GAAI5E,GAAO,EACT,OAAOA,EAHoE,2BAAnB4U,EAAmB,iCAAnBA,EAAmB,kBAK7E,OAAOD,GAAQlR,EAAOmR,GAGjB,SAASM,GAAUzR,GAAkC,IAAD,uBAAhBmG,EAAgB,iCAAhBA,EAAgB,kBACzD,IAAM5J,EAAMgV,GAAY,WAAZ,GAAavR,EAAO,IAApB,OAA2BmG,IACvC,OAAO5J,GAAO,EAAIyD,EAAMzD,GAAO,GAGjC,IAAMyE,GAAY,SAACqP,GAAD,IAAeqB,EAAf,uDAA6B,IAA7B,OAAqCtR,OAAOC,QAAQgQ,GAASnQ,KAAI,mCAAEhD,EAAF,KAAOe,EAAP,qBAAqBf,EAArB,YAA4Be,MAASoI,KAAKqL,IC7B7H,IAAMxC,GAAc3R,OAAO4R,WACrB5R,OAAO4R,WAAW,gCAClB,GAGAC,GAAO,a,SAEEuC,G,iFAAf,WAAuB7I,GAAvB,eAAA8I,EAAA,sEACoBC,MAAM/I,GAD1B,cACQgJ,EADR,gBAEeA,EAAIC,OAFnB,oF,sBAKA,ID+BqB9V,GC/Bf+V,ID+Be/V,GC/BA,uCAAC,WAAwBgW,GAAxB,eAAAL,EAAA,sEAEDD,GADF,iCADG,OAEdI,EAFc,OAGpBE,EAAOC,UAAUC,WAAWC,mBAAmBC,YAAYN,EAAM,IAH7C,2CAAD,gBAAC,GAAD,mCDgCZ,WACL,IAAIO,GAAO,EACNA,IACHA,GAAO,EACPrW,GAAE,WAAF,gB,ICzBesW,G,kDACnB,WAAYrT,GAAQ,IAAD,uBACjB,cAAMA,IAURsT,qBAAuB,SAAC1E,EAAQmE,GAC9B,EAAKnE,OAASA,EACdkE,GAASC,GACTnE,EAAO2E,WAAWC,cAAc,CAACC,QAAS,IAHD,IAIlC5H,EAAe,EAAK7L,MAApB6L,YACHA,GACFA,EAAY,CACVgF,SAAU,SAAChH,EAAQiH,GACjB,EAAKlC,OAAOmC,QACZ,EAAKnC,OAAO8E,YAAY,CAACC,WAAY9J,EAAQ+J,OAAQ9C,IACrD,EAAKlC,OAAOiF,eAAe,CAACF,WAAY9J,EAAQ+J,OAAQ9C,KAE1DI,QAAS,SAAAzK,KAGTsK,MAAO,SAAAtK,GACL,EAAKmI,OAAOmC,YA3BD,EAgCnBX,eAAiB,SAACxB,GAChB,EAAKA,OAASA,GAjCG,IAEV7P,EAAkBiB,EAAlBjB,MAAO6R,EAAW5Q,EAAX4Q,QAFG,OAGjB,EAAKlB,MAAQ,CAAC3Q,QAAO6R,WAHJ,E,qDAmCT,IAAD,EAC0ChU,KAAKoD,MAD/C,IACAmR,eADA,MACU,GADV,MACcC,qBADd,MAC8BlB,GAD9B,EACoCmB,EADpC,EACoCA,GACpCtS,EAAUnC,KAAK8S,MAAf3Q,MACDuS,EAAatB,GAAYuB,QAMzBuC,EAlDV,SAAkClF,GAChC,IAAMkF,IAAkB,OAANlF,QAAM,IAANA,OAAA,EAAAA,EAAQ6C,OAAQ,cAAcsC,MAAM,KAAKC,MAC3D,MAAoB,QAAbF,EAAqB,WAAaA,EAgDtBG,CAAyB9C,EAAQvC,QAAQmF,MAAM,KAAKC,MACrE,OACE,kBAAC,KAAD,CACErC,MAAOL,EAAa,UAAY,QAChCwC,SAAUA,EACV/U,MAAOA,EACPmB,SAAUkR,EACV8C,QAAStX,KAAK0W,qBACdnC,QAAS,CACPgD,QAAS,CAACC,SAAS,GACnBvF,YAAawC,EAAGxC,YAAc,KAAO,MACrCwF,aAAa,EACbC,SAAS,EACTC,cAAelD,EAAGvC,KAClB0F,iBAAkBnD,EAAGtC,qB,gDArDG/O,EAAO0P,GAErC,OADoBA,EAAMkB,UAAY5Q,EAAM4Q,QAEvC,CAACA,QAAS5Q,EAAM4Q,QAAS7R,MAAOiB,EAAMjB,OACtC,S,GAV+BqH,IAAMC,WCtBzBoO,G,4MAOnBpM,aAAe,WACb,EAAKC,e,kEANLmH,GAAkB7S,KAAKyL,gB,6CAGvBoH,GAAoB7S,KAAKyL,gB,+BAMzB,IAAMgJ,EAAK5B,KACLsD,EAAuB,WAAd1B,EAAGzC,OAEX5O,EAASpD,KAAToD,MACD0U,EAAQ,2BAAO1U,GAAP,IAAcqR,OAC5B,OACE0B,EACM,kBAAC,GAAe2B,GAChB,kBAAC,GAAmBA,O,GAnBEtO,IAAMC,WCDzB,SAASsO,GAAS3U,GAAQ,IAErCjB,EAOEiB,EAPFjB,MACA6R,EAME5Q,EANF4Q,QACAgE,EAKE5U,EALF4U,QAJoC,EASlC5U,EAJFgM,aALoC,MAK5B,GAL4B,IASlChM,EAHFmR,eANoC,MAM1B,GAN0B,EAOpCC,EAEEpR,EAFFoR,cACAvF,EACE7L,EADF6L,YAEF,OACE,yBAAKxG,UAAU,YAAY+G,MAAOpM,EAAMoM,OACpC,yBAAK/G,UAAU,YACZuP,GAEH,yBAAKvP,UAAW0B,EAAW,UACvB,kBAAC,GAAD,CACE6J,QAASA,EACT7R,MAAOA,EACPoS,QAASA,EACTC,cAAeA,EACfvF,YAAaA,IAEhBG,I,ICvBU6I,G,4MAmBnBC,kBAAoB,SAACC,GACnB,EAAKC,QAAUD,G,kEAnBI,IAAD,QAElBE,EADmBrY,KAAKoD,MAAjBiV,UACErY,KAAM,CACbiU,SAAU,SAAClQ,GAAU,IACZoF,EAAS,EAAK/F,MAAd+F,MACP,GAAIpF,EAAK8I,UAAY1D,EAEnB,OADA,EAAKiP,QAAQnE,SAASlQ,EAAKkJ,OAAQlJ,EAAKmQ,QACjC,GAGXI,QAAS,SAAAzK,GAAC,OAAI,EAAKuO,QAAQ9D,WAC3BH,MAAO,SAAAtK,GAAC,OAAI,EAAKuO,QAAQjE,a,8CAK3BmE,EADqBtY,KAAKoD,MAAnBkV,YACItY,Q,+BAKH,IAAD,EACDoD,EAAQpD,KAAKoD,MACZ+F,EAAkB/F,EAAlB+F,MAAO6K,EAAW5Q,EAAX4Q,QACRgE,EACJ,yBAAKxI,MAAO,CAACsC,MAAO,SAAU3I,GAE1BoP,EAAWC,KAAKC,OAAOtP,KAAmC,eAAxBA,EAAM9D,cAAiC,yBAA2B,4BACpGkP,EAAO,2BACRnR,EAAMmR,SADE,IAEXvC,OAAO,4BACD,UAAA5O,EAAMmR,eAAN,eAAevC,SAAU5O,EAAMmR,QAAQvC,QADvC,IAEJ6C,KAAM0D,MAGV,OACE,kBAACR,GAAD,eACE3W,IAAK4S,GACD5Q,EAFN,CAGEmR,QAASA,EACTyD,QAASA,EACT/I,YAAajP,KAAKkY,yB,GA1CQ1O,IAAMC,WCclC8I,IADM,IAAI3C,KACaC,QARP,CACpB,KAAQ,SACR,WAAc,CACZ,SAAU,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,YAEjD,SAAY,CAAC,WAKM6I,G,kDACnB,WAAYtV,GAAQ,IAAD,uBACjB,cAAMA,IAYR8P,WAAa,SAACR,GACZ,EAAKC,SAAS,CAACD,UACfG,GAAY,EAAK8F,YAAa,EAAK7F,QAflB,EAiBnB8F,eAAiB,SAACjV,EAAMwU,GACtB,EAAKjU,MAAM3D,IAAIoD,EAAMwU,IAlBJ,EAoBnBU,iBAAmB,SAAClV,GAClB,EAAKO,MAAMrD,OAAO8C,IAnBlB,EAAKO,MAAQ,IAAIjE,IACjB,EAAK6Y,aAAe,IAAI7Y,IACxB,EAAK0Y,YAAL,UAAsBvV,EAAM2V,WAA5B,UACA,IAAMjG,EAAQD,KAAc,EAAK8F,aALhB,OAMjB,EAAK7F,MAAQP,GAAiBO,GAASA,EAAQ,CAC7CJ,MAAO,IAEL,EAAKI,MAAMJ,MAAM9R,SAAWwC,EAAMW,KAAKG,MAAMtD,SAC/C,EAAKkS,MAAMJ,MAAQtP,EAAMW,KAAKG,MAAME,KAAI,SAACyF,EAAGmP,GAAJ,OAAU,EAAI5V,EAAMW,KAAKG,MAAMtD,WAVxD,E,uDAuBR4Q,GACT,IAAIpQ,EAAMpB,KAAK8Y,aAAaxY,IAAIkR,GAKhC,OAJKpQ,IACHA,EAvCU,UAAO6X,KAAKC,MAAZ,YAAqBC,KAAKC,UAwCpCpZ,KAAK8Y,aAAavY,IAAIiR,EAAMpQ,IAEvBA,I,0CAEY,IAAD,QAElB6N,EADsBjP,KAAKoD,MAApB6L,aACK,CACVgF,SAAU,SAAClQ,GACT,EAAKG,MAAMmV,SAAQ,SAAAlB,GACjBA,EAAIlE,SAASlQ,W,+BAKX,IAAD,SACmC/D,KAAKoD,MAAxC4Q,EADA,EACAA,QAASjQ,EADT,EACSA,KAAMqL,EADf,EACeA,MAAO4D,EADtB,EACsBA,UACtBN,EAAS1S,KAAK8S,MAAdJ,MACP,OACE,yBAAKjK,UAAU,SACb,kBAAC,IAAD,CACEuK,UAAWA,EACXC,QAAS,EACTP,MAAOA,EACPQ,WAAYlT,KAAKkT,WACjBoG,kBAAmBC,8BAGnBxV,EAAKG,MAAME,KAAI,SAACT,EAAMlD,GACpB,OACE,kBAAC,GAAD,CACEW,IAAG,YAAO,EAAKoY,WAAW7V,IAC1BqQ,QAASA,EACTyF,KAAK,WACLtQ,MAAOxF,EAAKU,KACZlC,MAAOwB,EAAKC,QACZ8V,cAAe,SAAArV,GAAI,OAAIgO,GAAkB5R,EAAK4D,IAC9CmQ,cAAe,SAAArS,GAAK,OAAIkQ,GAAqB5R,EAAK0B,IAClDkW,SAAU,EAAKO,eACfN,WAAY,EAAKO,iBACjBzJ,MAAOA,a,GAnEY5F,IAAMC,WCAnC8I,IADM,IAAI3C,KACaC,QATP,CACpB,KAAQ,SACR,WAAc,CACZ,UAAW,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,GACvE,UAAW,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,IAEzE,SAAY,CAAC,SAAU,YAKJ8J,G,kDACnB,WAAYvW,GAAQ,IAAD,uBACjB,cAAMA,IAORqP,YAAc,SAACC,GACb,EAAKC,SAAS,CAACC,OAAQF,IACvBG,GAxBgB,kBAwBS,EAAKC,QAVb,EAYnB8G,YAAc,SAAClH,GACb,EAAKC,SAAS,CAACkH,OAAQnH,IACvBG,GA5BgB,kBA4BS,EAAKC,QAdb,EAgBnBgH,iBAAmB,SAAC3B,GAClB,EAAK4B,SAAW5B,GAjBC,EAmBnBhF,eAAiB,SAACpP,GAChB,EAAKgW,SAAS9F,SAASlQ,IAlBvB,IAAM+O,EAAQD,KAAA,gBAFG,OAGjB,EAAKC,MAAQP,GAAiBO,GAASA,EAAQ,CAC7C+G,OAAQ,CAAC,GAAK,IACdjH,OAAQ,CAAC,GAAK,KALC,E,qDAsBT,IAAD,EACoC5S,KAAKoD,MAAzC4Q,EADA,EACAA,QAASjQ,EADT,EACSA,KAAMgP,EADf,EACeA,kBADf,EAEkB/S,KAAK8S,MAAvBF,EAFA,EAEAA,OAAQiH,EAFR,EAEQA,OACf,OACE,kBAAC,IAAD,CAAO7G,UAAU,aAAaC,QAAS,EAAGP,MAAOmH,EAAQ3G,WAAYlT,KAAK4Z,aACxE,yBAAKnR,UAAU,QACb,kBAAC,GAAD,CACEuK,UAAU,WACV+F,WA5CQ,kBA6CRhV,KAAMA,EACNiQ,QAASA,EACT/E,YAAajP,KAAK8Z,oBAGtB,yBAAKrR,UAAU,SACb,kBAAC,IAAD,CAAOuK,UAAU,WAAWC,QAAS,EAAGP,MAAOE,EAAQM,WAAYlT,KAAKyS,aACtE,kBAAC,EAAD,CAAQxD,YAAa8D,IACrB,kBAAC,EAAD,CAAKvG,WAAYxM,KAAKmT,wB,GAxCW3J,IAAMC,WCF7C8I,IADM,IAAI3C,KACaC,QATP,CACpB,KAAQ,SACR,WAAc,CACZ,UAAW,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,GACvE,UAAW,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,IAEzE,SAAY,CAAC,SAAU,YAKJmK,G,kDACnB,WAAY5W,GAAQ,IAAD,uBACjB,cAAMA,IAOR6W,YAAc,SAACvH,GACb,EAAKC,SAAS,CAACuH,OAAQxH,IACvBG,GAxBgB,oBAwBS,EAAKC,QAVb,EAYnBqH,YAAc,SAACzH,GACb,EAAKC,SAAS,CAACyH,OAAQ1H,IACvBG,GA5BgB,oBA4BS,EAAKC,QAdb,EAgBnBgH,iBAAmB,SAAC3B,GAClB,EAAK4B,SAAW5B,GAjBC,EAmBnBhF,eAAiB,SAACpP,GAChB,EAAKgW,SAAS9F,SAASlQ,IAlBvB,IAAM+O,EAAQD,KAAA,kBAFG,OAGjB,EAAKC,MAAQP,GAAiBO,GAASA,EAAQ,CAC7CoH,OAAQ,CAAC,GAAK,IACdE,OAAQ,CAAC,GAAK,KALC,E,qDAsBT,IAAD,EACoCpa,KAAKoD,MAAzC4Q,EADA,EACAA,QAASjQ,EADT,EACSA,KAAMgP,EADf,EACeA,kBADf,EAEkB/S,KAAK8S,MAAvBoH,EAFA,EAEAA,OAAQE,EAFR,EAEQA,OACf,OACE,kBAAC,IAAD,CAAOpH,UAAU,WAAWC,QAAS,EAAGP,MAAOwH,EAAQhH,WAAYlT,KAAKia,aACtE,yBAAKxR,UAAU,2BACb,kBAAC,GAAD,CAAOsQ,WA1CG,oBA0CsB/F,UAAU,aAAajP,KAAMA,EAAMiQ,QAASA,EAAS/E,YAAajP,KAAK8Z,oBAEzG,yBAAKrR,UAAU,8BACb,kBAAC,IAAD,CAAOuK,UAAU,WAAYN,MAAO0H,EAAQlH,WAAYlT,KAAKma,aAC3D,kBAAC,EAAD,CAAQlL,YAAa8D,IACrB,kBAAC,EAAD,CAAKvG,WAAYxM,KAAKmT,wB,GAlCa3J,IAAMC,WCC/C8I,IADM,IAAI3C,KACaC,QAVP,CACpB,KAAQ,SACR,WAAc,CACZ,UAAW,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,GACvE,WAAY,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,GACxE,WAAY,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,IAE1E,SAAY,CAAC,SAAU,UAAW,aAKpC,SAASwK,GAAUjX,GAAQ,IAClBW,EAA4CX,EAA5CW,KAAMtD,EAAsC2C,EAAtC3C,IAAKuT,EAAiC5Q,EAAjC4Q,QAASqE,EAAwBjV,EAAxBiV,SAAUC,EAAclV,EAAdkV,WAC/B3U,EAAOI,EAAKG,MAAMzD,GACxB,OACE,kBAAC,GAAD,CAEEuT,QAASA,EACTyF,KAAK,WACLtQ,MAAOxF,EAAKU,KACZlC,MAAOwB,EAAKC,QACZ8V,cAAe,SAAArV,GAAI,OAAIgO,GAAkB5R,EAAK4D,IAC9CmQ,cAAe,SAAArS,GAAK,OAAIkQ,GAAqB5R,EAAK0B,IAClDkW,SAAUA,EACVC,WAAYA,I,IAMGgC,G,kDACnB,WAAYlX,GAAQ,IAAD,uBACjB,cAAMA,IASRwW,YAAc,SAAClH,GACb,EAAKC,SAAS,CAACkH,OAAQnH,IACvBG,GA9CgB,YA8CS,EAAKC,QAZb,EAcnByH,aAAe,SAAC7H,GACd,EAAKC,SAAS,CAAC6H,QAAS9H,IACxBG,GAlDgB,YAkDS,EAAKC,QAhBb,EAkBnB2H,aAAe,SAAC/H,GACd,EAAKC,SAAS,CAAC+H,QAAShI,IACxBG,GAtDgB,YAsDS,EAAKC,QApBb,EAsBnB8F,eAAiB,SAACjV,EAAMwU,GACtB,EAAKjU,MAAM3D,IAAIoD,EAAMwU,IAvBJ,EAyBnBU,iBAAmB,SAAClV,GAClB,EAAKO,MAAMrD,OAAO8C,IA1BD,EA4BnBwP,eAAiB,SAACpP,GAChB,EAAKG,MAAMmV,SAAQ,SAAAlB,GACjBA,EAAIlE,SAASlQ,OA5Bf,EAAKG,MAAQ,IAAIjE,IACjB,IAAM6S,EAAQD,KAAA,UAHG,OAIjB,EAAKC,MAAQP,GAAiBO,GAASA,EAAQ,CAC7C+G,OAAQ,CAAC,GAAK,IACdW,QAAS,CAAC,GAAK,IACfE,QAAS,CAAC,GAAK,GAAK,KAPL,E,qDAiCT,IAAD,EACoC1a,KAAKoD,MAAzC4Q,EADA,EACAA,QAASjQ,EADT,EACSA,KAAMgP,EADf,EACeA,kBAChB7O,EAAQH,EAAKG,MACbyW,EAAclF,GAAavR,EAAO,aAAc,QAChD0W,EAAYnF,GAAavR,EAAO,WAAY,KAAM,KAAM,cACxD2W,EAAapF,GAAavR,EAAO,YAAa,OAL7C,EAM4BlE,KAAK8S,MAAjC+G,EANA,EAMAA,OAAQW,EANR,EAMQA,QAASE,EANjB,EAMiBA,QAExB,OACE,kBAAC,IAAD,CAAO1H,UAAU,aAAaC,QAAS,EAAGP,MAAOmH,EAAQ3G,WAAYlT,KAAK4Z,aACxE,yBAAKnR,UAAU,QACb,kBAAC,IAAD,CAAOuK,UAAU,WAAWC,QAAS,EAAGP,MAAO8H,EAAStH,WAAYlT,KAAKua,cACvE,kBAACF,GAAD,CAAWrG,QAASA,EAASqE,SAAUrY,KAAK4Y,eAAgBN,WAAYtY,KAAK6Y,iBAAkB9U,KAAMA,EAAMtD,IAAKka,IAChH,kBAACN,GAAD,CAAWrG,QAASA,EAASqE,SAAUrY,KAAK4Y,eAAgBN,WAAYtY,KAAK6Y,iBAAkB9U,KAAMA,EAAMtD,IAAKma,MAGpH,yBAAKnS,UAAU,SACb,kBAAC,IAAD,CAAOuK,UAAU,WAAWC,QAAS,EAAGP,MAAOgI,EAASxH,WAAYlT,KAAKya,cACvE,kBAACJ,GAAD,CAAWrG,QAASA,EAASqE,SAAUrY,KAAK4Y,eAAgBN,WAAYtY,KAAK6Y,iBAAkB9U,KAAMA,EAAMtD,IAAKoa,IAChH,kBAAC,EAAD,CAAQ5L,YAAa8D,IACrB,kBAAC,EAAD,CAAKvG,WAAYxM,KAAKmT,wB,GAtDK3J,IAAMC,WCrBvC8I,IADM,IAAI3C,KACaC,QAZP,CACpB,KAAQ,SACR,WAAc,CACZ,WAAc,CAAE,KAAQ,WACxB,QAAW,CAAE,KAAQ,WACrB,WAAc,CAAE,KAAQ,WACxB,SAAU,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,GACtE,aAAc,CAAE,KAAQ,QAAS,MAAS,CAAC,KAAQ,UAAW,SAAY,IAE5E,SAAY,CAAC,QAAS,YAAa,aAAc,UAAW,gBAO9D,SAASiL,GAASpI,EAAOqI,EAAWta,EAAKua,GACvC,GAAIA,EAAM,CAER,IAAMC,EAAUF,EAAUta,GACpBya,EAAiB,EAAID,EACrBhR,EAAIyI,EAAMlO,QAAO,SAACqF,EAAGmP,GAAJ,OAAUvY,IAAQuY,KACnCmC,EAAMlR,EAAEpF,QAAO,SAACuW,EAAKjN,GAAN,OAAeiN,EAAMjN,IAAM,GAC1CkN,EAAWpR,EAAE7F,KAAI,SAAA+J,GAAI,OAAIA,EAAOgN,EAAMD,KAE5C,OADAG,EAAS1a,OAAOF,EAAK,EAAGwa,GACjBI,EAGP,IAAMpR,EAAIyI,EAAMtO,KAAI,SAAC+J,EAAM6K,GAAP,OAAavY,IAAQuY,EAAI,EAAI7K,KAC3CgN,EAAMlR,EAAEpF,QAAO,SAACuW,EAAKjN,GAAN,OAAeiN,EAAMjN,IAAM,GAEhD,OADiBlE,EAAE7F,KAAI,SAAA+J,GAAI,OAAIA,EAAOgN,K,IC/BpCG,GAAc,CAClB3B,GACAK,GACAM,G,kDDkCA,WAAYlX,GAAQ,IAAD,uBACjB,cAAMA,IAYRwV,eAAiB,SAACjV,EAAMwU,GACtB,EAAKjU,MAAM3D,IAAIoD,EAAMwU,IAdJ,EAgBnBU,iBAAmB,SAAClV,GAClB,EAAKO,MAAMrD,OAAO8C,IAjBD,EA2BnB4X,SAAW,SAAC7I,GACV,IAAMqI,EAAY,EAAKjI,MAAMiI,UAAUja,QACnC,EAAKgS,MAAM0I,YAAc,IAAKT,EAAU,GAAKrI,EAAM,IACnD,EAAKI,MAAM2I,aAAcV,EAAU,GAAKrI,EAAM,IAC9C,EAAKI,MAAM4I,UAAWX,EAAU,GAAKrI,EAAM,IAC/C,EAAKC,SAAS,CAACD,QAAOqI,cACtBlI,GAtEgB,eAsES,EAAKC,QAjCb,EAmCnBK,eAAiB,SAACpP,GAEhB,EAAKG,MAAMmV,SAAQ,SAAClB,EAAKxU,GACvB,GAAIwU,EAAIlE,SAASlQ,GAAO,CAAC,IAGjBtD,EAFU,EAAK2C,MAAMW,KAApBG,MAEWqR,WAAU,SAAA5R,GAAI,OAAIA,EAAKU,OAASN,EAAK8I,WACnDpM,IAAQ,EAAKqS,MAAM0I,YACrB,EAAKG,eAAelb,QA3CT,EAgDnBkb,eAAiB,SAAClb,GAChB,IAAM+a,EAAa,EAAK1I,MAAM0I,aAAe/a,GAAO,EAAIA,EACxD,EAAKkS,SAAS,CACZ6I,aACA9I,MAAOoI,GAAS,EAAKhI,MAAMJ,MAAO,EAAKI,MAAMiI,UAAW,EAAGS,GAAc,KAE3E3I,GA3FgB,eA2FS,EAAKC,QAtDb,EAwDnB8I,cAAgB,WACd,IAAMC,GAAW,EAAK/I,MAAM+I,QAC5B,EAAKlJ,SAAS,CACZkJ,UACAnJ,MAAOoI,GAAS,EAAKhI,MAAMJ,MAAO,EAAKI,MAAMiI,UAAW,EAAGc,KAE7DhJ,GAnGgB,eAmGS,EAAKC,QA9Db,EAgEnBgJ,iBAAmB,WACjB,IAAML,GAAc,EAAK3I,MAAM2I,WAC/B,EAAK9I,SAAS,CACZ8I,aACA/I,MAAOoI,GAAS,EAAKhI,MAAMJ,MAAO,EAAKI,MAAMiI,UAAW,EAAGU,KAE7D5I,GA3GgB,eA2GS,EAAKC,QApE9B,IAAMA,EAAQD,KAAA,aAFG,OAGjB,EAAKC,MAAQP,GAAiBO,GAASA,EAAQ,CAC7C2I,YAAY,EACZI,SAAS,EACTL,WAAY,EACZ9I,MAAO,CAAC,IAAM,IAAM,IACpBqI,UAAW,CAAC,IAAM,IAAM,KAE1B,EAAK7W,MAAQ,IAAIjE,IACjB,EAAK6Y,aAAe,IAAI7Y,IAXP,E,uDAmBRuR,GACT,IAAIpQ,EAAMpB,KAAK8Y,aAAaxY,IAAIkR,GAKhC,OAJKpQ,IACHA,EA5CU,UAAO6X,KAAKC,MAAZ,YAAqBC,KAAKC,UA6CpCpZ,KAAK8Y,aAAavY,IAAIiR,EAAMpQ,IAEvBA,I,2CAgDHpB,KAAK+b,cAAgB/b,KAAK8S,MAAM0I,aAClCxb,KAAK+b,YAAc/b,KAAK8S,MAAM0I,WAC9Bxb,KAAKkE,MAAMmV,SAAQ,SAAAlB,GACjBA,EAAI7D,UACJ6D,EAAIhE,c,+BAIA,IAAD,SACoCnU,KAAKoD,MAAzC4Q,EADA,EACAA,QAASjQ,EADT,EACSA,KAAMgP,EADf,EACeA,kBADf,EAE0C/S,KAAK8S,MAA/C2I,EAFA,EAEAA,WAAYI,EAFZ,EAEYA,QAASnJ,EAFrB,EAEqBA,MAAO8I,EAF5B,EAE4BA,WAC7BQ,EAAW,gBAASP,GAAc,CAACQ,QAAS,SAC5CC,EAAQ,gBAASL,GAAW,CAACI,QAAS,SAC5C,OACE,yBAAKxT,UAAU,iBACb,yBAAKA,UAAU,qBACb,yBAAKA,UAAU,YAEX1E,EAAKG,MAAME,KAAI,SAACT,EAAMlD,GACpB,IAAMW,EAAG,YAAQ,EAAKoY,WAAW7V,IACjC,OACE,kBAAC,IAAMwY,SAAP,CAAgB/a,IAAKA,GACnB,2BACEiC,KAAK,QACLgB,KAAK,eACL2D,GAAI5G,EACJgb,QAAS3b,IAAQ+a,EACjBnS,QAAS,SAAAQ,GAAC,OAAI,EAAK8R,eAAelb,IAClC6C,SAAU,SAAAuG,GAAC,OAAIA,KAEjB,2BAAOwS,QAASjb,GAAMuC,EAAKU,UAKnC,2BACEhB,KAAK,WACL+Y,QAASX,EACTnY,SAAUtD,KAAK8b,iBACf9T,GAAG,WAEL,2BAAOqU,QAAQ,UAAf,UACA,2BACEhZ,KAAK,WACL+Y,QAASP,EACTvY,SAAUtD,KAAK4b,cACf5T,GAAG,QAEL,2BAAOqU,QAAQ,OAAf,SAGJ,kBAAC,IAAD,CAAOrJ,UAAU,WAAWC,QAAS,EAAGP,MAAOA,EAAOQ,WAAYlT,KAAKub,UACrE,yBAAK9S,UAAU,eAEb1E,EAAKG,MAAME,KAAI,SAACT,EAAMlD,GACpB,IAAMW,EAAG,YAAQ,EAAKoY,WAAW7V,IACjC,OACE,yBAAKvC,IAAKA,EAAKoO,MAAK,eAAO/O,IAAQ+a,GAAc,CAACS,QAAS,UACzD,kBAAC,GAAD,CACEjI,QAASA,EACTyF,KAAK,WACLtQ,MAAOxF,EAAKU,KACZlC,MAAOwB,EAAKC,QACZ8V,cAAe,SAAArV,GAAI,OAAIgO,GAAkB5R,EAAK4D,IAC9CmQ,cAAe,SAAArS,GAAK,OAAIkQ,GAAqB5R,EAAK0B,IAClDkW,SAAU,EAAKO,eACfN,WAAY,EAAKO,wBAO3B,yBAAKpQ,UAAU,uBAAuB+G,MAAOwM,GAAa,kBAAC,EAAD,CAAQ/M,YAAa8D,KAC/E,yBAAKtK,UAAU,oBAAoB+G,MAAO0M,GAAU,kBAAC,EAAD,CAAK1P,WAAYxM,KAAKmT,wB,GApJrC3J,IAAMC,YC7BhC6S,G,4MAOnB7Q,aAAe,WACb,EAAKC,e,kEANLmH,GAAkB7S,KAAKyL,gB,6CAGvBoH,GAAoB7S,KAAKyL,gB,+BAKjB,IACD8Q,EAAcvc,KAAKoD,MAAnBmZ,WACD1H,EAAOhC,KAAcjB,OACrB4K,EAAaD,EAAaE,GAAUnB,GAAYzG,GACtD,OAAOrL,IAAM/G,cAAc+Z,EAAYxc,KAAKoD,W,GAdfoG,IAAMC,WCZjCiT,GAAa,CACjB,KAAQ,SACR,WAAc,CACZ,KAAQ,CAAE,KAAQ,UAClB,KAAQ,CAAE,KAAQ,UAClB,aAAgB,CAAE,KAAQ,YAE5B,SAAY,CAAC,OAAQ,SAGjBC,GAAc,CAClB,QAAW,iCACX,KAAQ,SACR,qBAAwBD,IAEpBE,GAAM,IAAIhN,IACViN,GAAiBD,GAAI/M,QAAQ8M,IAC7BG,GAAgBF,GAAI/M,QAAQ6M,IAElC,SAASK,KACP,IACE,IAAMxV,EAAQvD,KAAKC,MAAMlD,EAAeT,IAvB3B,UAwBb,IAAKuc,GAAetV,GAElB,MADAxG,EAAeF,OAzBJ,SA0BL,IAAIsG,MAEZ,OAAOI,EACP,MAAMpG,GACN,MAAO,IAWJ,SAAS6b,GAAQhV,EAAI3D,EAAM6D,EAAM+U,GACtC,IAAMnZ,EAAO,CAACO,OAAM6D,OAAMvC,OAAQsX,EAASC,cAAc,GACzD,IAAKJ,GAAchZ,GACjB,MAAM,IAAIqD,MAAJ,2BAA8B2V,GAAc7L,OAAO7M,KAAI,SAAAjD,GAAC,gBAAOA,EAAEiG,QAAT,aAAqBjG,EAAE+P,eAEvF,IAAM3J,EAAK,eAAO8K,GAAU,UAC5B9K,EAAMS,GAAMlE,EACZuO,GAAU,QAAS9K,GACnB4V,GAAwB5V,GAGnB,SAAS6V,GAAWpV,GACzB,IAAMT,EAAK,eAAO8K,GAAU,iBACrB9K,EAAMS,GACbqK,GAAU,QAAS9K,GACnB4V,GAAwB5V,GAG1B,SAAS4V,GAAwB5V,GAE/BxG,EAAeR,IA7DA,QA6DcyD,KAAKkB,UAAUqC,IAOvC,SAAS8V,GAAS9V,GACvB,IAAKsV,GAAetV,GAClB,MAAM,IAAIJ,MAAJ,4BAA+B2V,GAAc7L,OAAO7M,KAAI,SAAAjD,GAAC,gBAAOA,EAAEiG,QAAT,aAAqBjG,EAAE+P,eAExFmB,GAAU,QAAS9K,GACnB4V,GAAwB5V,GCvB1B,SAAS+V,GAAmB/V,EAAkBgW,EAAqBC,EAAiBC,GAClF,IAAMC,EAA6B,SAAZD,EAAqB,GAAK,EAC3CE,EAzBR,SAAmBH,EAAiBD,GAClC,OAAQC,GACN,IAAK,OACH,OAAO,SAAC1H,EAAS8H,GAAV,OAAsB9H,EAAEzR,KAAKgB,cAAgBuY,EAAEvZ,KAAKgB,eAAiB,EAAKyQ,EAAEzR,KAAKgB,cAAgBuY,EAAEvZ,KAAKgB,cAAgB,EAAI,GACrI,IAAK,OACH,OAAO,SAACyQ,EAAS8H,GAAV,OAAsB9H,EAAE5N,KAAO0V,EAAE1V,MAAQ,EAAK4N,EAAE5N,KAAO0V,EAAE1V,KAAO,EAAI,GAC7E,IAAK,SACH,OAAO,SAAC4N,EAAS8H,GACf,IAAMC,EAAK/H,EAAEnQ,OAAS,EAAI,EACpBmY,EAAKF,EAAEjY,OAAS,EAAI,EAC1B,OAAOwT,KAAK4E,KAAKF,EAAKC,IAE1B,IAAK,QACH,OAAO,SAAChI,EAAS8H,GACf,IAAMC,EAAKN,EAAOS,IAAIlI,EAAE9N,IAAM,EAAI,EAC5B8V,EAAKP,EAAOS,IAAIJ,EAAE5V,IAAM,EAAI,EAClC,OAAOmR,KAAK4E,KAAKF,EAAKC,IAE1B,QACE,MAAM,IAAI3W,MAAM,oBAML8W,CAAUT,EAASD,GAClC,OAAOjZ,OAAOC,QAAQgD,GAAOnD,KAAI,YAA0C,IAAD,mBAAvC4D,EAAuC,YACxE,MAAO,CAACA,KAAI3D,KAD4D,EAAlCA,KACpB6D,KADsD,EAA5BA,KACpBvC,OADgD,EAAtBA,WAEjDuY,MAAK,SAACN,EAAG9H,GAAJ,OAAU6H,EAAO7H,EAAG8H,GAAKF,KAoBnC,SAASS,GAAO/a,GAAqB,IAC5Bqa,EAA6Bra,EAA7Bqa,QAASW,EAAoBhb,EAApBgb,SAAUnW,EAAU7E,EAAV6E,OAC1B,OACE,kBAAC,IAAMkU,SAAP,KACE,0BAAM9S,QAAS,kBAAMpB,EAAQmW,EAAkC,OAAZX,EAAmB,OAAS,KAAvCA,IAA+ChV,UAAW2V,EAAW,mBAAqB,IAAiB,OAAZX,EAAmB,SAAM,WAKtK,SAASY,GAAmCC,GAE1C,IADA,IAAIjX,EACJ,MAAmC/C,OAAOia,OAAOD,GAAjD,eAA6D,CAAC,IAAD,OAAjDpW,EAAiD,EAAjDA,KAAiD,EAA3CgV,gBAET7V,GAASa,EAAOb,KACnBA,EAAQa,GAId,OAAOb,ED3DTgL,GAAU,QAAS0K,MAGnBhc,EAAeY,UArCE,SAqCkB,WACjC0Q,GAAU,QAAS0K,S,IC0DAyB,G,kDACnB,WAAapb,GAAY,IAAD,uBACtB,cAAMA,IAYRqb,eAAiB,SAAClX,GAChB,EAAKoL,SAAS,CACZpL,WAfoB,EAkBxBmX,YAAc,SAAC1W,GACb,IAAMuV,EAAS,IAAIpN,IAAI,EAAK2C,MAAMyK,QAC9BA,EAAOS,IAAIhW,GACbuV,EAAO1c,OAAOmH,GAEduV,EAAO3a,IAAIoF,GAEb,EAAK2K,SAAS,CAAC4K,YAzBO,EA2BxBoB,mBAAqB,WACnB,EAAKjT,cACiB,EAAKG,QAApB+S,YACSpY,eACd,EAAKqY,aA/Be,EAkCxBC,WAAa,SAACtB,EAAiBC,GAC7BsB,QAAQC,IAAI,UAAWxB,EAASC,GAChC,EAAK9K,SAAS,CAAC8K,UAASD,aApCF,EAoDxBxU,cAAgB,SAAC7H,GACf,EAAKwR,SAAS,CAACsM,MAAO9d,EAAE+d,YArDF,EAuDxBC,YAAc,SAAChe,GACb,EAAKwR,SAAS,CAACsM,MAAO9d,EAAE+d,YAxDF,EA0DxBL,UA1DwB,sBA0DZ,sCAAA/I,EAAA,+DACiB,EAAKjK,QAAzBuT,EADG,EACHA,SAAUC,EADP,EACOA,OACjB,EAAK1M,SAAS,CAAC2M,SAAS,IAFd,SASFC,EAAgB,EAAKzM,MAAMmM,MAAQ,GAAK,EAAKnM,MAAMvL,MACnDF,EAAQgX,GAAmCkB,GAVzC,SAWgBF,EAAOG,aAAanY,GAXpC,OAWFoY,EAXE,OAoBRlY,GARkBkY,EAAU5a,QAAO,SAAC0C,EAAczD,GAMhD,OALAyD,EAAMzD,EAAKkE,IAAM,CACf3D,KAAMP,EAAK4B,YACXwC,KAAMpE,EAAKqE,WACXxC,OAAQ7B,EAAK6B,QAER4B,IANS,eAOXgY,KAnBC,kDAsBRH,EAAS,yBAAD,cAtBA,QAwBV,EAAKzM,SAAS,CAAC2M,SAAS,IAxBd,0DA1DY,EAoFxBI,eApFwB,sBAoFP,8CAAA5J,EAAA,wDACiB,EAAKhD,MAA9ByK,EADQ,EACRA,OAAeoC,EADP,EACApY,MACTqY,EAAgB,GAEtBrC,EAAOlE,SAAQ,SAACrR,EAAIvH,GACdkf,EAAO3X,IACT4X,EAAIpf,KAAKwH,MANE,EASY,EAAK6D,QAAzBuT,EATQ,EASRA,SAAUC,EATF,EASEA,OACjB,EAAK1M,SAAS,CAAC2M,SAAS,IAVT,MAWEM,EAXF,gDAWJ5X,EAXI,wBAaLqX,EAAOQ,WAAW7X,GAbb,QAcXT,GAAiBS,GAdN,kDAgBXoX,EAAS,0BAAD,OAA2BpX,EAA3B,oBAhBG,mCAmBf,EAAK2K,SAAS,CAAC2M,SAAS,IAnBT,0DApFO,EAyGxBQ,YAAc,WACY,EAAKjU,QAAtBkU,cACOD,eAzGd,IAAMH,EDlCDtN,GAAU,SCgCO,OAGtB,EAAKS,MAAQ,CACXwM,SAAS,EACT/X,MAAOoY,EACPpC,OAAQ,IAAIpN,IACZ3L,OAAQ,GACRgZ,QAAS,OACTC,QAAS,OACTwB,OAAO,GAVa,E,gEAsCH,IACZL,EAAe5e,KAAK6L,QAApB+S,aD5DJ,SAAmBze,GACxBkS,GAAgB,QAASlS,GC4DvBoH,CAAgBvH,KAAKye,gBACrBG,EAAYjd,UAAU3B,KAAK2e,oBAC3Bld,OAAOC,iBAAiB,UAAW1B,KAAKgJ,eACxCvH,OAAOC,iBAAiB,QAAS1B,KAAKmf,e,6CAEhB,IACfP,EAAe5e,KAAK6L,QAApB+S,aD/DJ,SAAqBze,GAC1BkS,GAAkB,QAASlS,GC+DzBoH,CAAkBvH,KAAKye,gBACvBG,EAAYxe,YAAYJ,KAAK2e,oBAC7Bld,OAAOa,oBAAoB,UAAWtC,KAAKgJ,eAC3CvH,OAAOa,oBAAoB,QAAStC,KAAKmf,e,oCA2D5B,IACNP,EAAe5e,KAAK6L,QAApB+S,YACP,OACE,6BACE,4BACEvV,QAASuV,EAAYxY,OADvB,wB,mCAMQ,IAAD,OACJwY,EAAe5e,KAAK6L,QAApB+S,YADI,EAEuD5e,KAAK8S,MAAhEvL,EAFI,EAEJA,MAAOgW,EAFH,EAEGA,OAAQ+B,EAFX,EAEWA,QAAS9a,EAFpB,EAEoBA,OAAQgZ,EAF5B,EAE4BA,QAASC,EAFrC,EAEqCA,QAASwB,EAF9C,EAE8CA,MAEnDe,IADWpB,EAAYpY,gBACE8Y,EACzBG,EAAYnC,GAAmB/V,EAAOgW,EAAQC,EAASC,GAC7D,OACE,6BACE,2BACE,4BACEhV,UAAW0B,EAAW,CAAC8V,UAAWD,IAClC3W,QAASrJ,KAAK6e,WACdI,EAAQ,WAAa,GAHvB,mBAMEQ,EAAU7e,QAAU,GAClB,kBAAC,IAAMub,SAAP,KACA,2BACE,kBAAChZ,EAAD,CAAUsF,UAAU,SAASjF,YAAY,UAAUrB,MAAOqC,EAAQlB,SAAU,SAACkB,GAAmB,EAAKmO,SAAS,CAACnO,eAEjH,yBAAKiE,UAAU,SACb,+BACE,+BACE,4BACE,4BAAI,kBAAC0V,GAAD,CAAQC,SAAsB,UAAZZ,EAAqBC,QAASA,EAASxV,OAAQ,SAACiY,GAAD,OAAiB,EAAKpB,WAAW,QAASoB,OAC/G,4BAAI,kBAAC/B,GAAD,CAAQC,SAAsB,SAAZZ,EAAoBC,QAASA,EAASxV,OAAQ,SAACiY,GAAD,OAAiB,EAAKpB,WAAW,OAAQoB,OAC7G,4BAAI,kBAAC/B,GAAD,CAAQC,SAAsB,SAAZZ,EAAoBC,QAASA,EAASxV,OAAQ,SAACiY,GAAD,OAAiB,EAAKpB,WAAW,OAAQoB,OAC7G,4BAAI,kBAAC/B,GAAD,CAAQC,SAAsB,WAAZZ,EAAsBC,QAASA,EAASxV,OAAQ,SAACiY,GAAD,OAAiB,EAAKpB,WAAW,SAAUoB,SAGrH,+BAEET,EAAUjb,OA9L9B,SAAqBA,GAEnB,OADAA,EAASA,EAAOM,OAAOO,cAChB,SAASvB,GAAa,IACpBO,EAAcP,EAAdO,KAAM6D,EAAQpE,EAARoE,KACb,MAAkB,KAAX1D,GACAH,EAAKgB,cAAcC,SAASd,IAC5B0D,EAAKiY,UAAU,EAAG,IAAI7a,SAASd,IAwLL4b,CAAY5b,IAASJ,KAAI,SAACN,EAAMrD,GAC/C,OACE,wBAAIW,IAAG,WAAMX,IACX,4BAAI,2BAAO4C,KAAK,WAAW2E,GAAE,YAAOvH,GAAO2b,QAASmB,EAAOS,IAAIla,EAAKkE,IAAK1E,SAAU,kBAAM,EAAKob,YAAY5a,EAAKkE,OAAM,2BAAOqU,QAAO,YAAO5b,MAC1I,4BAAI,uBAAG4I,QAAS,EAAKyW,YAAanX,KAAI,UAAKlH,OAAO8D,SAASC,OAArB,gBAAmC6a,mBAAmBvc,EAAKkE,MAAQlE,EAAKO,OAC9G,4BAAKP,EAAKoE,KAAKiY,UAAU,EAAG,KAC5B,4BAAKrc,EAAK6B,OAAS,GAAK,uBAQpC,6BAAK,4BAAQ0D,QAASrJ,KAAK0f,gBAAtB,8B,+BASf,OAFsB1f,KAAK6L,QAApB+S,YACsBpY,cACXxG,KAAKsgB,aAAetgB,KAAKugB,kB,GA/KT/W,IAAMC,WC9F7B,SAAS+W,GAASpd,GAAQ,IAAD,EACdqd,mBAAS,IADK,mBAC/BrO,EAD+B,KACzBsO,EADyB,KAE/BtB,EAAYuB,qBAAWnW,GAAvB4U,SAWP,OACE,6BACE,yBAAK5P,MAAO,CAACuC,OAAQ,UACnB,kBAAC,GAAD,CACE5P,MAAOiQ,EACPoC,cAAekM,KAInB,2BACE,4BAAQrX,QApBd,WAAiB,IACRuX,EAAUxd,EAAVwd,OACP,IAEEvO,GADarO,KAAKC,MAAMmO,IAExBwO,IACA,MAAOzf,GACPie,EAAS,aAAD,OAAcje,OAapB,eCvBO,SAAS0f,GAAQzd,GAAQ,IAAD,EACfqd,mBAAS,IADM,mBAC9BzT,EAD8B,KACzB8T,EADyB,KAE9B1B,EAAYuB,qBAAWnW,GAAvB4U,SAF8B,4CAGrC,8BAAAtJ,EAAA,6DACS8K,EAAUxd,EAAVwd,OADT,kBAGsB7K,MAAM/I,GAH5B,cAGUgJ,EAHV,gBAIuBA,EAAI5D,OAJ3B,OAKIC,GALJ,QAMIuO,IANJ,kDAQIxB,EAAS,uBAAD,cARZ,2DAHqC,sBAcrC,OACE,6BACE,kBAACjc,EAAD,CAAUhB,MAAO6K,EAAK1J,SAAUwd,EAAQtd,YAAY,gBACpD,2BACE,4BAAQ6F,QAlBuB,4CAkB/B,cCrBO,SAAS0X,GAAQ3d,GAAQ,IAC/B4U,EAAqB5U,EAArB4U,QAAS5O,EAAYhG,EAAZgG,SAChB,OACE,yBAAKX,UAAU,WACb,yBAAKA,UAAU,mBAAmBuP,GAClC,yBAAKvP,UAAU,mBACZW,ICDM,SAAS4X,GAAK5d,GAAQ,IAC5BW,EAAyBX,EAAzBW,KAAM6c,EAAmBxd,EAAnBwd,OAAQ1X,EAAW9F,EAAX8F,QACrB,OACE,kBAAC,EAAD,CAAQC,MAAM,OAAOV,UAAU,oBAAoBS,QAASA,GAC1D,kBAAC6X,GAAD,CAAS/I,QAAQ,aACf,kBAAC,GAAD,CAAUjU,KAAMA,EAAM6c,OAAQA,KAEhC,kBAACG,GAAD,CAAS/I,QAAQ,YACf,kBAAC6I,GAAD,CAAS9c,KAAMA,EAAM6c,OAAQA,KAE/B,kBAACG,GAAD,CAAS/I,QAAQ,aACf,kBAACwI,GAAD,CAAUzc,KAAMA,EAAM6c,OAAQA,MJoQtCpC,GAAS5Q,YAAcpD,E,sBKnRjByW,GAAc,IAAIC,YAClBC,GAAc,IAAIC,YAIXC,GAAqB,SAAApX,GAAC,OAAIA,EAAE5I,WAHhB,UAGgD4I,EAAE5I,WAFhD,SAGpB,SAASigB,GAAuB1Y,GACrC,IAAM2Y,EAAe3Y,EAAIvH,WALF,SAMjBL,EAASugB,EANQ,QACE,OAMnBC,EAAS5Y,EAAIrH,OAAOP,EAAOJ,QAC7BsJ,QAAQ,KAAM,KACdA,QAAQ,KAAM,KACZuX,EAAM,IAAIC,WAAWC,aAAOH,IAC5BI,EAAML,EACPM,aAAQJ,GACRA,EACCrP,EAAO+O,GAAYQ,OAAOC,GAChC,OAAO5d,KAAKC,MAAMmO,GCjBpB,IAAM0P,GAAO,eACAC,GAAW,SAAA9X,GAAC,OAAI6X,GAAKtQ,KAAKvH,IAEhC,SAAe+X,GAAtB,qC,8CAAO,WAA+BpZ,EAAKyW,GAApC,uBAAAvJ,EAAA,0DACDiM,GAASnZ,GADR,gCAE2ByW,EAAO4C,QAAQrZ,GAF1C,uBAEI7E,EAFJ,EAEIA,KAAM4D,EAFV,EAEUA,QAFV,kBAGI,CAAC5D,OAAMiE,GAAIY,EAAKjB,YAHpB,WAIM0Z,GAAmBzY,GAJzB,0CAKI,CAAC7E,KAAMud,GAAuB1Y,KALlC,yBAOemN,MAAMnN,GAPrB,eAOGsZ,EAPH,iBAQgBA,EAAI9P,OARpB,eAQGrO,EARH,yBASI,CAACA,SATL,6C,sBCJQ,SAASoe,GAAM/e,GAAQ,IAC7Bgf,EAAUhf,EAAVgf,OACDC,EAAYD,GAAU,mCAC5B,OACE,6BACE,yBAAK3Z,UAAU,YACb,sFAEC,IAAI,yEAA2D,IAFhE,SAGC,IAAI,uCAAyB,IAH9B,qCAIC,IAAI,gDAAkC,IAJvC,KAKC,IAAI,kDAAoC,IALzC,KAMC,IAAI,oDAAsC,IAN3C,sBAOkB,IAAI,+CAA2B,IAPjD,8GASuB,uBAAGlF,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,4CAAuC0Z,IAAxF,aAAmH,IAC1I,uBAAG9e,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,4CAAuC0Z,EAAvC,mBAAjD,0BAEID,GACA,kBAAC,IAAMjG,SAAP,KACE,qEAGA,6BAAK,0BAAM3M,MAAO,CAAC8S,WAAY,QAA1B,kDACsCF,EADtC,iBAKX,8BCNR,SAASG,GAAQtY,GACf,OAAOA,EAAEkN,MAAM,MAAM/S,KAAI,SAAA6F,GAAC,oBAAWA,MAAKM,KAAK,M,IAkI5BiY,G,kDACnB,WAAYpf,GAAQ,IAAD,uBACjB,cAAMA,IAMRE,SAAW,SAACmf,GACV,EAAK9P,SAAS,CAAC8P,cARE,EAUnBC,gBAAkB,YA9FpB,SAAuB3e,GACrB,IAAMG,EAAQH,EAAKG,MACbye,EAAWhN,GAAUzR,EAAO,aAAc,QAC1C0e,EAASjN,GAAUzR,EAAO,WAAY,KAAM,KAAM,cAClD2e,EAAUlN,GAAUzR,EAAO,YAAa,OAExC4e,EAAM,CACV3Z,MAAwBpF,EAAKM,KAC7BqB,YAAwB3B,EAAKM,KAC7B0e,QAAwB,MACxBC,KAAwBL,EAAS/e,QACjCqf,IAAwBJ,EAAQjf,QAChCsf,GAAwBN,EAAOhf,SAG3BsI,EAAO1J,SAASC,cAAc,OACpCyJ,EAAKiX,UAAL,gMAMAjX,EAAKkX,cAAc,oBAAoBjhB,MAAQ6B,KAAKkB,UAAU4d,GAC9DtgB,SAASO,KAAKD,YAAYoJ,GAC1BA,EAAKkX,cAAc,QAAQC,SAC3B7gB,SAASO,KAAKG,YAAYgJ,GAsExBoX,CAAc,EAAKlgB,MAAMW,OAXR,EAanBwf,iBAAmB,YArErB,SAAwBxf,GACtB,IAAMG,EAAQH,EAAKG,MACbye,EAAWhN,GAAUzR,EAAO,aAAc,QAC1C0e,EAASjN,GAAUzR,EAAO,WAAY,KAAM,KAAM,cAClD2e,EAAUlN,GAAUzR,EAAO,YAAa,OAExCgI,EAAO1J,SAASC,cAAc,OACpCyJ,EAAKiX,UAAL,kXAUAjX,EAAKkX,cAAc,oBAAoBjhB,MAAQwgB,EAAS/e,QACxDsI,EAAKkX,cAAc,mBAAmBjhB,MAAQ0gB,EAAQjf,QACtDsI,EAAKkX,cAAc,kBAAkBjhB,MAAQygB,EAAOhf,QACpDsI,EAAKkX,cAAc,qBAAqBjhB,MAAQ4B,EAAKM,KACrD7B,SAASO,KAAKD,YAAYoJ,GAC1BA,EAAKkX,cAAc,QAAQC,SAC3B7gB,SAASO,KAAKG,YAAYgJ,GA+CxBsX,CAAe,EAAKpgB,MAAMW,OAZ1B,IAAM6e,EAASjN,GAAUvS,EAAMW,KAAKG,MAAO,WAAY,KAAM,KAAM,cAFlD,OAGjB,EAAK4O,MAAQ,CACX2P,SAAU,aAAajR,KAAKoR,EAAOhf,UAJpB,E,qDAgBT,IAAD,OACAG,EAAQ/D,KAAKoD,MAAbW,KACA0e,EAAYziB,KAAK8S,MAAjB2P,SACP,OACE,6BACE,4BAAQpZ,QAASrJ,KAAK0iB,iBAAtB,WACA,4BAAQrZ,QAASrJ,KAAKujB,kBAAtB,YACA,0FACA,6BACE,6BAAK,2BAAOlgB,KAAK,QAAQ2E,GAAG,mBAAmBoU,QAASqG,EAAUnf,SAAU,SAAAuG,GAAC,OAAI,EAAKvG,UAAS,MAAQ,2BAAO+Y,QAAQ,oBAAf,kBACvG,6BAAK,2BAAOhZ,KAAK,QAAQ2E,GAAG,mBAAmBoU,SAAUqG,EAAUnf,SAAU,SAAAuG,GAAC,OAAI,EAAKvG,UAAS,MAAS,2BAAO+Y,QAAQ,oBAAf,cACzG,qIAEF,yBAAK5T,UAAU,mBAAmB+G,MAAO,CAAC8S,WAAY,MAAOmB,SAAU,OAAQ1R,OAAQ,QA7J/F,SAAqBhO,EAAM0e,GACzB,IAAMve,EAAQH,EAAKG,MACbye,EAAWhN,GAAUzR,EAAO,aAAc,QAC1C0e,EAASjN,GAAUzR,EAAO,WAAY,KAAM,KAAM,cAClD2e,EAAUlN,GAAUzR,EAAO,YAAa,OAC9C,OAAOue,EAAQ,gKAQfF,GAAQM,EAAQjf,SARD,qDAYf2e,GAAQI,EAAS/e,SAZF,yCAcf2e,GAAQK,EAAOhf,SAdA,+KAwBf2e,GAAQK,EAAOhf,SAxBA,oDA4Bf2e,GAAQM,EAAQjf,SA5BD,qDAgCf2e,GAAQI,EAAS/e,SAhCF,oCAwJuF8f,CAAY3f,EAAM0e,IAClH,2EACA,6BACE,6BAAK,2BAAOpf,KAAK,QAAQ2E,GAAG,mBAAmBoU,QAASqG,EAAUnf,SAAU,SAAAuG,GAAC,OAAI,EAAKvG,UAAS,MAAQ,2BAAO+Y,QAAQ,oBAAf,kBACvG,6BAAK,2BAAOhZ,KAAK,QAAQ2E,GAAG,mBAAmBoU,SAAUqG,EAAUnf,SAAU,SAAAuG,GAAC,OAAI,EAAKvG,UAAS,MAAS,2BAAO+Y,QAAQ,oBAAf,eAE3G,yBAAK5T,UAAU,mBAAmB+G,MAAO,CAAC8S,WAAY,MAAOmB,SAAU,OAAQ1R,OAAQ,QAjE/F,SAAkBhO,EAAM0e,GACtB,IpB5HuCxY,EoB4HjC/F,EAAQH,EAAKG,MACbye,EAAWhN,GAAUzR,EAAO,aAAc,QAC1C0e,EAASjN,GAAUzR,EAAO,WAAY,KAAM,KAAM,cAClD2e,EAAUlN,GAAUzR,EAAO,YAAa,OAExCyf,QADwBpd,IAAbkc,EAAyBA,EAAW,aAAajR,KAAKoR,EAAOhf,UAE1E,iBACA,GACJ,MAAM,2JAAN,QpBpIuCqG,EoByIHlG,EAAKM,KpBxIlC4F,EAAEC,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,SoBiIvB,kCAOA2Y,EAAQjf,QAPR,gDAWA+e,EAAS/e,QAXT,mBAaG,UAbH,OAac+f,EAbd,cAcAf,EAAOhf,QAdP,SAeI,SAfJ,gBAwDsGggB,CAAS7f,EAAM0e,S,GApCnFjZ,IAAMC,WCtJrBoa,G,kDACnB,aAAgB,IAAD,8BACb,gBAcFC,YAAc,WACZ,EAAKpY,eAhBQ,EAkBfqY,aAAe,WACb,EAAKpR,SAAS,CAAChO,QAAS,EAAKmO,MAAMnO,UAnBtB,EAqBfqf,QArBe,sBAqBL,sDAAAlO,EAAA,+DACmB,EAAKjK,QAAzBwT,EADC,EACDA,OAAQD,EADP,EACOA,SACRza,EAAU,EAAKmO,MAAfnO,OACP,EAAKgO,SAAS,CAACsR,QAAQ,IAHf,EAIwB,EAAK7gB,MAA9BW,EAJC,EAIDA,KAAMmgB,EAJL,EAIKA,OAAQhb,EAJb,EAIaA,QACjBib,GAAU,EALN,kBAO0C9E,EAAO+E,WAAWrgB,EAAMY,GAPlE,gBAOCqD,EAPD,EAOCA,GAAI3D,EAPL,EAOKA,KAAM6D,EAPX,EAOWA,KAAc+U,EAPzB,EAOiBtX,OACvB4B,GAAcS,EAAI3D,EAAM6D,EAAM+U,GAC9BiH,EAAOlc,GACPmc,GAAU,EAVJ,kDAYN/E,EAAS,0BAAD,cAZF,QAcR,EAAKzM,SAAS,CAACsR,QAAQ,IACnBE,GACFjb,IAhBM,0DArBK,EAwCfmb,iBAxCe,sBAwCI,oDAAAvO,EAAA,+DACU,EAAKjK,QAAzBwT,EADU,EACVA,OAAQD,EADE,EACFA,SACf,EAAKzM,SAAS,CAACsR,QAAQ,IAFN,EAGe,EAAK7gB,MAA9BW,EAHU,EAGVA,KAAMqe,EAHI,EAGJA,OAAQlZ,EAHJ,EAGIA,QACjBib,GAAU,EAJG,kBAMiC9E,EAAOtX,WAAWqa,EAAQre,GAN3D,gBAMRiE,EANQ,EAMRA,GAAI3D,EANI,EAMJA,KAAM6D,EANF,EAMEA,KAAc+U,EANhB,EAMQtX,OACvB4B,GAAcS,EAAI3D,EAAM6D,EAAM+U,GAC9BkH,GAAU,EARK,kDAUf/E,EAAS,0BAAD,cAVO,QAYjB,EAAKzM,SAAS,CAACsR,QAAQ,IACnBE,GACFjb,IAde,0DAxCJ,EAyDfob,YAzDe,sBAyDD,4DAAAxO,EAAA,+DACe,EAAKjK,QAAzBwT,EADK,EACLA,OAAQD,EADH,EACGA,SADH,EAE4B,EAAKhc,MAAtCW,EAFK,EAELA,KAAMqe,EAFD,EAECA,OAAQ8B,EAFT,EAESA,OAAQhb,EAFjB,EAEiBA,QACtBvE,EAAU,EAAKmO,MAAfnO,OACP,EAAKgO,SAAS,CAACsR,QAAQ,IACnBE,GAAU,EALF,kBAOgB9E,EAAOkF,SAASnC,EAAQzd,GAPxC,uBAOC6f,EAPD,EAOHxc,GAPG,UAQsCqX,EAAOtX,WAAWyc,EAAOzgB,GAR/D,iBAQHiE,EARG,EAQHA,GAAI3D,EARD,EAQCA,KAAM6D,EARP,EAQOA,KAAc+U,EARrB,EAQatX,OACvB4B,GAAcS,EAAI3D,EAAM6D,EAAM+U,GAC9BiH,EAAOlc,GACPmc,GAAU,EAXA,kDAaV/E,EAAS,mCAAD,cAbE,QAeZ,EAAKzM,SAAS,CAACsR,QAAQ,IACnBE,GACFjb,IAjBU,0DAvDZ,EAAK4J,MAAQ,CACXmR,QAAQ,EACRtf,QAAQ,GAJG,E,gEAQS3E,KAAK6L,QAApB+S,YACKjd,UAAU3B,KAAK8jB,e,6CAGL9jB,KAAK6L,QAApB+S,YACKxe,YAAYJ,KAAK8jB,e,oCAgEhB,IACNlF,EAAe5e,KAAK6L,QAApB+S,YACP,OACE,6BACE,4BACEvV,QAASuV,EAAYxY,OADvB,wB,mCAMQ,IAAD,EACcpG,KAAK8S,MAAvBmR,EADI,EACJA,OAAQtf,EADJ,EACIA,OAETuB,EADgBlG,KAAK6L,QAApB+S,YACsBpY,cAHlB,EAImBxG,KAAKoD,MAA5Bgf,EAJI,EAIJA,OAAQqC,EAJJ,EAIIA,YACTC,EAAYxe,GAAYkc,GAAUlc,EAAS8B,KAAOyc,EAClDE,EAAUze,GAAYkc,GAAUlc,EAAS8B,KAAOyc,EACtD,OACE,6BACE,6BACE,4BACEhc,UAAW0B,EAAW,CAAC8V,SAAUgE,IACjCW,YAAU,MACVvb,QAASrJ,KAAKgkB,SAHhB,oBAKA,4BACEvb,UAAW0B,EAAW,CAAC8V,UAAWyE,GAAaT,IAC/CW,YAAU,SACVvb,QAASrJ,KAAKqkB,kBAHhB,uBAKA,4BACE5b,UAAW0B,EAAW,CAAC8V,UAAW0E,GAAWV,IAC7CW,YAAU,OACVvb,QAASrJ,KAAKskB,aAHhB,uBAMF,6BACE,6BACA,2BACEjhB,KAAK,WACL+Y,QAASzX,EACTqD,GAAG,cACH1E,SAAUtD,KAAK+jB,eAEjB,2BAAO1H,QAAQ,eAAf,qBACA,+CACE,4BACE,+EACA,iGAHJ,IAKG,uBAAG1T,KAAK,0FAA0FpF,OAAO,SAASmF,IAAI,uBAAtH,YALH,S,+BAcN,OAFsB1I,KAAK6L,QAApB+S,YACsBpY,cACXxG,KAAK6kB,aAAe7kB,KAAKugB,kB,GAzIP/W,IAAMC,WCH/B,SAASqb,GAAW1hB,GAAQ,IAClCW,EAAQX,EAARW,KACP,OACE,6BACE,mIAE6B,8BAAOtC,OAAO8D,SAASC,OAAvB,oBAF7B,KAIA,yBAAKiD,UAAU,mBAAmB+G,MAAO,CAAC8S,WAAY,QAASte,KAAKkB,UAAUnB,IAC9E,6BAAK,uBAAGR,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,UAAKlH,OAAO8D,SAASC,OAArB,gBAAmC6a,mBAAmB,GAAD,OAAI5e,OAAO8D,SAASC,OAApB,oBAAtG,aCPI,SAASuf,GAAU3hB,GAAQ,IAElCwF,ENiBD,SAAgC7E,GACrC,IAAMqO,EAAOpO,KAAKkB,UAAUnB,GACtB6d,EAAMX,GAAY+D,OAAO5S,GACzB6S,EAAaC,aAAQtD,GACrBuD,EAAgBF,EAAWrkB,OAASghB,EAAIhhB,OACxC4gB,EAASwD,aAAOG,EAAgBF,EAAarD,GAC9C1X,QAAQ,MAAO,KACfA,QAAQ,MAAO,KAEpB,MAAM,GAAN,OADeib,EA1BQ,QACE,QA0BzB,OAAmB3D,GM1BP4D,CADGhiB,EAARW,MAEDiJ,EAAG,UAAMvL,OAAO8D,SAASC,OAAtB,gBAAoC6a,mBAAmBzX,IAChE,OAAOoE,EAAIpM,OAAS,IAEhB,6BACE,+DACA,uBAAG6H,UAAU,WAAWE,KAAMqE,EAAKzJ,OAAO,SAASmF,IAAI,uBAAuBsE,IAIhF,yBAAKqY,MAAM,aAAX,4BCPS,SAASC,GAAKliB,GAAQ,IAC5BW,EAA8CX,EAA9CW,KAAMqe,EAAwChf,EAAxCgf,OAAQqC,EAAgCrhB,EAAhCqhB,YAAaP,EAAmB9gB,EAAnB8gB,OAAQhb,EAAW9F,EAAX8F,QAC1C,OACE,kBAAC,EAAD,CAAQC,MAAM,OAAOD,QAASA,GAC5B,kBAAC6X,GAAD,CAAS/I,QAAQ,gBACf,kBAAC,GAAD,CAAYoK,OAAQA,EAAQqC,YAAaA,EAAa1gB,KAAMA,EAAMmF,QAASA,EAASgb,OAAQA,KAE9F,kBAACnD,GAAD,CAAS/I,QAAQ,eACf,kBAAC+M,GAAD,CAAWhhB,KAAMA,KAEnB,kBAACgd,GAAD,CAAS/I,QAAQ,gBACf,kBAAC8M,GAAD,CAAY/gB,KAAMA,KAEpB,kBAACgd,GAAD,CAAS/I,QAAQ,aACf,kBAACmK,GAAD,CAAOC,OAAQA,KAEjB,kBAACrB,GAAD,CAAS/I,QAAQ,aACf,kBAAC,GAAD,CAAQjU,KAAMA,MHwHtB8f,GAAWjW,YAAcpD,E,oFIpIzB,SAAS+a,GAAYniB,GAAQ,IACpBgG,EAAgChG,EAAhCgG,SAAU9F,EAAsBF,EAAtBE,SAAU8a,EAAYhb,EAAZgb,SAC3B,OACE,yBAAK3V,UAAW0B,EAAW,CAACqb,cAAepH,IAAY/U,QAAS/F,GAC7D8F,GAKP,SAASqc,GAAMriB,GAAQ,IACdgb,EAAgChb,EAAhCgb,SAAU9a,EAAsBF,EAAtBE,SAAU8F,EAAYhG,EAAZgG,SAErBsc,EAAclc,IAAMmc,SAASvhB,IAAIgF,GAAU,SAACvG,GAChD,IAAK2G,IAAMoc,eAAe/iB,GACxB,OAAO,KAFiD,IAKnDwF,EAAUxF,EAAMO,MAAhBiF,OACDwd,EAAaxd,IAAW+V,EAI9B,OAAO5U,IAAMsc,aAAajjB,EAAO,CAE/Bub,SAAUyH,EACVviB,SAAU,kBAAMA,EAAS+E,SAI7B,OACE,yBAAKI,UAAU,SACZid,GAKP,SAASK,GAAS3iB,GAAQ,IACjB4E,EAAgC5E,EAAhC4E,GAAIge,EAA4B5iB,EAA5B4iB,MAAO5J,EAAqBhZ,EAArBgZ,QAAS9Y,EAAYF,EAAZE,SACrB2iB,EAAM,mBAAeje,GAC3B,OACE,6BACE,2BACEA,GAAIie,EACJ5iB,KAAK,WACL+Y,QAASA,EACT9Y,SAAU,SAACnC,GAAD,OAAOmC,EAASnC,EAAEoC,OAAO6Y,YAErC,2BAAOC,QAAS4J,GAASD,I,IAKzBE,G,4MASJza,aAAe,WACb,EAAKC,e,EAEPya,aAAe,WACS,EAAKta,QAApB+S,YACKwH,U,kEAZUpmB,KAAK6L,QAApB+S,YACKjd,UAAU3B,KAAKyL,gB,6CAGLzL,KAAK6L,QAApB+S,YACKxe,YAAYJ,KAAKyL,gB,+BASrB,IAEFvF,EADgBlG,KAAK6L,QAApB+S,YACsBpY,cAC7B,QAAUN,GACR,kBAAC6a,GAAD,CAAS/I,QAAQ,UACf,yBAAKvP,UAAU,UAAf,sBACKvC,EAASE,OAAS,yBAAKqC,UAAU,YAAW,uBAAGlF,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,6BAAwBzC,EAASE,QAAUF,EAASE,UACjJF,EAASI,YAAc,uBAAGmC,UAAU,cAAclF,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,6BAAwBzC,EAASE,QAAS,yBAAKqC,UAAU,SAASG,IAAK1C,EAASI,WAAYuC,IAAI,aAErM,4BAAQQ,QAASrJ,KAAKmmB,cAAtB,e,GAzBa3c,IAAMC,WA+B3Byc,GAAOtY,YAAcpD,E,IAEA6b,G,4MAUnB5a,aAAe,WACb,EAAKC,e,EAEP4a,mBAAqB,SAACvkB,GACpB8Q,GAAY,SAAU9Q,I,EAExBwkB,mBAAqB,SAACxkB,GACpB8Q,GAAY,SAAU9Q,I,EAExBykB,wBAA0B,SAACzkB,GACzB8Q,GAAY,cAAe9Q,I,EAE7B0kB,iBAAmB,SAAC1kB,GAClB8Q,GAAY,OAAQ9Q,I,EAEtB2kB,2BAA6B,SAAC3kB,GAC5B8Q,GAAY,iBAAkB9Q,I,kEArB9B8Q,GAAkB7S,KAAKyL,gB,6CAGvBoH,GAAoB7S,KAAKyL,gB,+BAoBjB,IACDvC,EAAWlJ,KAAKoD,MAAhB8F,QAEDhD,EADgBlG,KAAK6L,QAApB+S,YACsBpY,cAC7B,OACE,kBAAC,EAAD,CAAQ2C,MAAM,WAAWD,QAASA,KAC5BhD,GAAY,kBAAC,GAAD,MAChB,kBAAC6a,GAAD,CAAS/I,QAAQ,UACf,yBAAKvP,UAAU,UACb,kBAACgd,GAAD,CAAOrH,SAAUvL,KAAcjB,OAAQtO,SAAUtD,KAAKsmB,oBACpD,kBAACf,GAAD,CAAald,OAAQ,GAAG,yBAAKO,IAAK+d,KAAc9d,IAAI,cACpD,kBAAC0c,GAAD,CAAald,OAAQ,GAAG,yBAAKO,IAAKge,KAAgB/d,IAAI,gBACtD,kBAAC0c,GAAD,CAAald,OAAQ,GAAG,yBAAKO,IAAKie,KAAche,IAAI,SACpD,kBAAC0c,GAAD,CAAald,OAAQ,GAAG,yBAAKO,IAAKke,KAAYje,IAAI,eAIxD,kBAACkY,GAAD,CAAS/I,QAAQ,UACf,yBAAKvP,UAAU,YACb,kBAACgd,GAAD,CAAOrH,SAAUvL,KAAcb,OAAQ1O,SAAUtD,KAAKumB,oBACpD,kBAAChB,GAAD,CAAald,OAAO,UAAS,wCAC7B,kBAACkd,GAAD,CAAald,OAAO,cAAa,6CAEnC,kBAAC0d,GAAD,CAAU/d,GAAG,SAASge,MAAM,eAAe5J,QAASvJ,KAAcZ,YAAa3O,SAAUtD,KAAKwmB,0BAC9F,kBAACT,GAAD,CAAU/d,GAAG,OAAOge,MAAM,mBAAmB5J,QAASvJ,KAAcX,KAAM5O,SAAUtD,KAAKymB,mBACzF,kBAACV,GAAD,CAAU/d,GAAG,aAAage,MAAM,kBAAkB5J,QAASvJ,KAAcV,eAAgB7O,SAAUtD,KAAK0mB,oC,GArD9Eld,IAAMC,WCjG7B,SAASsd,GAAQ3jB,GAAQ,IAEpC4jB,EAEE5jB,EAFF4jB,WACAzK,EACEnZ,EADFmZ,WAGA0K,EAQED,EARFC,UACAC,EAOEF,EAPFE,WACAC,EAMEH,EANFG,WACAC,EAKEJ,EALFI,UACAC,EAIEL,EAJFK,WACAC,EAGEN,EAHFM,iBACAC,EAEEP,EAFFO,eACAC,EACER,EADFQ,WAEF,OACE,yBAAK/e,UAAU,WACb,4BAAQa,SAAS,IAAID,QAAS4d,GAA9B,OACA,4BAAQ3d,SAAS,IAAID,QAAS6d,GAA9B,QACA,4BAAQ5d,SAAS,IAAID,QAAS8d,GAA9B,QACA,4BAAQ7d,SAAS,IAAID,QAAS+d,GAA9B,OACA,4BAAQ9d,SAAS,IAAID,QAASge,GAA9B,QACA,4BAAQ/d,SAAS,IAAID,QAASke,EAAgBpe,MAAM,YAAW,yBAAKP,IAAG,UAAKnH,OAAO8D,SAASC,OAArB,8BAAyDqD,IAAI,cACpI,4BAAQS,SAAS,IAAID,QAASie,EAAkBne,MAAM,cAAa,yBAAKP,IAAG,UAAKnH,OAAO8D,SAASC,OAArB,6BAAgD+W,EAAa,MAAQ,GAArE,kBAAyF1T,IAAI,gBACxK,4BAAQS,SAAS,IAAID,QAASme,EAAYre,MAAM,QAAhD,MDsINkd,GAASzY,YAAcpD,EE9JvB,IAEqBid,G,WACnB,cAII,IAAD,OAHDC,EAGC,EAHDA,aACArI,EAEC,EAFDA,OACAD,EACC,EADDA,SACC,yBAgDHuI,eAhDG,sBAgDc,8BAAA7R,EAAA,yDACf,EAAK5P,cAAWK,EACVV,EAAM,EAAK6hB,aAAa7hB,MAC9B,EAAKwZ,OAAOuI,OAAO/hB,IACfA,EAJW,0CAMQ,EAAKwZ,OAAOwI,uBANpB,OAML9jB,EANK,OAOX,EAAKmC,SAAWnC,EAPL,kDASX,EAAKqb,SAAL,MATW,QAYf,EAAKne,oBAAoBO,OAnEL,UAuDL,0DAhDd,KA8DH4E,MAAQ,WACN,EAAKshB,aAAathB,SA/DjB,KAiEHggB,OAAS,WACP,EAAKsB,aAAatB,SAClB,EAAK/G,OAAOuI,UAlEZ5nB,KAAK0nB,aAAeA,EACpB1nB,KAAKqf,OAASA,EACdrf,KAAKiB,oBAAsB,IAAInB,EAC/BE,KAAKof,SAAWA,EAChBsI,EAAa/lB,UAAU3B,KAAK2nB,gBAC5B3nB,KAAK2nB,iBACL3nB,KAAKkG,cAAWK,E,0DAuChB,OAAOvG,KAAKkG,W,gCAuBJ/F,GACRH,KAAKiB,oBAAoBU,UA7EL,SA6EgCxB,K,kCAE1CA,GACVH,KAAKiB,oBAAoBb,YAhFL,SAgFkCD,K,gCAGtDH,KAAK0nB,aAAatnB,YAAYJ,KAAK2nB,oB,KC5DjCG,I,OAAQ,iBAAM,KACd1U,GAAc3R,OAAO4R,WAAW,gCA8UvB0U,G,kDA3Ub,WAAY3kB,GAAQ,IAAD,8BACjB,gBAwJF4kB,eAAiB,WACf,EAAKtc,eA1JY,EA4JnBuc,cAAgB,SAAClkB,GACf,IAAIogB,GAAU,EACd,IACE9R,GAActO,GACd,EAAKgc,cAAcD,cACnB,MAAO3e,GACPgjB,GAAU,EACVpF,QAAQmJ,KAAK/mB,GACb,EAAKie,SAAL,mCAA0Cje,IAExCgjB,GACF,EAAK8C,aAvKU,EA0KnB7b,OAAS,SAACuB,EAAKlE,GACb,OAAQA,GACN,IAAK,QACHsW,QAAQoJ,MAAMxb,GACd,MACF,QACEoS,QAAQC,IAAIrS,GAGhB,EAAKgG,SAAS,CAACyV,SAAS,CAAE,CAACzb,IAAKA,EAAIgB,WAAYlF,cAAzB,mBAAwC,EAAKqK,MAAMsV,aAC1EC,YAAW,WACT,EAAK1V,SAAS,CAACyV,SAAU,EAAKtV,MAAMsV,SAAStnB,MAAM,EAAG,EAAKgS,MAAMsV,SAASxnB,OAAS,OAClF,MAtLc,EAwLnB0nB,QAAU,SAAC3b,GAAD,OAAS,EAAKvB,OAAOuB,EAAK,SAxLjB,EAyLnByS,SAAW,SAACzS,GAAD,OAAS,EAAKvB,OAAOuB,EAAK,UAzLlB,EA0LnB4b,YAAc,WACZ,EAAK5V,SAAS,CAAC6V,OAAQV,MA3LN,EA6LnB/U,kBAAoB,SAACoF,GACnB,EAAKsQ,UAAYtQ,EACjB,EAAK+O,cA/LY,EAiMnBE,UAjMmB,sBAiMP,sBAAAtR,EAAA,sDACV,EAAKiK,cAAcD,cACnBre,OAAO8D,SAASoD,KAAOlH,OAAO8D,SAASC,OAF7B,2CAjMO,EAqMnByhB,UArMmB,sBAqMP,sBAAAnR,EAAA,sDACV,EAAKiK,cAAc2I,UAAU1kB,KAAKkB,UAAU,CAC1CyD,KAAMlH,OAAO8D,SAASoD,KACtB5E,KAAMsO,KACNoS,YAAa,EAAK3R,MAAM2R,eAE1B,EAAK3Y,WAAWnB,QAChBoU,QAAQpU,QACR,EAAK8d,UAAUpZ,IAAIgD,MART,2CArMO,EA+MnB6U,WA/MmB,sBA+MN,sBAAApR,EAAA,sDACX,EAAK2S,UAAUpZ,IAAIgD,MAAsB,GAD9B,2CA/MM,EAkNnB8U,WAlNmB,sBAkNN,sBAAArR,EAAA,sDACX,EAAKnD,SAAS,CAAC6V,OAAQ,EAAK3D,aADjB,2CAlNM,EAqNnB0C,eAAiB,WACf,EAAK5U,SAAS,CAAC6V,OAAQ,EAAKG,kBAtNX,EAwNnBrB,iBAAmB,WACjB,EAAK3U,SAAS,CAAC4J,YAAa,EAAKzJ,MAAMyJ,cAzNtB,EA2NnBiL,WAAa,WACX,EAAK7U,SAAS,CAAC6V,OAAQ,EAAKI,cA5NX,EA8NnBvB,WAAa,WACX,EAAK1U,SAAS,CAAC6V,OAAQ,EAAKlI,cA/NX,EAiOnBuI,aAjOmB,sBAiOJ,sBAAA/S,EAAA,sDACb,EAAKnD,SAAS,CAAC6V,OAAQV,KACvB,EAAKb,YAFQ,2CAjOI,EAqOnB6B,aAAe,SAAC1G,GACd3gB,OAAOsnB,QAAQC,UAAU,GAAI,GAA7B,UAAoCvnB,OAAO8D,SAASC,OAApD,gBAAkE4c,IAClE,EAAKzP,SAAS,CACZyP,SACAqC,YAAa,EAAK7F,YAAYpY,cAAcwB,MAzO7B,EA4OnBihB,YAAc,WACZ,EAAKC,SA7OY,EA+OnBN,WAAa,WACX,OAAQ,kBAAClf,EAAD,CAAMR,QAAS,EAAKqf,eAhPX,EAkPnBI,eAAiB,WACf,OACE,kBAAC,GAAD,CAAUzf,QAAS,EAAKqf,eApPT,EAuPnBjI,WAAa,WACX,OACE,kBAACU,GAAD,CACEJ,OAAQ,EAAKiI,aACb3f,QAAS,EAAKqf,eA3PD,EA+PnB1D,WAAa,WACX,IAAM9gB,EAAOsO,KACb,OACE,kBAACiT,GAAD,CACEpB,OAAQ,EAAK4E,aACb5f,QAAS,EAAKqf,YACdnG,OAAQ,EAAKtP,MAAMsP,OACnBqC,YAAa,EAAK3R,MAAM2R,YACxB1gB,KAAMA,KArQV,EAAK+O,MAAQ,CACXqW,KAAM1nB,OAAO8D,SAAS6jB,SACtBC,KAAMjW,GAAYuB,QAClB4H,aAAclL,GAAMkL,WACpB+C,SAAS,EACTkJ,OAAQV,GACR1F,OAAQ,GACRgG,SAAU,GACVliB,SAAU,GACVojB,cAAe,GAEjB,EAAKjK,OAAS,IAAIzZ,EAClB,EAAK8hB,aAAetkB,EAAMskB,aAC1B,EAAK3H,cAAgB3c,EAAM2c,cAC3B,EAAKjU,WAAa,IAAIpB,EACtB,EAAKkU,YAAc,IAAI6I,GAAY,CACjCC,aAAc,EAAKA,aACnBrI,OAAQ,EAAKA,OACbD,SAAU,EAAKA,WAEjB,EAAK4H,WAAa,CAChBC,UAAW,EAAKA,UAChBC,WAAY,EAAKA,WACjBC,WAAY,EAAKA,WACjBC,UAAW,EAAKA,UAChBC,WAAY,EAAKA,WACjBE,eAAgB,EAAKA,eACrBD,iBAAkB,EAAKA,iBACvBE,WAAY,EAAKA,YA9BF,E,mEAkCjB3U,GAAoB7S,KAAKgoB,gBACzBhoB,KAAK4e,YAAY2K,Y,0CAEE,IAAD,OA4ClB,GA3CA1W,GAAkB7S,KAAKgoB,gBACvBtY,EAAa,UAAW,KAAM1P,KAAKioB,eACnCjoB,KAAKqf,OAAO3d,iBAAiB,YAAY,SAACP,GACxC,EAAKwR,SAAS,CACZzM,SAAU/E,EAAE4C,UAGhBsO,GAAU,OAAQ5Q,OAAO8D,SAAS6jB,UAClC/W,GAAgB,QAAQ,SAAChC,GACvB5O,OAAOsnB,QAAQC,UAAU,GAAI,GAAI3Y,GACjC,EAAKsC,SAAS,CACZwW,KAAM9Y,OAmBVgC,GjCoB2B,gBiCpBY,SAAAxI,GACrC,EAAK6B,iBAIP2G,GAAgB,iBAAiB,SAAAxI,GAC/B,EAAK8I,SAAS,CAAC2W,cAAe,EAAKxW,MAAMwW,cAAgB,OAG3DlW,GAAY1R,iBAAiB,UAAU,WACrC,EAAKiR,SAAS,CAAC0W,KAAMjW,GAAYuB,aAG/BtD,GAAMmY,QAGR,OAFA/nB,OAAOsnB,QAAQC,UAAU,GAAI,GAA7B,UAAoCvnB,OAAO8D,SAASC,cACpD/D,OAAOgoB,OAAO3a,YAAY,CAACzL,KAAM,gBAAiB,KAIpD,IAAMqmB,EAAS1pB,KAAK+f,cAAc4J,YAC9BC,GAAS,EACb,GAAIF,EAAQ,CACV,IACE,IAAM3lB,EAAOC,KAAKC,MAAMylB,GACxB,GAAI3lB,EAAK4E,OAASlH,OAAO8D,SAASoD,KAAM,CACtC0J,GAActO,EAAKA,MACnB,IAAMiJ,EAAM,IAAIO,IAAIxJ,EAAK4E,MAClBC,EAAOtE,OAAO6K,YAAY,IAAI1B,gBAAgBT,EAAIU,QAAQnJ,WAA1DqE,IACHmZ,GAASnZ,IACX5I,KAAK2S,SAAS,CAACyP,OAAQxZ,EAAK6b,YAAa1gB,EAAK0gB,cAEhDmF,GAAS,EACT5pB,KAAKsoB,QAAQ,qCAEf,MAAOnnB,GACP4d,QAAQC,IAAI,cAEdhf,KAAK+f,cAAcD,cAEhB8J,GACCvY,GAAMzI,KACR5I,KAAK6pB,SAASxY,GAAMzI,KAGxB5I,KAAK8pB,gB,2CAGL9pB,KAAK8pB,gB,oCAGL,IAAM/lB,EAAOsO,KACb7P,SAAS2G,MAAQpF,EAAKM,MAAQ,W,wEAEjBuE,G,mFACb5I,KAAK2S,SAAS,CAAC2M,SAAS,IACpB6E,GAAU,EACV4F,GAAW,E,gCAGuB/H,GAAgBpZ,EAAK5I,KAAKqf,Q,uBAArDtb,E,EAAAA,KAAMiE,E,EAAAA,GAAIL,E,EAAAA,QACjB0K,GAActO,GACViE,GACFhI,KAAK2S,SAAS,CACZyP,OAAQxZ,EACR6b,YAAW,OAAE9c,QAAF,IAAEA,GAAF,UAAEA,EAASxB,aAAX,aAAE,EAAgB6B,K,2DAK7B+hB,E,iBACF/pB,KAAK4e,YAAYwH,SACjB2D,GAAW,E,+BAEX5F,GAAU,EACVpF,QAAQmJ,KAAR,MACAloB,KAAKof,SAAL,qCAA4CxW,EAA5C,mB,oDAKN5I,KAAK2S,SAAS,CAAC2M,SAAS,IACpB6E,GACFnkB,KAAKinB,Y,gJAqHP,IAAMljB,EAAOsO,KADN,EAQHrS,KAAK8S,MALPwM,EAHK,EAGLA,QACAkJ,EAJK,EAILA,OACexU,EALV,EAKLsV,cACApjB,EANK,EAMLA,SACAqW,EAPK,EAOLA,WAEIvK,EAASa,KAAcb,OAC7B,OACE,yBAAKvJ,UAAW0B,EAAW,MAAD,iBAAkB6H,KAC1C,kBAAC,EAAegY,SAAhB,CAAyB7nB,MAAO,CAC9Bkd,OAAQrf,KAAKqf,OACbD,SAAUpf,KAAKof,SACfkJ,QAAStoB,KAAKsoB,QACdvnB,iBACA+K,WAAY9L,KAAK8L,WACjB8S,YAAa5e,KAAK4e,YAClBmB,cAAe/f,KAAK+f,gBAEtB,yBAAKtX,UAAU,WACb,yBAAKA,UAAU,OACb,yBAAKA,UAAU,QACb,yBAAKA,UAAU,QACb,kBAACtF,EAAD,CAAUhB,MAAO4B,EAAKM,KAAMf,SAAU,SAAAvB,GAAC,OjCxK/BsC,EiCwKiDtC,EjCvKvEgC,GAAKM,KAAOA,EACZqM,UACAC,KAHK,IAAiBtM,OiCyKL6B,EAAS7B,MAAQ,yBAAKoE,UAAU,YAAW,uBAAGlF,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,6BAAwBzC,EAAS7B,OAAS6B,EAAS7B,SAC/I6B,EAASG,WAAa,uBAAG9C,OAAO,SAASmF,IAAI,sBAAsBC,KAAI,6BAAwBzC,EAAS7B,OAAQ,yBAAKoE,UAAU,SAASG,IAAK1C,EAASG,UAAWwC,IAAI,cAG5K,yBAAKJ,UAAU,SACb,kBAACse,GAAD,CAASC,WAAYhnB,KAAKgnB,WAAYzK,WAAYA,IAClD,kBAAC/T,EAAD,SAID8W,GACC,yBAAK7W,UAAU,UACb,kBAAC,GAAD,CACEuL,QAASA,EACTjQ,KAAMA,EACNgP,kBAAmB/S,KAAK+S,kBACxBwJ,WAAYA,MAWrBiM,IACD,yBAAK/f,UAAU,YAEXzI,KAAK8S,MAAMsV,SAAShkB,KAAI,WAAmB4U,GAAnB,IAAErM,EAAF,EAAEA,IAAKlE,EAAP,EAAOA,UAAP,OAA0B,yBAAKA,UAAWA,EAAWrH,IAAG,aAAQ4X,IAAMrM,a,GAnUxFnD,IAAMC,W,oDC1BHwgB,G,WAGnB,WAAYlpB,GAAiB,8EAC3B,aAAAf,KAAA,QAAuBe,E,wDAGvB,OAAO,aAAAf,KAAA,QAAqBM,IATd,Y,gCAWNyD,GACR,aAAA/D,KAAA,QAAqBO,IAZP,SAYsBwD,K,oCAGpC,aAAA/D,KAAA,QAAqBa,OAfP,c,KCSZqpB,GAAcC,uC,IAKCC,G,WAKnB,WAAYrpB,GAAiC,IAAD,gCAJpCspB,YAIoC,OAHpCC,YAGoC,OAFpCC,qBAEoC,OA2B5CC,aA3B4C,uCA2B7B,WAAO1jB,GAAP,qBAAAgP,EAAA,sEAELxI,EAAS,CACbmd,OjD3CF,uBiD4CEC,KAAM5jB,EAAK4jB,MAEP1d,EAAMI,EAAU8c,GAAa5c,GANxB,SAOOyI,MAAM/I,GAPb,cAOLgJ,EAPK,gBAQQA,EAAI5D,OARZ,WAQLrO,EARK,QASD4mB,aATC,uBAUH,IAAIxjB,MAAMnD,KAAKkB,UAAUnB,IAVtB,QAYX,EAAKwmB,gBAAgBhqB,IAnDZ,MAmDwBwD,EAAK4mB,cAZ3B,kDAcX5L,QAAQoJ,MAAR,MAdW,0DA3B6B,2DA4C5C/B,OAAS,WACP,EAAKmE,gBAAgB1pB,OAzDV,QAY+B,KA+C5CuF,MAAQ,WACN,EAAKwkB,cACL,EAAKN,OAAL,UAAiBrR,KAAKC,MAAtB,YAA+BC,KAAKC,UACpC,IAAMpM,EAAMI,EAAU,2CAA4C,CAChEyd,UjDhEA,uBiDiEAC,MAAO,OACPhY,MAAO,EAAKwX,SAEd,EAAKD,O9BvCF,SAAqBrd,GAAsD,IAAzC+d,EAAwC,uDAA1B,GAC/CjZ,EAAQiZ,EAAOjZ,OAAS,IACxBC,EAASgZ,EAAOhZ,QAAU,IAC1BwC,EAAU,CACdzC,MAAOA,EACPC,OAAQA,EACRiZ,IAAKvpB,OAAOwpB,SAAYxpB,OAAOypB,YAAcnZ,GAAU,IACvDjI,KAAMrI,OAAO0pB,SAAY1pB,OAAO2pB,WAAatZ,GAAS,GAExD,OAAOrQ,OAAO4pB,KAAKre,EAAK,SAAU9H,GAAUqP,EAAS,YAAShO,E8B8B9C+kB,CAAYte,IAtD1BhN,KAAKqqB,YAAS9jB,EACdvG,KAAKsqB,YAAS/jB,EACdvG,KAAKuqB,gBAAkBxpB,EACvB2O,EAAa,OAAQ,MAAM,SAAC3L,GAC1B,EAAK6mB,cACD7mB,EAAK+O,QAAU,EAAKwX,QACtB,EAAKE,aAAazmB,M,kDAMtB,OAAO/D,KAAKuqB,gBAAgBjqB,IAzBjB,S,gCA2BHH,GACRH,KAAKuqB,gBAAgB5oB,UA5BV,MA4B4BxB,K,kCAE7BA,GACVH,KAAKuqB,gBAAgBnqB,YA/BV,MA+B8BD,K,oCAGrCH,KAAKqqB,SACPrqB,KAAKqqB,OAAOkB,QACZvrB,KAAKqqB,YAAS9jB,O,KC/BAilB,QACW,cAA7B/pB,OAAO8D,SAASuD,UAEe,UAA7BrH,OAAO8D,SAASuD,UAEhBrH,OAAO8D,SAASuD,SAAS2iB,MACvB,2DCRN,IAAM/D,GAAe,IAAI0C,GAAarpB,GAChCgf,GAAgB,IAAIkK,GAAclpB,GAExC2qB,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,GAAD,CAAKlE,aAAcA,GAAc3H,cAAeA,MAElDvd,SAASqpB,eAAe,SDkHpB,kBAAmBpa,WACrBA,UAAUqa,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAa3T,gBAEd4T,OAAM,SAAA/D,GACLpJ,QAAQoJ,MAAMA,EAAM/gB,a,yXEzI5Buc,EAAOwI,QAAU,IAA0B,6C,mBCA3CxI,EAAOwI,QAAU,IAA0B,+C,mBCA3CxI,EAAOwI,QAAU,IAA0B,+C,mBCA3CxI,EAAOwI,QAAU,IAA0B,2C","file":"static/js/main.b2420ab4.chunk.js","sourcesContent":["\nexport default class SubscriptionManager {\n  itemToSubscriptionMap: Map<string, (() => void)[]>;\n  constructor() {\n    this.itemToSubscriptionMap = new Map();\n  }\n  subscribe(item: string, fn: () => void) {\n    this.unsubscribe(item, fn);\n    let fns = this.itemToSubscriptionMap.get(item);\n    if (!fns) {\n      fns = [];\n      this.itemToSubscriptionMap.set(item, fns);\n    }\n    fns.push(fn);\n  }\n  unsubscribe(item: string, fn: () => void): void {\n    const fns = this.itemToSubscriptionMap.get(item);\n    if (fns) {\n      const ndx = fns.indexOf(fn);\n      if (ndx >= 0) {\n        fns.splice(ndx, 1);\n        if (fns.length === 0) {\n          this.itemToSubscriptionMap.delete(item);\n        }\n      }\n    }\n  }\n  notify(item: string): void {\n    const fns = this.itemToSubscriptionMap.get(item);\n    if (fns) {\n      for (const fn of fns.slice()) {\n        fn();\n      }\n    }\n  }\n}","import StorageManager from './libs/StorageManager';\nimport {isDevelopment} from './libs/flags.js';\n\nexport const storageManager = new StorageManager('jsgist');\nexport const clientId = isDevelopment\n    ? 'b7822ff167d2bbe9a361'\n    : 'c055b54872b13c10e4bd';\n\n","import SubscriptionManager from './SubscriptionManager';\n\nexport default class StorageManager {\n  prefix: string;\n  subscriptionManager: SubscriptionManager;\n\n  constructor(prefix: string) {\n    this.prefix = `${prefix}-`;\n    this.subscriptionManager = new SubscriptionManager();\n    window.addEventListener('storage', this._handleNewValue);\n  }\n  private _handleNewValue = (e: StorageEvent) => {\n    const key = e.key;\n    if (key && key.startsWith(this.prefix)) {\n      const unPrefixedKey = key.substr(this.prefix.length);\n      this.subscriptionManager.notify(unPrefixedKey);\n    }\n  }\n  private _addPrefix(key: string): string {\n    return `${this.prefix}${key}`;\n  }\n  subscribe(key: string, fn: () => void): void {\n    this.subscriptionManager.subscribe(key, fn);\n  }\n  unsubscribe(key: string, fn: () => void): void {\n    this.subscriptionManager.unsubscribe(key, fn);\n  }\n  get(key: string, session = false) {\n    const k = this._addPrefix(key);\n    if (session) {\n      const v = sessionStorage.getItem(k);\n      if (v) {\n        return v;\n      }\n    }\n    return localStorage.getItem(k);\n  }\n  set(key: string, value: string, session = false) {\n    const k = this._addPrefix(key);\n    if (session) {\n      sessionStorage.setItem(k, value);\n    }\n    localStorage.setItem(k, value);\n    this.subscriptionManager.notify(key);\n  }\n  delete(key: string, session = false) {\n    const k = this._addPrefix(key);\n    if (session) {\n      sessionStorage.removeItem(k);\n    }\n    localStorage.removeItem(k);\n    this.subscriptionManager.notify(key);\n  }\n  cleanup() {\n    window.removeEventListener('storage', this._handleNewValue);\n  }\n}\n","import './scrollbars.css';\n\n/*\n * Scrollbar Width Test\n * Adds `layout-scrollbar-obtrusive` class to body if scrollbars use up screen real estate\n */\nconst parent = document.createElement(\"div\");\nparent.setAttribute(\"style\", \"width:30px;height:30px;\");\nparent.classList.add('scrollbar-test');\n\nconst child = document.createElement(\"div\");\nchild.setAttribute(\"style\", \"width:100%;height:40px\");\nparent.appendChild(child);\ndocument.body.appendChild(parent);\n\n// Measure the child element, if it is not\n// 30px wide the scrollbars are obtrusive.\nconst scrollbarWidth = 30 - parent.firstChild.clientWidth;\nif(scrollbarWidth) {\n  document.body.classList.add(\"layout-scrollbar-obtrusive\");\n}\n\ndocument.body.removeChild(parent);","import React from 'react';\n\nexport default function EditLine(props) {\n  return (\n    <input\n      type=\"text\"\n      onChange={(e) => {props.onChange(e.target.value)}}\n      placeholder={props.placeholder}\n      value={props.value} />\n  );\n}","import { Octokit } from '@octokit/rest';\n\nconst userAgent = 'jsGist v0.0.1';\nconst emptyValue = '/*bug-in-github-api-content-can-not-be-empty*/';\n\nfunction getEmptyFileHack(file) {\n  return file.content.startsWith(emptyValue)\n                ? file.content.substr(emptyValue.length)\n                : file.content;\n}\n\n// there are 3 forms current\n//\n// 1. files are stored by filename (legacy)\n// 2. files are stored as JSON (this happens if there are any duplicate names)\n// 3. files are stored by filename and filenames references them in order\n\nexport function getGistContent(gist) {\n  const data = JSON.parse(gist.files['jsGist.json'].content);\n  // github stores files by filename but we need them in the same order in the array\n  // they started with so they go to the correct pane.\n  if (data.filenames) {\n    data.files = data.filenames.map(name => {\n      return {\n        name: name,\n        content: getEmptyFileHack(gist.files[name]),\n      };\n    });\n  } else {\n    // legacy path if there are no filenames\n    data.files = Object.entries(gist.files)\n      .filter(([name]) => name !== 'jsGist.json')\n      .map(([name, file]) => {\n        return {\n          name,\n          content: getEmptyFileHack(file),\n        }\n      }).concat(data.files || []);\n  }\n  return data;\n} \n\n/*\n  \"url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9\",\n  \"forks_url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/forks\",\n  \"commits_url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/commits\",\n  \"id\": \"bad0a8491bd6614e729ff01cc14089c9\",\n  \"node_id\": \"MDQ6R2lzdGJhZDBhODQ5MWJkNjYxNGU3MjlmZjAxY2MxNDA4OWM5\",\n  \"git_pull_url\": \"https://gist.github.com/bad0a8491bd6614e729ff01cc14089c9.git\",\n  \"git_push_url\": \"https://gist.github.com/bad0a8491bd6614e729ff01cc14089c9.git\",\n  \"html_url\": \"https://gist.github.com/bad0a8491bd6614e729ff01cc14089c9\",\n  \"files\": {\n    \"index.css\": {\n      \"filename\": \"index.css\",\n      \"type\": \"text/css\",\n      \"language\": \"CSS\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/1847e2c75f6b76223402f69bada71e72db880605/index.css\",\n      \"size\": 243,\n      \"truncated\": false,\n      \"content\": \"body {\\n  margin: 0;\\n}\\n#c {\\n  width: 100vw;\\n  height: 100vh;\\n  display: block;\\n}\\n#info { \\n  position: absolute; \\n  left: 1em; \\n  top: 1em; \\n  background: rgba(0,0,0,.8); \\n  padding: .5em;\\n        color: white;\\n        font-family: monospace;\\n}\\n\"\n    },\n    \"index.html\": {\n      \"filename\": \"index.html\",\n      \"type\": \"text/html\",\n      \"language\": \"HTML\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/c9e9e838f601e2d98d448b035ce3052629969c11/index.html\",\n      \"size\": 46,\n      \"truncated\": false,\n      \"content\": \"<canvas id=\\\"c\\\"></canvas>\\n<div id=\\\"info\\\"></div>\"\n    },\n    \"index.js\": {\n      \"filename\": \"index.js\",\n      \"type\": \"application/javascript\",\n      \"language\": \"JavaScript\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/77a7fca481ff157da44f4196ce253ea282f0abdc/index.js\",\n      \"size\": 8413,\n      \"truncated\": false,\n      \"content\": \"import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/build/three.module.js';\\n\\nfunction main() {\\n  const canvas = document.querySelector('#c');\\n  const renderer = new THREE.WebGLRenderer({canvas: canvas});\\n  renderer.setClearColor(0x88AACC);\\n  renderer.shadowMap.enabled = true;\\n\\n  function makeCamera(fov = 40) {\\n    const aspect = 2;  // the canvas default\\n    const zNear = 0.1;\\n    const zFar = 1000;\\n    return new THREE.PerspectiveCamera(fov, aspect, zNear, zFar);\\n  }\\n  const camera = makeCamera();\\n  camera.position.set(8, 4, 10).multiplyScalar(3);\\n  camera.lookAt(0, 0, 0);\\n\\n  const scene = new THREE.Scene();\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(0, 20, 0);\\n    scene.add(light);\\n    light.castShadow = true;\\n    light.shadow.mapSize.width = 2048;\\n    light.shadow.mapSize.height = 2048;\\n\\n    const d = 50;\\n    light.shadow.camera.left = -d;\\n    light.shadow.camera.right = d;\\n    light.shadow.camera.top = d;\\n    light.shadow.camera.bottom = -d;\\n    light.shadow.camera.near = 1;\\n    light.shadow.camera.far = 50;\\n    light.shadow.bias = 0.001;\\n  }\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(1, 2, 4);\\n    scene.add(light);\\n  }\\n\\n  const groundGeometry = new THREE.PlaneBufferGeometry(50, 50);\\n  const groundMaterial = new THREE.MeshPhongMaterial({color: 0xCC8866});\\n  const groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);\\n  groundMesh.rotation.x = Math.PI * -.5;\\n  groundMesh.receiveShadow = true;\\n  scene.add(groundMesh);\\n\\n  const carWidth = 4;\\n  const carHeight = 1;\\n  const carLength = 8;\\n\\n  const tank = new THREE.Object3D();\\n  scene.add(tank);\\n\\n  const bodyGeometry = new THREE.BoxBufferGeometry(carWidth, carHeight, carLength);\\n  const bodyMaterial = new THREE.MeshPhongMaterial({color: 0x66AA88});\\n  const bodyMesh = new THREE.Mesh(bodyGeometry, bodyMaterial);\\n  bodyMesh.position.y = 1.4;\\n  bodyMesh.castShadow = true;\\n  tank.add(bodyMesh);\\n\\n  const tankCameraFov = 75;\\n  const tankCamera = makeCamera(tankCameraFov);\\n  tankCamera.position.y = 3;\\n  tankCamera.position.z = -6;\\n  tankCamera.rotation.y = Math.PI;\\n  bodyMesh.add(tankCamera);\\n\\n  const wheelRadius = 1;\\n  const wheelThickness = .5;\\n  const wheelSegments = 6;\\n  const wheelGeometry = new THREE.CylinderBufferGeometry(\\n      wheelRadius,     // top radius\\n      wheelRadius,     // bottom radius\\n      wheelThickness,  // height of cylinder\\n      wheelSegments);\\n  const wheelMaterial = new THREE.MeshPhongMaterial({color: 0x888888});\\n  const wheelPositions = [\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, 0],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, 0],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n  ];\\n  const wheelMeshes = wheelPositions.map((position) => {\\n    const mesh = new THREE.Mesh(wheelGeometry, wheelMaterial);\\n    mesh.position.set(...position);\\n    mesh.rotation.z = Math.PI * .5;\\n    mesh.castShadow = true;\\n    bodyMesh.add(mesh);\\n    return mesh;\\n  });\\n\\n  const domeRadius = 2;\\n  const domeWidthSubdivisions = 12;\\n  const domeHeightSubdivisions = 12;\\n  const domePhiStart = 0;\\n  const domePhiEnd = Math.PI * 2;\\n  const domeThetaStart = 0;\\n  const domeThetaEnd = Math.PI * .5;\\n  const domeGeometry = new THREE.SphereBufferGeometry(\\n    domeRadius, domeWidthSubdivisions, domeHeightSubdivisions,\\n    domePhiStart, domePhiEnd, domeThetaStart, domeThetaEnd);\\n  const domeMesh = new THREE.Mesh(domeGeometry, bodyMaterial);\\n  domeMesh.castShadow = true;\\n  bodyMesh.add(domeMesh);\\n  domeMesh.position.y = .5;\\n\\n  const turretWidth = .1;\\n  const turretHeight = .1;\\n  const turretLength = carLength * .75 * .2;\\n  const turretGeometry = new THREE.BoxBufferGeometry(\\n      turretWidth, turretHeight, turretLength);\\n  const turretMesh = new THREE.Mesh(turretGeometry, bodyMaterial);\\n  const turretPivot = new THREE.Object3D();\\n  turretMesh.castShadow = true;\\n  turretPivot.scale.set(5, 5, 5);\\n  turretPivot.position.y = .5;\\n  turretMesh.position.z = turretLength * .5;\\n  turretPivot.add(turretMesh);\\n  bodyMesh.add(turretPivot);\\n\\n  const turretCamera = makeCamera();\\n  turretCamera.position.y = .75 * .2;\\n  turretMesh.add(turretCamera);\\n\\n  const targetGeometry = new THREE.SphereBufferGeometry(.5, 6, 3);\\n  const targetMaterial = new THREE.MeshPhongMaterial({color: 0x00FF00, flatShading: true});\\n  const targetMesh = new THREE.Mesh(targetGeometry, targetMaterial);\\n  const targetOrbit = new THREE.Object3D();\\n  const targetElevation = new THREE.Object3D();\\n  const targetBob = new THREE.Object3D();\\n  targetMesh.castShadow = true;\\n  scene.add(targetOrbit);\\n  targetOrbit.add(targetElevation);\\n  targetElevation.position.z = carLength * 2;\\n  targetElevation.position.y = 8;\\n  targetElevation.add(targetBob);\\n  targetBob.add(targetMesh);\\n\\n  const targetCamera = makeCamera();\\n  const targetCameraPivot = new THREE.Object3D();\\n  targetCamera.position.y = 1;\\n  targetCamera.position.z = -2;\\n  targetCamera.rotation.y = Math.PI;\\n  targetBob.add(targetCameraPivot);\\n  targetCameraPivot.add(targetCamera);\\n\\n  // Create a sine-like wave\\n  const curve = new THREE.SplineCurve( [\\n    new THREE.Vector2( -10, 0 ),\\n    new THREE.Vector2( -5, 5 ),\\n    new THREE.Vector2( 0, 0 ),\\n    new THREE.Vector2( 5, -5 ),\\n    new THREE.Vector2( 10, 0 ),\\n    new THREE.Vector2( 5, 10 ),\\n    new THREE.Vector2( -5, 10 ),\\n    new THREE.Vector2( -10, -10 ),\\n    new THREE.Vector2( -15, -8 ),\\n    new THREE.Vector2( -10, 0 ),\\n  ] );\\n\\n  const points = curve.getPoints( 50 );\\n  const geometry = new THREE.BufferGeometry().setFromPoints( points );\\n  const material = new THREE.LineBasicMaterial( { color : 0xff0000 } );\\n  const splineObject = new THREE.Line( geometry, material );\\n  splineObject.rotation.x = Math.PI * .5;\\n  splineObject.position.y = 0.05;\\n  scene.add(splineObject);\\n\\n  function resizeRendererToDisplaySize(renderer) {\\n    const canvas = renderer.domElement;\\n    const width = canvas.clientWidth;\\n    const height = canvas.clientHeight;\\n    const needResize = canvas.width !== width || canvas.height !== height;\\n    if (needResize) {\\n      renderer.setSize(width, height, false);\\n    }\\n    return needResize;\\n  }\\n\\n  const targetPosition = new THREE.Vector3();\\n  const tankPosition = new THREE.Vector2();\\n  const tankTarget = new THREE.Vector2();\\n\\n  const cameras = [\\n    { cam: camera, desc: 'detached camera', },\\n    { cam: turretCamera, desc: 'on turret looking at target', },\\n    { cam: targetCamera, desc: 'near target looking at tank', },\\n    { cam: tankCamera, desc: 'above back of tank', },\\n  ];\\n\\n  const infoElem = document.querySelector('#info');\\n\\n  function render(time) {\\n    time *= 0.001;\\n\\n    if (resizeRendererToDisplaySize(renderer)) {\\n      const canvas = renderer.domElement;\\n      cameras.forEach((cameraInfo) => {\\n        const camera = cameraInfo.cam;\\n        camera.aspect = canvas.clientWidth / canvas.clientHeight;\\n        camera.updateProjectionMatrix();\\n      });\\n    }\\n\\n    // move target\\n    targetOrbit.rotation.y = time * .27;\\n    targetBob.position.y = Math.sin(time * 2) * 4;\\n    targetMesh.rotation.x = time * 7;\\n    targetMesh.rotation.y = time * 13;\\n    targetMaterial.emissive.setHSL(time * 10 % 1, 1, .25);\\n    targetMaterial.color.setHSL(time * 10 % 1, 1, .25);\\n\\n    // move tank\\n    const tankTime = time * .05;\\n    curve.getPointAt(tankTime % 1, tankPosition);\\n    curve.getPointAt((tankTime + 0.01) % 1, tankTarget);\\n    tank.position.set(tankPosition.x, 0, tankPosition.y);\\n    tank.lookAt(tankTarget.x, 0, tankTarget.y);\\n\\n    // face turret at target\\n    targetMesh.getWorldPosition(targetPosition);\\n    turretPivot.lookAt(targetPosition);\\n\\n    // make the turretCamera look at target\\n    turretCamera.lookAt(targetPosition);\\n\\n    // make the targetCameraPivot look at the at the tank\\n    tank.getWorldPosition(targetPosition);\\n    targetCameraPivot.lookAt(targetPosition);\\n\\n    wheelMeshes.forEach((obj) => {\\n      obj.rotation.x = time * 3;\\n    });\\n\\n    const camera = cameras[time * .25 % cameras.length | 0];\\n    infoElem.textContent = camera.desc;\\n\\n    renderer.render(scene, camera.cam);\\n\\n    requestAnimationFrame(render);\\n  }\\n\\n  requestAnimationFrame(render);\\n}\\n\\nmain();\\n\"\n    },\n    \"jsGist.json\": {\n      \"filename\": \"jsGist.json\",\n      \"type\": \"application/json\",\n      \"language\": \"JSON\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/ac014ca1eb788c3c05b1612902b142f59fca3f7c/jsGist.json\",\n      \"size\": 60,\n      \"truncated\": false,\n      \"content\": \"{\\\"name\\\":\\\"ThreeJSFundamentals Scenegraph Tank\\\",\\\"settings\\\":{}}\"\n    }\n  },\n  \"public\": true,\n  \"created_at\": \"2020-10-11T08:16:53Z\",\n  \"updated_at\": \"2020-11-04T17:41:21Z\",\n  \"description\": \"ThreeJSFundamentals Scenegraph Tank\",\n  \"comments\": 9,\n  \"user\": null,\n  \"comments_url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/comments\",\n  \"owner\": {\n    \"login\": \"greggman\",\n    \"id\": 234804,\n    \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n    \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n    \"gravatar_id\": \"\",\n    \"url\": \"https://api.github.com/users/greggman\",\n    \"html_url\": \"https://github.com/greggman\",\n    \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n    \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n    \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n    \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n    \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n    \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n    \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n    \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n    \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n    \"type\": \"User\",\n    \"site_admin\": false\n  },\n  \"forks\": [\n\n  ],\n  \"history\": [\n    {\n      \"user\": {\n        \"login\": \"greggman\",\n        \"id\": 234804,\n        \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n        \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n        \"gravatar_id\": \"\",\n        \"url\": \"https://api.github.com/users/greggman\",\n        \"html_url\": \"https://github.com/greggman\",\n        \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n        \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n        \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n        \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n        \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n        \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n        \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n        \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n        \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n        \"type\": \"User\",\n        \"site_admin\": false\n      },\n      \"version\": \"fcbedffeccec982c99bc3963ed77f41762a8dd5a\",\n      \"committed_at\": \"2020-10-17T02:08:28Z\",\n      \"change_status\": {\n        \"total\": 4,\n        \"additions\": 2,\n        \"deletions\": 2\n      },\n      \"url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/fcbedffeccec982c99bc3963ed77f41762a8dd5a\"\n    },\n    {\n      \"user\": {\n        \"login\": \"greggman\",\n        \"id\": 234804,\n        \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n        \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n        \"gravatar_id\": \"\",\n        \"url\": \"https://api.github.com/users/greggman\",\n        \"html_url\": \"https://github.com/greggman\",\n        \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n        \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n        \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n        \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n        \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n        \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n        \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n        \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n        \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n        \"type\": \"User\",\n        \"site_admin\": false\n      },\n      \"version\": \"16bda36d8000991414a7240edaf7f5aa709183af\",\n      \"committed_at\": \"2020-10-11T08:16:53Z\",\n      \"change_status\": {\n        \"total\": 273,\n        \"additions\": 273,\n        \"deletions\": 0\n      },\n      \"url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/16bda36d8000991414a7240edaf7f5aa709183af\"\n    }\n  ],\n  \"truncated\": false\n}\n*/\nexport async function getAnonGist(gist_id) {\n  const req = await fetch(`https://api.github.com/gists/${gist_id}`);\n  const gist = await req.json();\n  return {\n    data: getGistContent(gist),\n    rawData: gist,\n  };\n}\n\nexport function getUserData(data) {\n  return (data && data.owner)\n      ? {\n          name: data.owner.login,\n          avatarURL: data.owner.avatar_url,\n      }\n      : undefined;\n}\n\nfunction createGistData(data, secret, gist_id) {\n  let files = data.files.reduce((files, file) => {\n    files[file.name] = {\n      content: file.content.trim() ? file.content : `${emptyValue}${file.content}`,\n    };\n    return files;\n  }, {});\n  const saveData = {\n    ...data,\n  };\n  const jsGistData = {}\n  files['jsGist.json'] = jsGistData;\n  const noDuplicateNames = Object.keys(files).length === data.files.length + 1;\n  if (noDuplicateNames) {\n    delete saveData.files;\n    saveData.filenames = data.files.map(({name}) => name);\n  } else {\n    // save the files in the json\n    files = {\n      'jsGist.json': jsGistData,\n    };\n  }\n  jsGistData.content = JSON.stringify(saveData);\n  if (gist_id) {\n    // TODO: rather than check if there's a readme\n    // insert the readme in our wrapped readme.\n    // Maybe add a \"notes\" field to the save dialog\n    const lowerCaseFiles = Object.keys(files).map(n => n.toLowerCase());\n    const hadReadme = \n        lowerCaseFiles.includes('readme.md') ||\n        lowerCaseFiles.includes('readme.txt') ||\n        lowerCaseFiles.includes('readme');\n    if (!hadReadme) {\n      const content = `## ${data.name}\\n\\n[view on jsgist](${window.location.origin}?src=${gist_id})`\n      files['README.md'] = {content};\n    }\n    // if we have a gist_id this is an update\n    // updates need filenames (which allows renaming)\n    for (const [filename, file] of Object.entries(files)) {\n      file.filename = filename;\n    }\n  }\n  return {\n    files,\n    description: data.name,\n    ...(!gist_id && {public: !secret}),\n    ...(gist_id && {gist_id}),\n  };\n}\n\nexport default class GitHub extends EventTarget {\n  constructor() {\n    super();\n    this.pat = '';\n    this.user = {};\n    this.unAuthorizedOctokit = new Octokit({\n      userAgent,\n    });\n  }\n  get octokit() {\n    return this.authorizedOctokit || this.unAuthorizedOctokit;\n  }\n  // TODO: this does not belong here!\n  _updateUserData(data) {\n    const userData = getUserData(data);\n    if (userData) {\n      Object.assign(this.user, userData);\n      const event = new Event('userdata');\n      event.data = {...this.user};\n      this.dispatchEvent(event);\n    }\n  }\n  setPat(pat) {\n    if (pat !== this.pat) {\n      this.pat = pat;\n      if (pat) {\n        this.authorizedOctokit = new Octokit({\n          auth: pat,\n          userAgent,\n        });\n      } else {\n        this.authorizedOctokit = undefined;\n      }\n    }\n  }\n  /*\n  \"{\n    \"login\": \"greggman\",\n    \"id\": 234804,\n    \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n    \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n    \"gravatar_id\": \"\",\n    \"url\": \"https://api.github.com/users/greggman\",\n    \"html_url\": \"https://github.com/greggman\",\n    \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n    \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n    \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n    \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n    \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n    \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n    \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n    \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n    \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n    \"type\": \"User\",\n    \"site_admin\": false,\n    \"name\": \"Greggman\",\n    \"company\": null,\n    \"blog\": \"http://games.greggman.com\",\n    \"location\": \"Earth\",\n    \"email\": \"github@greggman.com\",\n    \"hireable\": null,\n    \"bio\": \"30 years of games\\r\\n5 years of Chrome\",\n    \"twitter_username\": null,\n    \"public_repos\": 283,\n    \"public_gists\": 79,\n    \"followers\": 1037,\n    \"following\": 3,\n    \"created_at\": \"2010-04-01T08:48:05Z\",\n    \"updated_at\": \"2020-10-24T06:05:24Z\"\n  }\"\n  */\n  async getAuthenticatedUser() {\n    const response = await this.authorizedOctokit.users.getAuthenticated();\n    if (response.status !== 200) {\n      throw new Error(response.message);\n    }\n    return response.data;\n  }\n\n  async getUserGists(since) {\n    const gists = await this.authorizedOctokit.paginate(\n        this.authorizedOctokit.gists.list,\n        {\n          per_page: 100,\n          ...(since && {since}),\n        });\n    return gists.filter(gist => !!gist.files['jsGist.json']);\n    // return await this.authorizedOctokit.gists.list();\n  }\n\n  async getGist(gist_id) {\n    // I'm not sure where this should happen. The issue is if the user's\n    // token has expired, then loading a gist fails, even if it's public.\n    const octokit = this.authorizedOctokit || this.octokit;\n    const gist = await octokit.gists.get({gist_id});\n    return {\n      data: getGistContent(gist.data),\n      rawData: gist.data,\n    };\n  }\n\n  async createGist(data, secret = false) {\n    // TODO: Since we're doing the double save (create gist to get an id\n    // so we can make the README.me) we should probably not send any data\n    // the first time.\n    const gistData = createGistData(data, secret);\n    const gist = await this.authorizedOctokit.gists.create(gistData);\n    this._updateUserData(gist.data);\n    return await this.updateGist(gist.data.id, data);\n  }\n  async updateGist(gist_id, data) {\n    const gistData = createGistData(data, false, gist_id);\n    const gist = await this.authorizedOctokit.gists.update(gistData);\n    return {\n      id: gist.data.id,\n      name: gist.data.description,\n      date: gist.data.updated_at,\n      public: gist.data.public,\n    };\n  }\n  async forkGist(gist_id) {\n    const gist = await this.authorizedOctokit.gists.fork({gist_id});\n    return {\n      id: gist.data.id\n    };\n  }\n  async deleteGist(gist_id) {\n    const result = await this.authorizedOctokit.gists.delete({gist_id});\n    return result;\n  }\n  async createGistComment(gist_id, body) {\n    const result = await this.authorizedOctokit.gists.createComment({\n      gist_id,\n      body,\n    });\n    if (result.status < 200 || result.status >= 300) {\n      throw new Error(result.message);\n    }\n    return result.data;\n  }\n}\n\n","import React from 'react';\n\nexport default function Head() {\n  return (\n    <div className=\"head\">\n      <div>\n        <a target=\"_blank\" rel=\"noopener noreferrer\" href={window.location.origin}>\n        <img src=\"/resources/images/logo-small.svg\" alt=\"logo\"/>\n      {window.location.hostname}</a>\n      </div>\n      <div className=\"fix-help-contribute\">\n        <div className=\"octocat\">\n          <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/greggman/jsgist/\">\n            <img alt=\"github\" src=\"/resources/images/octocat-icon.svg\"/>\n          </a>\n        </div>\n      </div>\n    </div>\n  );\n}","import React from 'react';\n\nexport default class Dialog extends React.Component {\n  componentDidMount() {\n    window.addEventListener('keydown', this.handleKeyDown);\n  }\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  }\n  handleKeyDown = (e) => {\n    if (e.keyCode === 27) {\n      this.props.onClose();\n    }\n  }\n  render() {\n    const {title, children, onClose, className = ''} = this.props;\n    return (\n      <div onClick={onClose} className={`${className} dialog`}>\n        <div\n          tabIndex=\"-1\"\n          onClick={(e) =>{e.stopPropagation()}}\n        >\n          <div className=\"dialog-heading\">\n            <div className=\"dialog-title\">{title}</div>\n            <div className=\"dialog-close\">\n              <button onClick={onClose}>X</button>\n            </div>\n          </div>\n          <div className=\"dialog-content\">\n            {children}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport Dialog from './Dialog.js';\n\nexport default function Help(props) {\n  const {onClose} = props;\n  return (\n    <Dialog title=\"jsGist\" onClose={onClose}>\n      <div className=\"markdown\">\n      <p>A gist based JavaScript/HTML/CSS Playground</p>\n      <h2>Contribute, Fix, Enhance!</h2>\n      <p>\n        <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/greggman/jsgist\">https://github.com/greggman/jsgist</a>\n      </p>\n      <p>Also see <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://jsbenchit.org\">jsbenchit.org</a></p>\n      <h2>Saving</h2>\n      <p>You can save your tests in multiple ways.</p>\n      <ol>\n        <li>Save to a github gist by logging in</li>\n        <li>Save it manually into github\n          <p>\n           Copy the JSON. Go to github. Create a new gist. Name the file\n           <code>jsGist.json</code> Paste the JSON in. Pick \"Create public gist\".\n          </p>\n          <p>\n           Note the id in the URL after you create the gist.\n          </p>\n          <p>\n           Create a url in the form <code>https://jsgist.org/?src=&lt;gist_id&gt;--</code>.\n          </p>\n          <p>\n           Example: <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://jsgist.org/?src=f793cb359f2571409983351a6099d5d1\">https://jsgist.org/?src=f793cb359f2571409983351a6099d5d1</a>\n          </p>\n        </li>\n        <li>Save it manually somewhere else.\n          <p>\n           If there's some other service that will provide a string via\n           http get then copy and save the JSON there then create a URL\n           in the form of <code>https://jsgist.org/?src=&lt;url&gt;</code>. Note: you\n           may have to escape the URL.\n          </p>\n        </li>\n        <li>Save it as a bookmark or link\n          <p>\n           In the SaveAs dialog there's a link that contains all the data\n           for your benchmark.\n          </p>\n        </li>\n      </ol>\n      </div>\n    </Dialog>\n  );\n}","const camelCaseRE = /([a-z])([A-Z])/g;\nconst toDash = (_, left, right) => `${left}-${right}`;\nconst camelCaseToDash = s => s.replace(camelCaseRE, toDash).toLowerCase();\n\nexport function classNames(...args) {\n  const names = [];\n  for (const arg of args) {\n    if (typeof arg === 'string') {\n      names.push(arg);\n    } else {\n      for (const [key, value] of Object.entries(arg)) {\n        if (value) {\n          names.push(camelCaseToDash(key));\n        }\n      }\n    }\n  }\n  return names.join(' ');\n}","import React from 'react';\n\nconst ServiceContext = React.createContext();\nexport default ServiceContext;\n","import React from 'react';\n\nimport {classNames} from '../libs/css-utils';\nimport ServiceContext from '../ServiceContext.js';\n\nfunction basename(url) {\n  const ndx = url.lastIndexOf('/');\n  return ndx >= 0 ? url.substr(ndx + 1) : url;\n}\n\nfunction isMsgSame(oldMsg, newMsg) {\n  if (!!oldMsg !== !!newMsg) {\n    return false;\n  }\n  const keys = Object.keys(oldMsg).filter(key => key !== 'count');\n  if (keys.length !== Object.keys(newMsg).length) {\n    return false;\n  }\n  for (const key of keys) {\n    if (oldMsg[key] !== newMsg[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport class LogManager extends EventTarget {\n  constructor() {\n    super();\n    this._msgs = [];\n  }\n  _notify() {\n    this.dispatchEvent(new Event('change'));\n  }\n  clear = () => {\n    this._msgs = [];\n    this._notify();\n  }\n  _addMsg = (data) => {\n    const lastData = this._msgs[this._msgs.length - 1];\n    if (isMsgSame(lastData, data)) {\n      lastData.count = (lastData.count || 0) + 1;\n    } else {\n      this._msgs.push(data);\n    }\n  }\n  addMsg = (data) => {\n    this._addMsg(data);\n    this._notify();\n  }\n  addMsgs = (msgs) => {\n    for (const {type, data} of msgs) {\n      switch (type) {\n        case 'jsError':\n          this._addMsg({...data, type: 'error', showStack: true});\n          break;\n        case 'jsUnhandledRejection':\n          this._addMsg({...data, type: 'error', showStack: true});\n          break;\n        default:\n          this._addMsg(data);\n          break;\n      }\n    }\n    this._notify();\n  }\n  getMsgs() {\n    return this._msgs\n  }\n}\n\nexport default class Log extends React.Component {\n  constructor(props) {\n    super(props);\n    this.logMessagesRef = React.createRef();\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  componentDidMount() {\n    const {logManager} = this.context;\n    logManager.addEventListener('change', this.handleChange);\n  }\n  componentWillUnmount() {\n    const {logManager} = this.context;\n    logManager.removeEventListener('change', this.handleChange);\n  }\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (snapshot !== null) {\n      // if we were at the bottom of the log then\n      // stay at the bottom of the log\n      if (snapshot < 1) {\n        const elem = this.logMessagesRef.current;\n        elem.scrollTop = elem.scrollHeight - elem.parentElement.clientHeight;\n      }\n    }\n  }\n  getSnapshotBeforeUpdate(prevProps, prevState) {\n    const elem = this.logMessagesRef.current;\n    return elem.scrollHeight - (elem.scrollTop + elem.parentElement.clientHeight);\n  }\n  render() {\n    const {onGoToLine} = this.props;\n    const {logManager} = this.context;\n    return (\n      <div className=\"logger\">\n        <div className=\"log-messages layout-scrollbar\" ref={this.logMessagesRef}>\n          { logManager.getMsgs().map((msg, ndx) => {\n              const tooltip = !msg.section;\n              return (\n                <div className={classNames('log-line',{[msg.type]: true})} key={`l${ndx}`}>\n                  <div className={msg.count ? \"count\" : \"no-count\"}>{msg.count ? msg.count : ''}</div>\n                  <div className=\"msg\">\n                    {msg.msg}\n                    <span>&nbsp;</span> {/* this is to prevent auto-selection to the next element when double clicking */}\n                    <div\n                      className={classNames('file', {tooltip, fileLink: msg.section})}\n                      onClick={() => onGoToLine(msg)}\n                      data-tooltip={`${msg.section || msg.url}:${msg.lineNo}`}\n                    >\n                      {msg.section || basename(msg.url || '')}:{msg.lineNo}\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n        </div>\n      </div>\n    );\n  }\n}\n\nLog.contextType = ServiceContext;","export function createURL(base, params) {\n  const url = new URL(base);\n  const searchParams = new URLSearchParams(url.search);\n  for (const [key, value] of Object.entries(params)) {\n    if (value === undefined) {\n      searchParams.delete(key);\n    } else {\n      searchParams.set(key, value);\n    }\n  }\n  url.search = searchParams.toString();\n  return url.href;\n}\n\nexport function updateURL(params) {\n  const url = createURL(window.location.href, params);\n  window.history.replaceState({}, '', url.href);\n}\n\n","type Handler = (data: any) => void;\ntype StringToHandlers = Map<string, Handler[]>;\nconst nullHandlers : StringToHandlers = new Map();\nconst fromToHandlersMap : Map<Window | null, StringToHandlers> = new Map([[null, nullHandlers]]);\n\nexport function on(type: string, from: Window | null, fn: (data: any) => void) {\n  remove(type, from, fn);\n  let handlers = fromToHandlersMap.get(from);\n  if (!handlers) {\n    handlers = new Map();\n    fromToHandlersMap.set(from, handlers)\n  }\n  let fns = handlers.get(type);\n  if (!fns) {\n    fns = [];\n    handlers.set(type, fns);\n  }\n  fns.push(fn);\n}\n\nexport function remove(type: string, from: Window | null, fn: (data: any) => void) {\n  let handlers = fromToHandlersMap.get(from);\n  if (!handlers) {\n    return;\n  }\n  const fns = handlers.get(type);\n  if (fns) {\n    const ndx = fns.indexOf(fn);\n    if (ndx >= 0) {\n      fns.splice(ndx, 1);\n    }\n    if (fns.length === 0) {\n      handlers.delete(type);\n      if (handlers.size === 0 && from) {\n        fromToHandlersMap.delete(from);\n      }\n    }\n  }\n}\n\nfunction callHandler(handlers: StringToHandlers, type: string, data: any) {\n  const fns = handlers.get(type);\n  if (fns) {\n    for (const fn of fns) {\n      fn(data);\n    }\n    return true;\n  }\n  return false;\n}\n\nwindow.addEventListener('message', (e: MessageEvent) => {\n  const {type, data} = e.data;\n  const handlers = fromToHandlersMap.get(e.source as Window);\n  if (handlers) {\n    if (callHandler(handlers, type, data)) {\n      return;\n    }\n  }\n  callHandler(nullHandlers, type, data);\n});\n\n","import React from 'react';\n\nimport {isDevelopment} from '../libs/flags.js';\nimport ServiceContext from '../ServiceContext.js';\nimport {createURL} from '../libs/url.js';\nimport * as winMsgMgr from '../libs/WindowMessageManager';\n\nexport default class Runner extends React.Component {\n  constructor(props) {\n    super(props);\n    this.runnerRef = React.createRef();\n  }\n  handleJSLog = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsg(data);\n  }\n  handleJSError = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsg({...data, type: 'error', showStack: true});\n  }\n  handleJSUnhandledRejection = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsg({...data, type: 'error', showStack: true});\n  }\n  handleInfoMessages = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsgs(data);\n  }\n  handleGimmeDaCodez = () => {\n    this.iframe.contentWindow.postMessage({\n      type: 'run',\n      data: this.data,\n    }, \"*\");\n  }\n  componentDidMount() {\n    const {registerAPI} = this.props;\n\n    const {debug} = Object.fromEntries(new URLSearchParams(window.location.search).entries());\n    const extra = {\n      ...(debug && {debug}),\n    };\n\n    registerAPI({\n      run: (data, blank) => {\n        this.data = data;\n        this.removeIFrame();\n        const iframe = document.createElement('iframe');\n        this.iframe = iframe;\n        iframe.src = isDevelopment\n            ? createURL(`http://${window.location.hostname}:8081/runner-03.html`, {url: `http://${window.location.hostname}:8080/jsgist-runner.js`, ...extra})\n            : createURL('https://jsgistrunner.devcomments.org/runner-03.html', {url: 'https://jsgist.org/jsgist-runner.js', ...extra});\n        if (blank) {\n          iframe.style.background = 'none';\n        }\n        this.runnerRef.current.appendChild(iframe);\n      },\n    })\n    winMsgMgr.on('gimmeDaCodez', null, this.handleGimmeDaCodez);\n    winMsgMgr.on('jsLog', null, this.handleJSLog);\n    winMsgMgr.on('jsError', null, this.handleJSError);\n    winMsgMgr.on('jsUnhandledRejection', null, this.handleJSUnhandledRejection);\n    winMsgMgr.on('infoMessages', null, this.handleInfoMessages);\n  }\n  removeIFrame() {\n    if (this.iframe) {\n      this.iframe.remove();\n      this.iframe.src = 'about:blank';\n      this.iframe = undefined;\n    }\n  }\n  componentWillUnmount() {\n    this.removeIFrame();\n    winMsgMgr.remove('gimmeDaCodez', null, this.handleGimmeDaCodez);\n    winMsgMgr.remove('jsLog', null, this.handleJSLog);\n    winMsgMgr.remove('jsError', null, this.handleJSError);\n    winMsgMgr.remove('jsUnhandledRejection', null, this.handleJSUnhandledRejection);\n    winMsgMgr.remove('infoMessages', null, this.handleInfoMessages);\n  }\n  handleMessage = (e) => {\n    const {type, data} =  e.data;\n    const fn = this.handlers[type];\n    if (fn) {\n      fn(data);\n    }\n  }\n  render() {\n    return (\n      <div className=\"runner\" ref={this.runnerRef}></div>\n    )\n  }\n}\n\nRunner.contextType = ServiceContext;","import Ajv from 'ajv';\n\nimport {isDevelopment} from './flags.js';\nimport schema from './schema.json';\n\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst validator = ajv.compile(schema);\n\nconst trackedValues = {};\n\nfunction getValueOrMakeNew(name) {\n  const trackedValue = trackedValues[name] || {\n    subscriptions: new Set(),\n  };\n  trackedValues[name] = trackedValue;\n  return trackedValue;\n}\n\nexport function add(name, initialValue) {\n  const trackedValue = getValueOrMakeNew(name);\n  if (initialValue !== undefined) {\n    trackedValue.value = initialValue;\n  }\n  return trackedValue;\n}\n\nexport function get(name) {\n  return trackedValues[name].value;\n}\n\nexport function set(name, newValue) {\n  const trackedValue = trackedValues[name];\n  if (!trackedValue) {\n    throw new Error(`no such track value: ${name}`);\n  }\n  trackedValue.value = newValue;\n  const fns = [...trackedValue.subscriptions.keys()];\n  for (const fn of fns) {\n    fn(newValue, name);\n  }\n}\n\nexport function subscribe(name, fn) {\n  const trackedValue = getValueOrMakeNew(name);\n  trackedValue.subscriptions.add(fn);\n}\n\nexport function unsubscribe(name, fn) {\n  const trackedValue = getValueOrMakeNew(name);\n  trackedValue.subscriptions.delete(fn);\n}\n\nconst newTestData = {\n  \"name\": \"My jsGist\",\n  \"settings\": {},\n  \"files\": [\n    {\n      name: \"index.html\",\n      content: \"\",\n    },\n    {\n      name: \"index.css\",\n      content: \"\",\n    },\n    {\n      name: \"index.js\",\n      content: \"\",\n    },\n  ],\n};\nexport function getNewData() {\n  return JSON.parse(JSON.stringify(newTestData));\n}\nexport function getBlankData() {\n  const url = `${window.location.origin}/resources/images/logo.svg`;\n  return JSON.parse(JSON.stringify({\n    \"name\": \"jsGist\",\n    \"settings\": {},\n    \"files\": [\n      {\n        \"name\": \"index.html\",\n        \"content\": ``,\n      },\n      {\n        \"name\": \"index.css\",\n        \"content\": `\n          html, body {\n            margin: 0;\n            width: 100%;\n            height: 100%;\n            background-image: url(${url});\n            background-size: contain contain;\n            background-position: center center;\n            background-repeat: no-repeat no-repeat;\n          }\n          @media (prefers-color-scheme: dark) {\n            html {\n              background: #222;\n            }\n          }\n        `,\n      },\n      {\n        \"name\": \"index.js\",\n        \"content\": \"\",\n      }\n    ]\n  }));\n}\n\nlet data;\nexport function getData() {\n  return data;\n}\n\nexport const dataVersionKey = 'dataVersion';\nexport const updateVersionKey = 'updateVersion';\nexport const filesVersionKey = 'filesVersion';\n\nadd(dataVersionKey, 0);   // any data changes (when an item in the data is change)\nadd(updateVersionKey, 0);  // all data changes (when the entire data objects replaced with new data)\nadd(filesVersionKey, 0);  // files added or removed or the main name is changed\n\nconst incVersion = key => set(key, get(key) + 1);\nconst incDataVersion = _ => incVersion(dataVersionKey);\nconst incFilesVersion = _ => incVersion(filesVersionKey);\nconst incUpdateVersion = _ => {\n  incVersion(updateVersionKey);\n  incDataVersion();\n  incFilesVersion();\n};\n\nfunction getUniqueName(basename) {\n  const filenames = new Set(data.files.map(f => f.name));\n  for (let count = data.files.length + 1; ; ++count) {\n    const name = `${basename}${count}`;\n    if (!filenames.has(name)) {\n      return name;\n    }\n  }\n}\n\nexport function addFile(name = \"\", content = \"\") {\n  name = name || getUniqueName('unnamed');\n  data.files.push({\n    name,\n    content,\n  });\n  incDataVersion();\n  incFilesVersion();\n}\n\nexport function setName(name) {\n  data.name = name;\n  incDataVersion();\n  incFilesVersion();\n}\n\nexport function setFileName(ndx, newName) {\n  data.files[ndx].name = newName;\n  incDataVersion();\n}\n\nexport function setFileContent(ndx, content) {\n  data.files[ndx].content = content;\n  incDataVersion();\n}\n\nexport function setFileType(ndx, type) {\n  data.files[ndx].type = type;\n  incDataVersion();\n}\n\nexport function deleteFile(ndx) {\n  data.files.splice(ndx, 1);\n  incDataVersion();\n  incFilesVersion();\n}\n\nexport function validate(data) {\n  if (!validator(data)) {\n    throw new Error(`data not valid:\\n${validator.errors.map(e => `${e.message}: ${e.dataPath}`)}`);\n  }\n}\n\nexport function setData(newData) {\n  validate(newData);\n  data = newData;\n  if (isDevelopment) {\n    window.d = data;\n  }\n  incUpdateVersion();\n}\n\nsetData(isDevelopment ? {\n  \"name\": \"ThreeJSFundamentals Scenegraph Tank\",\n  \"settings\": {},\n  \"files\": [\n    {\n      \"name\": \"index.html\",\n      \"content\": \"<canvas id=\\\"c\\\"></canvas>\\n<div id=\\\"info\\\"></div>\",\n    },\n    {\n      \"name\": \"index.css\",\n      \"content\": \"body {\\n  margin: 0;\\n}\\n#c {\\n  width: 100vw;\\n  height: 100vh;\\n  display: block;\\n}\\n#info { \\n  position: absolute; \\n  left: 1em; \\n  top: 1em; \\n  background: rgba(0,0,0,.8); \\n  padding: .5em;\\n  color: white;\\n  font-family: monospace;\\n}\",\n    },\n    {\n      \"name\": \"index.js\",\n      \"content\": \"import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/build/three.module.js';\\n\\nfunction main() {\\n  const canvas = document.querySelector('#c');\\n  const renderer = new THREE.WebGLRenderer({canvas: canvas});\\n  renderer.setClearColor(0xAAAAAA);\\n  renderer.shadowMap.enabled = true;\\n\\n  function makeCamera(fov = 40) {\\n    const aspect = 2;  // the canvas default\\n    const zNear = 0.1;\\n    const zFar = 1000;\\n    return new THREE.PerspectiveCamera(fov, aspect, zNear, zFar);\\n  }\\n  const camera = makeCamera();\\n  camera.position.set(8, 4, 10).multiplyScalar(3);\\n  camera.lookAt(0, 0, 0);\\n\\n  const scene = new THREE.Scene();\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(0, 20, 0);\\n    scene.add(light);\\n    light.castShadow = true;\\n    light.shadow.mapSize.width = 2048;\\n    light.shadow.mapSize.height = 2048;\\n\\n    const d = 50;\\n    light.shadow.camera.left = -d;\\n    light.shadow.camera.right = d;\\n    light.shadow.camera.top = d;\\n    light.shadow.camera.bottom = -d;\\n    light.shadow.camera.near = 1;\\n    light.shadow.camera.far = 50;\\n    light.shadow.bias = 0.001;\\n  }\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(1, 2, 4);\\n    scene.add(light);\\n  }\\n\\n  const groundGeometry = new THREE.PlaneBufferGeometry(50, 50);\\n  const groundMaterial = new THREE.MeshPhongMaterial({color: 0xCC8866});\\n  const groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);\\n  groundMesh.rotation.x = Math.PI * -.5;\\n  groundMesh.receiveShadow = true;\\n  scene.add(groundMesh);\\n\\n  const carWidth = 4;\\n  const carHeight = 1;\\n  const carLength = 8;\\n\\n  const tank = new THREE.Object3D();\\n  scene.add(tank);\\n\\n  const bodyGeometry = new THREE.BoxBufferGeometry(carWidth, carHeight, carLength);\\n  const bodyMaterial = new THREE.MeshPhongMaterial({color: 0x6688AA});\\n  const bodyMesh = new THREE.Mesh(bodyGeometry, bodyMaterial);\\n  bodyMesh.position.y = 1.4;\\n  bodyMesh.castShadow = true;\\n  tank.add(bodyMesh);\\n\\n  const tankCameraFov = 75;\\n  const tankCamera = makeCamera(tankCameraFov);\\n  tankCamera.position.y = 3;\\n  tankCamera.position.z = -6;\\n  tankCamera.rotation.y = Math.PI;\\n  bodyMesh.add(tankCamera);\\n\\n  const wheelRadius = 1;\\n  const wheelThickness = .5;\\n  const wheelSegments = 6;\\n  const wheelGeometry = new THREE.CylinderBufferGeometry(\\n      wheelRadius,     // top radius\\n      wheelRadius,     // bottom radius\\n      wheelThickness,  // height of cylinder\\n      wheelSegments);\\n  const wheelMaterial = new THREE.MeshPhongMaterial({color: 0x888888});\\n  const wheelPositions = [\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, 0],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, 0],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n  ];\\n  const wheelMeshes = wheelPositions.map((position) => {\\n    const mesh = new THREE.Mesh(wheelGeometry, wheelMaterial);\\n    mesh.position.set(...position);\\n    mesh.rotation.z = Math.PI * .5;\\n    mesh.castShadow = true;\\n    bodyMesh.add(mesh);\\n    return mesh;\\n  });\\n\\n  const domeRadius = 2;\\n  const domeWidthSubdivisions = 12;\\n  const domeHeightSubdivisions = 12;\\n  const domePhiStart = 0;\\n  const domePhiEnd = Math.PI * 2;\\n  const domeThetaStart = 0;\\n  const domeThetaEnd = Math.PI * .5;\\n  const domeGeometry = new THREE.SphereBufferGeometry(\\n    domeRadius, domeWidthSubdivisions, domeHeightSubdivisions,\\n    domePhiStart, domePhiEnd, domeThetaStart, domeThetaEnd);\\n  const domeMesh = new THREE.Mesh(domeGeometry, bodyMaterial);\\n  domeMesh.castShadow = true;\\n  bodyMesh.add(domeMesh);\\n  domeMesh.position.y = .5;\\n\\n  const turretWidth = .1;\\n  const turretHeight = .1;\\n  const turretLength = carLength * .75 * .2;\\n  const turretGeometry = new THREE.BoxBufferGeometry(\\n      turretWidth, turretHeight, turretLength);\\n  const turretMesh = new THREE.Mesh(turretGeometry, bodyMaterial);\\n  const turretPivot = new THREE.Object3D();\\n  turretMesh.castShadow = true;\\n  turretPivot.scale.set(5, 5, 5);\\n  turretPivot.position.y = .5;\\n  turretMesh.position.z = turretLength * .5;\\n  turretPivot.add(turretMesh);\\n  bodyMesh.add(turretPivot);\\n\\n  const turretCamera = makeCamera();\\n  turretCamera.position.y = .75 * .2;\\n  turretMesh.add(turretCamera);\\n\\n  const targetGeometry = new THREE.SphereBufferGeometry(.5, 6, 3);\\n  const targetMaterial = new THREE.MeshPhongMaterial({color: 0x00FF00, flatShading: true});\\n  const targetMesh = new THREE.Mesh(targetGeometry, targetMaterial);\\n  const targetOrbit = new THREE.Object3D();\\n  const targetElevation = new THREE.Object3D();\\n  const targetBob = new THREE.Object3D();\\n  targetMesh.castShadow = true;\\n  scene.add(targetOrbit);\\n  targetOrbit.add(targetElevation);\\n  targetElevation.position.z = carLength * 2;\\n  targetElevation.position.y = 8;\\n  targetElevation.add(targetBob);\\n  targetBob.add(targetMesh);\\n\\n  const targetCamera = makeCamera();\\n  const targetCameraPivot = new THREE.Object3D();\\n  targetCamera.position.y = 1;\\n  targetCamera.position.z = -2;\\n  targetCamera.rotation.y = Math.PI;\\n  targetBob.add(targetCameraPivot);\\n  targetCameraPivot.add(targetCamera);\\n\\n  // Create a sine-like wave\\n  const curve = new THREE.SplineCurve( [\\n    new THREE.Vector2( -10, 0 ),\\n    new THREE.Vector2( -5, 5 ),\\n    new THREE.Vector2( 0, 0 ),\\n    new THREE.Vector2( 5, -5 ),\\n    new THREE.Vector2( 10, 0 ),\\n    new THREE.Vector2( 5, 10 ),\\n    new THREE.Vector2( -5, 10 ),\\n    new THREE.Vector2( -10, -10 ),\\n    new THREE.Vector2( -15, -8 ),\\n    new THREE.Vector2( -10, 0 ),\\n  ] );\\n\\n  const points = curve.getPoints( 50 );\\n  const geometry = new THREE.BufferGeometry().setFromPoints( points );\\n  const material = new THREE.LineBasicMaterial( { color : 0xff0000 } );\\n  const splineObject = new THREE.Line( geometry, material );\\n  splineObject.rotation.x = Math.PI * .5;\\n  splineObject.position.y = 0.05;\\n  scene.add(splineObject);\\n\\n  function resizeRendererToDisplaySize(renderer) {\\n    const canvas = renderer.domElement;\\n    const width = canvas.clientWidth;\\n    const height = canvas.clientHeight;\\n    const needResize = canvas.width !== width || canvas.height !== height;\\n    if (needResize) {\\n      renderer.setSize(width, height, false);\\n    }\\n    return needResize;\\n  }\\n\\n  const targetPosition = new THREE.Vector3();\\n  const tankPosition = new THREE.Vector2();\\n  const tankTarget = new THREE.Vector2();\\n\\n  const cameras = [\\n    { cam: camera, desc: 'detached camera', },\\n    { cam: turretCamera, desc: 'on turret looking at target', },\\n    { cam: targetCamera, desc: 'near target looking at tank', },\\n    { cam: tankCamera, desc: 'above back of tank', },\\n  ];\\n\\n  const infoElem = document.querySelector('#info');\\n\\n  function render(time) {\\n    time *= 0.001;\\n\\n    if (resizeRendererToDisplaySize(renderer)) {\\n      const canvas = renderer.domElement;\\n      cameras.forEach((cameraInfo) => {\\n        const camera = cameraInfo.cam;\\n        camera.aspect = canvas.clientWidth / canvas.clientHeight;\\n        camera.updateProjectionMatrix();\\n      });\\n    }\\n\\n    // move target\\n    targetOrbit.rotation.y = time * .27;\\n    targetBob.position.y = Math.sin(time * 2) * 4;\\n    targetMesh.rotation.x = time * 7;\\n    targetMesh.rotation.y = time * 13;\\n    targetMaterial.emissive.setHSL(time * 10 % 1, 1, .25);\\n    targetMaterial.color.setHSL(time * 10 % 1, 1, .25);\\n\\n    // move tank\\n    const tankTime = time * .05;\\n    curve.getPointAt(tankTime % 1, tankPosition);\\n    curve.getPointAt((tankTime + 0.01) % 1, tankTarget);\\n    tank.position.set(tankPosition.x, 0, tankPosition.y);\\n    tank.lookAt(tankTarget.x, 0, tankTarget.y);\\n\\n    // face turret at target\\n    targetMesh.getWorldPosition(targetPosition);\\n    turretPivot.lookAt(targetPosition);\\n\\n    // make the turretCamera look at target\\n    turretCamera.lookAt(targetPosition);\\n\\n    // make the targetCameraPivot look at the at the tank\\n    tank.getWorldPosition(targetPosition);\\n    targetCameraPivot.lookAt(targetPosition);\\n\\n    wheelMeshes.forEach((obj) => {\\n      obj.rotation.x = time * 3;\\n    });\\n\\n    const camera = cameras[time * .25 % cameras.length | 0];\\n    infoElem.textContent = camera.desc;\\n\\n    renderer.render(scene, camera.cam);\\n\\n    requestAnimationFrame(render);\\n  }\\n\\n  requestAnimationFrame(render);\\n}\\n\\nmain();\\n\",\n    }\n  ]\n} : getNewData());\n","const query = Object.fromEntries(new URLSearchParams(window.location.search).entries());\nexport default query;","import {storageManager} from '../globals.js';\nimport * as model from './model.js';\nimport query from '../libs/start-query.js';\n\nconst settingsKey = 'ui-settings';\n\n// This sucks but Monaco doesn't work on mobile\nconst canMonaco = !query.codeMirror && !(/webOS|iPhone|iPad|Android/.test(navigator.userAgent));\n\nlet initialized = false;\nlet settings;\n\nconst defaultSettings = {\n  layout: (window.screen.width < 540 || window.screen.height < 540) ? 3 : 0,\n  editor: canMonaco ? 'monaco' : 'codemirror',\n  lineNumbers: true,\n  tabs: false,\n  showWhitespace: false,\n}\n\nfunction init() {\n  if (initialized) {\n    return;\n  }\n  initialized = true;\n  try {\n    settings = JSON.parse(storageManager.get(settingsKey, true));\n    if (!settings) {\n      throw new Error('no settings');\n    }\n  } catch (e) {\n    settings = {...defaultSettings};\n  }\n  for (const [key, value] of Object.entries(defaultSettings)) {\n    if (typeof value !== typeof settings[key]) {\n      settings[key] = value;\n    }\n  }\n}\n\nmodel.add('settings', settings);\n\nexport function set(name, value) {\n  settings[name] = value;\n  const json = JSON.stringify(settings);\n  storageManager.set(settingsKey, json, true);\n  model.set('settings', settings);\n}\n\nexport function get() {\n  init();\n  return settings;\n}\n\nexport function subscribe(fn) {\n  model.subscribe('settings', fn);\n}\n\nexport function unsubscribe(fn) {\n  model.unsubscribe('settings', fn);\n}\n","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\nimport Log from './Log.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layout1';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"vSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"vSizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Layout extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      vSizes: [0.95, 0.05],\n    };\n  }\n  onSetVSizes = (sizes) => {\n    this.setState({vSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  render() {\n    const {registerRunnerAPI} = this.props;\n    const {vSizes} = this.state;\n    return (\n      <Split direction=\"vertical\" minSize={0} sizes={vSizes} onSetSizes={this.onSetVSizes}>\n        <Runner registerAPI={registerRunnerAPI} />\n        <Log onGoToLine={this.handleGoToLine} />\n      </Split>\n    );\n  };\n}","import React from 'react';\nimport {Controlled as CodeMirror} from 'react-codemirror2';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/theme/eclipse.css';\nimport 'codemirror/mode/css/css.js';\nimport 'codemirror/mode/gfm/gfm.js';\nimport 'codemirror/mode/htmlmixed/htmlmixed.js';\nimport 'codemirror/mode/javascript/javascript.js';\nimport 'codemirror/addon/scroll/simplescrollbars.js';\nimport 'codemirror/addon/scroll/simplescrollbars.css';\nimport 'codemirror/addon/search/search.js';\nimport 'codemirror/addon/search/searchcursor.js';\nimport 'codemirror/addon/search/jump-to-line.js';\nimport 'codemirror/addon/dialog/dialog.js';\nimport 'codemirror/addon/dialog/dialog.css';\nimport 'codemirror/addon/edit/matchbrackets.js';\nimport 'codemirror/addon/edit/matchtags.js';\nimport 'codemirror/addon/fold/xml-fold.js';\n\nconst darkMatcher = window.matchMedia\n    ? window.matchMedia('(prefers-color-scheme: dark)')\n    : {};\n// darkMatcher.addListener(render);\n\nconst noop = () => {};\n\nexport default class CodeCodeMirror extends React.Component {\n  constructor(props) {\n    super(props);\n    const {value, hackKey} = props;\n    this.state = {value, hackKey}\n  }\n  static getDerivedStateFromProps(props, state) {\n    const needNewData = state.hackKey !== props.hackKey;\n    return (needNewData)\n       ? {hackKey: props.hackKey, value: props.value}\n       : null;\n  }\n  componentDidMount() {\n    const {registerAPI} = this.props;\n    if (registerAPI) {\n      registerAPI({\n        goToLine: (lineNo, colNo) => {\n          this.editor.focus();\n          this.editor.doc.setCursor(lineNo - 1, colNo - 1);\n        },\n        refresh: _ => {\n          this.editor.refresh();\n        },\n        focus: _ => {\n          this.editor.focus();\n        },\n      });\n    }\n  }\n  registerEditor = (editor) => {\n    this.editor = editor;\n    editor.setOption(\"extraKeys\", {\n      Tab: (cm) => {\n        const str = this.tabs ? '\\t' : ''.padEnd(cm.getOption(\"indentUnit\") + 1);\n        cm.replaceSelection(str);\n      }\n    });\n  }\n  render() {\n    const {options = {}, onValueChange = noop, ui} = this.props;\n    const {value} =  this.state;\n    const isDarkMode = darkMatcher.matches;\n    this.tabs = ui.tabs;\n    const codeMirrorOptions = {\n      mode: 'javascript',\n      scrollbarStyle: 'overlay',\n      theme: isDarkMode ? 'material' : 'eclipse',\n      matchBrackets: true,\n      lineNumbers: ui.lineNumbers,\n      ...(options.editor && options.editor),\n    };\n    if (codeMirrorOptions.mode.indexOf('html') >= 0) {\n      codeMirrorOptions.matchTags = true;\n    }\n    return (\n      <CodeMirror\n        value={value}\n        options={codeMirrorOptions}\n        onBeforeChange={(editor, data, value) => {\n          this.setState({value});\n        }}\n        onChange={(editor, data, value) => {\n          onValueChange(value);\n        }}\n        editorDidMount={this.registerEditor}\n      />\n    );\n  }\n};\n","export const noop = () => {};\nexport const wait = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\nexport function escapeTextForHTMLContent(s: string) {\n  return s.replace(/&/g, '&amp;')\n          .replace(/</g, '&lt;')\n          .replace(/>/g, '&gt;');\n}\n\nfunction findNdx(files: any, endings: string[]) {\n  // calling toLowerCase a bunch is bad but there will never be more than a few files\n  for (const ending of endings) {\n    const ndx = files.findIndex((file: any) => file.name.toLowerCase().endsWith(ending.toLowerCase()));\n    if (ndx >= 0) {\n      return ndx;\n    }\n  }\n  return -1;\n}\n\nexport function getOrFindNdx(files: any[], name: string, ...endings: string[]) {\n  const ndx = files.findIndex(f => f.name.toLowerCase() === name.toLowerCase);\n  if (ndx >= 0) {\n    return ndx;\n  }\n  return findNdx(files, endings);\n}\n\nexport function getOrFind(files: any[], ...args: string[]) {\n  const ndx = getOrFindNdx(files, '', ...args);\n  return ndx >= 0 ? files[ndx] : '';\n}\n\nconst stringify = (options: any, sep: string = ',') => Object.entries(options).map(([key, value]) => `${key}=${value}`).join(sep);\n\nexport function createPopup(url: string, config: any = {}): (Window | undefined) {\n  const width = config.width || 500;\n  const height = config.height || 500;\n  const options = {\n    width: width,\n    height: height,\n    top: window.screenY + ((window.outerHeight - height) / 2.5),\n    left: window.screenX + ((window.outerWidth - width) / 2)\n  };\n  return window.open(url, '_blank', stringify(options, ',')) || undefined;\n}\n\nexport function once(fn: (...args: any[]) => void) {\n  return function (...args: any[]) {\n    let once = false;\n    if (!once) {\n      once = true;\n      fn(...args);\n    }\n  };\n}","import React from 'react';\nimport Editor from \"@monaco-editor/react\";\nimport { once } from '../libs/utils.ts';\n\nconst darkMatcher = window.matchMedia\n    ? window.matchMedia('(prefers-color-scheme: dark)')\n    : {};\n// darkMatcher.addListener(render);\n\nconst noop = () => {};\n\nasync function getText(url) {\n  const req = await fetch(url);\n  return await req.text();\n}\n\nconst addTypes = once(async function addTypes(monaco) {\n  const basePath = '/types/webgpu/dist/index.d.ts';\n  const text = await getText(basePath);\n  monaco.languages.typescript.javascriptDefaults.addExtraLib(text, '');\n});\n\nfunction codeMirrorModeToLanguage(editor) {\n  const language = (editor?.mode || 'javascript').split('/').pop();\n  return language === 'gfm' ? 'markdown' : language;\n}\n\nexport default class CodeMonaco extends React.Component {\n  constructor(props) {\n    super(props);\n    const {value, hackKey} = props;\n    this.state = {value, hackKey}\n  }\n  static getDerivedStateFromProps(props, state) {\n    const needNewData = state.hackKey !== props.hackKey;\n    return (needNewData)\n       ? {hackKey: props.hackKey, value: props.value}\n       : null;\n  }\n  handleEditorDidMount = (editor, monaco) => {\n    this.editor = editor;\n    addTypes(monaco);\n    editor.getModel().updateOptions({tabSize: 2});\n    const {registerAPI} = this.props;\n    if (registerAPI) {\n      registerAPI({\n        goToLine: (lineNo, colNo) => {\n          this.editor.focus();\n          this.editor.setPosition({lineNumber: lineNo, column: colNo});\n          this.editor.revealPosition({lineNumber: lineNo, column: colNo})\n        },\n        refresh: _ => {\n          // this.editor.refresh();\n        },\n        focus: _ => {\n          this.editor.focus();\n        },\n      });\n    }\n  }\n  registerEditor = (editor) => {\n    this.editor = editor;\n  }\n  render() {\n    const {options = {}, onValueChange = noop, ui} = this.props;\n    const {value} =  this.state;\n    const isDarkMode = darkMatcher.matches;\n\n    // Monaco options\n    // https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.IEditorConstructionOptions.html\n\n    // we pass in mime-type (eg. 'text/css' but monaco wants just 'css')\n    const language = codeMirrorModeToLanguage(options.editor).split('/').pop();\n    return (\n      <Editor\n        theme={isDarkMode ? \"vs-dark\" : \"light\"}\n        language={language}\n        value={value}\n        onChange={onValueChange}\n        onMount={this.handleEditorDidMount}\n        options={{\n          minimap: {enabled: false},\n          lineNumbers: ui.lineNumbers ? \"on\" : \"off\",\n          glyphMargin: false,\n          folding: false,\n          insertSpaces: !ui.tabs,\n          renderWhitespace: ui.showWhitespace,\n        }}\n      />\n    );\n  }\n};\n","import React from 'react';\nimport CodeCodeMirror from './CodeCodeMirror';\nimport CodeMonaco from './CodeMonaco';\nimport * as uiModel from '../libs/ui-model.js';\n\nexport default class Code extends React.Component {\n  componentDidMount() {\n    uiModel.subscribe(this.handleChange);\n  }\n  componentWillUnmount() {\n    uiModel.unsubscribe(this.handleChange);\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  render() {\n    const ui = uiModel.get();\n    const monaco = ui.editor === 'monaco';\n    \n    const {props} = this;\n    const newProps = {...props, ui};\n    return (\n      monaco\n          ? <CodeMonaco {...newProps}/>\n          : <CodeCodeMirror {...newProps}/>\n    );\n  }\n}\n","import React from 'react';\nimport Code from './Code.js';\nimport {classNames} from '../libs/css-utils.js';\n\nexport default function CodeArea(props) {\n  const {\n    value,\n    hackKey,\n    heading,\n    extra = [],\n    options = {},\n    onValueChange,\n    registerAPI,\n  } = props;\n  return (\n    <div className=\"code-area\" style={props.style}>\n        <div className=\"expander\">\n          {heading}\n        </div>\n        <div className={classNames(\"hidee\")}>\n            <Code\n              hackKey={hackKey}\n              value={value}\n              options={options}\n              onValueChange={onValueChange}\n              registerAPI={registerAPI}\n            />\n          {extra}\n        </div>\n    </div>\n  );\n};\n","import mime from 'mime-types';\nimport React from 'react';\nimport CodeArea from './CodeArea.js';\n\nexport default class File extends React.Component {\n  componentDidMount() {\n    const {register} = this.props;\n    register(this, {\n      goToLine: (data) => {\n        const {title} = this.props;\n        if (data.section === title) {\n          this.codeAPI.goToLine(data.lineNo, data.colNo);\n          return true;\n        }\n      },\n      refresh: _ => this.codeAPI.refresh(),\n      focus: _ => this.codeAPI.focus(),\n    });\n  }\n  componentWillUnmount() {\n    const {unregister} = this.props;\n    unregister(this);\n  }\n  handleRegisterAPI = (api) => {\n    this.codeAPI = api;\n  }\n  render() {\n    const props = this.props;\n    const {title, hackKey} = props;\n    const heading = (\n      <div style={{width: '100%'}}>{title}</div>\n    );\n    const mimeType = mime.lookup(title) || (title.toLowerCase() === 'javascript' ? 'application/javascript' : 'application/octet-stream');\n    const options = {\n      ...props.options,\n      editor: {\n        ...(props.options?.editor && props.options.editor),\n        mode: mimeType,\n      },\n    };\n    return (\n      <CodeArea\n        key={hackKey}\n        {...props}\n        options={options}\n        heading={heading}\n        registerAPI={this.handleRegisterAPI}\n      />\n    );\n  }\n}\n\n/*\nexport default function TestArea(props) {\n  const {desc, title, onTitleChange, hackKey} = props;\n  const heading = (\n    <div>{title}</div>\n    <EditLine\n      placeholder={desc}\n      value={title}\n      onChange={onTitleChange}\n    />\n  );\n\n  return (\n    <CodeArea key={hackKey} {...props} heading={heading} />\n  );\n}\n*/\n","import Ajv from 'ajv';\nimport React from 'react';\nimport Split, {moveGuttersComputeNewSizes} from 'react-split-it';\n\nimport * as model from '../libs/model.js';\nimport File from './File.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst makeId = _ => `${Date.now()}+${Math.random()}`;\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}},\n  },\n  \"required\": [\"sizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Files extends React.Component {\n  constructor(props) {\n    super(props);\n    this.files = new Map();\n    this.fileToKeyMap = new Map();\n    this.kUIStateKey = `${props.uiStateKey}-files`;\n    const state = uiModel.get()[this.kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      sizes: [],\n    };\n    if (this.state.sizes.length !== props.data.files.length) {\n      this.state.sizes = props.data.files.map((_, i) => 1 / props.data.files.length);\n    }\n  }\n  onSetSizes = (sizes) => {\n    this.setState({sizes});\n    uiModel.set(this.kUIStateKey, this.state);\n  }\n  handleRegister = (file, api) => {\n    this.files.set(file, api);\n  }\n  handleUnregister = (file) => {\n    this.files.delete(file);\n  }\n  getFileKey(test) {\n    let key = this.fileToKeyMap.get(test);\n    if (!key) {\n      key = makeId();\n      this.fileToKeyMap.set(test, key);\n    }\n    return key;\n  }\n  componentDidMount() {\n    const {registerAPI} = this.props;\n    registerAPI({\n      goToLine: (data) => {\n        this.files.forEach(api => {\n          api.goToLine(data);\n        });\n      },\n    });\n  }\n  render() {\n    const {hackKey, data, extra, direction} = this.props;\n    const {sizes} = this.state;\n    return (\n      <div className=\"codes\">\n        <Split\n          direction={direction}\n          minSize={0}\n          sizes={sizes}\n          onSetSizes={this.onSetSizes}\n          computeNewSizesFn={moveGuttersComputeNewSizes}\n        >\n        {\n          data.files.map((file, ndx) => {\n            return (\n              <File\n                key={`ca${this.getFileKey(file)}`}\n                hackKey={hackKey}\n                desc=\"filename\"\n                title={file.name}\n                value={file.content}\n                onTitleChange={name => model.setFileName(ndx, name)}\n                onValueChange={value => model.setFileContent(ndx, value)}\n                register={this.handleRegister}\n                unregister={this.handleUnregister}\n                extra={extra}\n              />\n            );\n          })\n        }\n        </Split>\n      </div>\n    );\n  }\n}\n\n//         {/*<button onClick={() => model.addFile()}>+</button>*/}\n","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport Files from './Files.js';\nimport Log from './Log.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layout3Vertical';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"hSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"vSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"hSizes\", \"vSizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Layout3Vertical extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      hSizes: [0.5, 0.5],\n      vSizes: [0.9, 0.1],\n    };\n  }\n  onSetVSizes = (sizes) => {\n    this.setState({vSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetHSizes = (sizes) => {\n    this.setState({hSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  registerFilesAPI = (api) => {\n    this.filesAPI = api;\n  }\n  handleGoToLine = (data) => {\n    this.filesAPI.goToLine(data);\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const {vSizes, hSizes} = this.state;\n    return (\n      <Split direction=\"horizontal\" minSize={0} sizes={hSizes} onSetSizes={this.onSetHSizes}>\n        <div className=\"left\">\n          <Files\n            direction=\"vertical\"\n            uiStateKey={kUIStateKey}\n            data={data}\n            hackKey={hackKey}\n            registerAPI={this.registerFilesAPI}\n          />\n        </div>\n        <div className=\"right\">\n          <Split direction=\"vertical\" minSize={0} sizes={vSizes} onSetSizes={this.onSetVSizes}>\n            <Runner registerAPI={registerRunnerAPI} />\n            <Log onGoToLine={this.handleGoToLine} />\n          </Split>\n        </div>\n      </Split>\n    );\n  };\n}","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport Files from './Files.js';\nimport Log from './Log.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layout3Horizontal';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"tSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"bSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"tSizes\", \"bSizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Layout3Horizontal extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      tSizes: [0.5, 0.5],\n      bSizes: [0.9, 0.1],\n    };\n  }\n  onSetTSizes = (sizes) => {\n    this.setState({tSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetBSizes = (sizes) => {\n    this.setState({bSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  registerFilesAPI = (api) => {\n    this.filesAPI = api;\n  }\n  handleGoToLine = (data) => {\n    this.filesAPI.goToLine(data);\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const {tSizes, bSizes} = this.state;\n    return (\n      <Split direction=\"vertical\" minSize={0} sizes={tSizes} onSetSizes={this.onSetTSizes}>\n        <div className=\"layout-3-horizontal-top\">\n          <Files uiStateKey={kUIStateKey} direction=\"horizontal\" data={data} hackKey={hackKey} registerAPI={this.registerFilesAPI} />\n        </div>\n        <div className=\"layout-3-horizontal-bottom\">\n          <Split direction=\"vertical\"  sizes={bSizes} onSetSizes={this.onSetBSizes}>\n            <Runner registerAPI={registerRunnerAPI} />\n            <Log onGoToLine={this.handleGoToLine} />\n          </Split>\n        </div>\n      </Split>\n    );\n  };\n}","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport File from './File.js';\nimport Log from './Log.js';\nimport * as model from '../libs/model.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\nimport {getOrFindNdx} from '../libs/utils';\n\nconst kUIStateKey = 'layout2x2';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"hSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"v1Sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"v2Sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"hSizes\", \"v1Sizes\", \"v2Sizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nfunction NamedFile(props) {\n  const {data, ndx, hackKey, register, unregister} = props;\n  const file = data.files[ndx];\n  return (\n    <File\n      //key={`ca${this.getFileKey(file)}`}\n      hackKey={hackKey}\n      desc=\"filename\"\n      title={file.name}\n      value={file.content}\n      onTitleChange={name => model.setFileName(ndx, name)}\n      onValueChange={value => model.setFileContent(ndx, value)}\n      register={register}\n      unregister={unregister}\n    />\n  );\n}\n\n\nexport default class Layout2x2 extends React.Component {\n  constructor(props) {\n    super(props);\n    this.files = new Map();\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      hSizes: [0.5, 0.5],\n      v1Sizes: [0.4, 0.6],\n      v2Sizes: [0.4, 0.5, 0.1],\n    };\n  }\n  onSetHSizes = (sizes) => {\n    this.setState({hSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetV1Sizes = (sizes) => {\n    this.setState({v1Sizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetV2Sizes = (sizes) => {\n    this.setState({v2Sizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  handleRegister = (file, api) => {\n    this.files.set(file, api);\n  }\n  handleUnregister = (file) => {\n    this.files.delete(file);\n  }\n  handleGoToLine = (data) => {\n    this.files.forEach(api => {\n      api.goToLine(data);\n    });\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const files = data.files;\n    const mainHTMLNdx = getOrFindNdx(files, 'index.html', 'html');\n    const mainJSNdx = getOrFindNdx(files, 'index.js', 'js', 'js', 'javascript');\n    const mainCSSNdx = getOrFindNdx(files, 'index.css', 'css');\n    const {hSizes, v1Sizes, v2Sizes} = this.state;\n\n    return (\n      <Split direction=\"horizontal\" minSize={0} sizes={hSizes} onSetSizes={this.onSetHSizes}>\n        <div className=\"left\">\n          <Split direction=\"vertical\" minSize={0} sizes={v1Sizes} onSetSizes={this.onSetV1Sizes}>\n            <NamedFile hackKey={hackKey} register={this.handleRegister} unregister={this.handleUnregister} data={data} ndx={mainHTMLNdx} />\n            <NamedFile hackKey={hackKey} register={this.handleRegister} unregister={this.handleUnregister} data={data} ndx={mainJSNdx} />\n          </Split>\n        </div>\n        <div className=\"right\">\n          <Split direction=\"vertical\" minSize={0} sizes={v2Sizes} onSetSizes={this.onSetV2Sizes}>\n            <NamedFile hackKey={hackKey} register={this.handleRegister} unregister={this.handleUnregister} data={data} ndx={mainCSSNdx} />\n            <Runner registerAPI={registerRunnerAPI} />\n            <Log onGoToLine={this.handleGoToLine} />\n          </Split>\n        </div>\n      </Split>\n    );\n  };\n}","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport File from './File.js';\nimport Log from './Log.js';\nimport * as model from '../libs/model.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layoutTabbed';\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"showResult\": { \"type\": \"boolean\" },\n    \"showLog\": { \"type\": \"boolean\" },\n    \"currentNdx\": { \"type\": \"integer\" },\n    \"sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 3 },\n    \"lastSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 3 },\n  },\n  \"required\": [\"sizes\", \"lastSizes\", \"showResult\", \"showLog\", \"currentNdx\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nconst makeId = _ => `${Date.now()}-${Math.random()}`;\n\nfunction fixSizes(sizes, lastSizes, ndx, show) {\n  if (show) {\n    // we're adding a size back in.\n    const oldSize = lastSizes[ndx];\n    const availableSpace = 1 - oldSize;\n    const s = sizes.filter((_, i) => ndx !== i);\n    const len = s.reduce((sum, size) => sum + size, 0);\n    const newSizes = s.map(size => size / len * availableSpace);\n    newSizes.splice(ndx, 0, oldSize);\n    return newSizes;\n  } else {\n    // we're removing a size\n    const s = sizes.map((size, i) => ndx === i ? 0 : size);\n    const len = s.reduce((sum, size) => sum + size, 0);\n    const newSizes = s.map(size => size / len);\n    return newSizes;\n  }\n}\n\nexport default class Layout3Horizontal extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      showResult: true,\n      showLog: true,\n      currentNdx: 2,\n      sizes: [0.45, 0.45, 0.1],\n      lastSizes: [0.45, 0.45, 0.1],\n    };\n    this.files = new Map();\n    this.fileToKeyMap = new Map();\n  }\n  handleRegister = (file, api) => {\n    this.files.set(file, api);\n  }\n  handleUnregister = (file) => {\n    this.files.delete(file);\n  }\n  getFileKey(test) {\n    let key = this.fileToKeyMap.get(test);\n    if (!key) {\n      key = makeId();\n      this.fileToKeyMap.set(test, key);\n    }\n    return key;\n  }\n  setSizes = (sizes) => {\n    const lastSizes = this.state.lastSizes.slice()\n    if (this.state.currentNdx >= 0) { lastSizes[0] = sizes[0] }\n    if (this.state.showResult) { lastSizes[1] = sizes[1]; }\n    if (this.state.showLow) { lastSizes[2] = sizes[2]; }\n    this.setState({sizes, lastSizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  handleGoToLine = (data) => {\n    // this.files is Map of File components\n    this.files.forEach((api, file) => {\n      if (api.goToLine(data)) {\n        const {files} = this.props.data;\n        // this is gross (T_T)\n        const ndx = files.findIndex(file => file.name === data.section);\n        if (ndx !== this.state.currentNdx) {\n          this.handleOnChange(ndx);\n        }\n      }\n    });\n  }\n  handleOnChange = (ndx) => {\n    const currentNdx = this.state.currentNdx === ndx ? -1 : ndx;\n    this.setState({\n      currentNdx,\n      sizes: fixSizes(this.state.sizes, this.state.lastSizes, 0, currentNdx >= 0),\n    });\n    uiModel.set(kUIStateKey, this.state);\n  }\n  toggleShowLog = () => {\n    const showLog = !this.state.showLog;\n    this.setState({\n      showLog,\n      sizes: fixSizes(this.state.sizes, this.state.lastSizes, 2, showLog),\n    });\n    uiModel.set(kUIStateKey, this.state);\n  }\n  toggleShowResult = () => {\n    const showResult = !this.state.showResult;\n    this.setState({\n      showResult,\n      sizes: fixSizes(this.state.sizes, this.state.lastSizes, 1, showResult),\n    });\n    uiModel.set(kUIStateKey, this.state);\n  }\n  componentDidUpdate() {\n    if (this.previousNdx !== this.state.currentNdx) {\n      this.previousNdx = this.state.currentNdx;\n      this.files.forEach(api => {\n        api.refresh();\n        api.focus();\n      });\n    }\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const {showResult, showLog, sizes, currentNdx} = this.state;\n    const resultStyle = {...(!showResult && {display: 'none'})}\n    const logStyle = {...(!showLog && {display: 'none'})}\n    return (\n      <div className=\"layout-tabbed\">\n        <div className=\"layout-tabbed-top\">\n          <div className=\"tab-tabs\">\n            {\n              data.files.map((file, ndx) => {\n                const key = `ca${this.getFileKey(file)}`;\n                return (\n                  <React.Fragment key={key}>\n                    <input\n                      type=\"radio\"\n                      name=\"tabbed-files\"\n                      id={key}\n                      checked={ndx === currentNdx}\n                      onClick={_ => this.handleOnChange(ndx)}\n                      onChange={_ => _} /* this is to shut up react */\n                    />\n                    <label htmlFor={key}>{file.name}</label>\n                  </React.Fragment>\n                );\n              })\n            }\n            <input\n              type=\"checkbox\"\n              checked={showResult}\n              onChange={this.toggleShowResult}\n              id=\"result\"\n            />\n            <label htmlFor=\"result\">result</label>\n            <input\n              type=\"checkbox\"\n              checked={showLog}\n              onChange={this.toggleShowLog}\n              id=\"log\"\n            />\n            <label htmlFor=\"log\">log</label>\n          </div>\n        </div>\n        <Split direction=\"vertical\" minSize={0} sizes={sizes} onSetSizes={this.setSizes}>\n          <div className=\"tab-content\">\n          {\n            data.files.map((file, ndx) => {\n              const key = `ca${this.getFileKey(file)}`;\n              return (\n                <div key={key} style={{...(ndx !== currentNdx && {display: 'none'})}}>\n                  <File\n                    hackKey={hackKey}\n                    desc=\"filename\"\n                    title={file.name}\n                    value={file.content}\n                    onTitleChange={name => model.setFileName(ndx, name)}\n                    onValueChange={value => model.setFileContent(ndx, value)}\n                    register={this.handleRegister}\n                    unregister={this.handleUnregister}\n                  />\n                </div>\n              );\n            })\n          }\n          </div>\n          <div className=\"layout-tabbed-result\" style={resultStyle}><Runner registerAPI={registerRunnerAPI} /></div>\n          <div className=\"layout-tabbed-log\" style={logStyle}><Log onGoToLine={this.handleGoToLine} /></div>\n        </Split>\n      </div>\n    );\n  };\n}","import React from 'react';\n\nimport Layout1 from './Layout1.js';\nimport Layout3Vertical from './Layout3Vertical.js';\nimport Layout3Horizontal from './Layout3Horizontal.js';\nimport Layout2x2 from './Layout2x2.js';\nimport LayoutTabbed from './LayoutTabbed.js';\n\nimport * as uiModel from '../libs/ui-model.js';\n\nconst layoutModes = [\n  Layout3Vertical,\n  Layout3Horizontal,\n  Layout2x2,\n  LayoutTabbed,\n];\n\nexport default class IDE extends React.Component {\n  componentDidMount() {\n    uiModel.subscribe(this.handleChange);\n  }\n  componentWillUnmount() {\n    uiModel.unsubscribe(this.handleChange);\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  render() {\n    const {fullscreen} = this.props;\n    const mode = uiModel.get().layout;\n    const layoutMode = fullscreen ? Layout1 : layoutModes[mode]\n    return React.createElement(layoutMode, this.props);\n  }\n}\n\n","import Ajv from 'ajv';\nimport * as model from './model.js';\nimport {storageManager} from '../globals.js';\nconst gistsKey = 'gists';\n\nconst gistSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"name\": { \"type\": \"string\" },\n    \"date\": { \"type\": \"string\" },\n    \"locallySaved\": { \"type\": \"boolean\" },\n  },\n  \"required\": [\"name\", \"date\"],\n};\n\nconst gistsSchema = {\n  \"$schema\": \"http://json-schema.org/schema#\",\n  \"type\": \"object\",\n  \"additionalProperties\": gistSchema,\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst gistsValidator = ajv.compile(gistsSchema);\nconst gistValidator = ajv.compile(gistSchema);\n\nfunction getStoredGists() {\n  try {\n    const gists = JSON.parse(storageManager.get(gistsKey));\n    if (!gistsValidator(gists)) {\n      storageManager.delete(gistsKey);\n      throw new Error();\n    }\n    return gists;\n  } catch(e) {\n    return {};\n  }\n}\n\nmodel.add('gists', getStoredGists());\n\n// does this need to be centralized?\nstorageManager.subscribe(gistsKey, () => {\n  model.set('gists', getStoredGists());\n});\n\nexport function addGist(id, name, date, _public) {\n  const gist = {name, date, public: _public, locallySaved: true};\n  if (!gistValidator(gist)) {\n    throw new Error(`gist not valid:\\n${gistValidator.errors.map(e => `${e.message}: ${e.dataPath}`)}`)\n  }\n  const gists = {...model.get('gists')};\n  gists[id] = gist;\n  model.set('gists', gists);\n  saveGistsToLocalStorage(gists);\n}\n\nexport function removeGist(id) {\n  const gists = {...model.get('gists')};\n  delete gists[id];\n  model.set('gists', gists);\n  saveGistsToLocalStorage(gists);\n}\n\nfunction saveGistsToLocalStorage(gists) {\n  // send to other windows\n  storageManager.set(gistsKey, JSON.stringify(gists));\n}\n\nexport function getGists() {\n  return model.get('gists');\n}\n\nexport function setGists(gists) {\n  if (!gistsValidator(gists)) {\n    throw new Error(`gists not valid:\\n${gistValidator.errors.map(e => `${e.message}: ${e.dataPath}`)}`)\n  }\n  model.set('gists', gists);\n  saveGistsToLocalStorage(gists);\n}\n\nexport function subscribe(fn) {\n  model.subscribe('gists', fn);\n}\n\nexport function unsubscribe(fn) {\n  model.unsubscribe('gists', fn);\n}\n","import React from 'react';\nimport EditLine from './EditLine.js';\nimport {classNames} from '../libs/css-utils.js';\nimport * as gists from '../libs/gists.js';\nimport ServiceContext from '../ServiceContext.js';\n\ntype Gist = {\n  name: string,\n  date: string,\n  public: boolean,\n  locallySaved?: boolean,\n  id: string,\n}\n\n// ( ) Wrap table with div, scroll div. Because table expands to 100%\n\ninterface GistIdMap {\n   [key: string]: Gist;\n} \n\ntype LoadGistState = {\n  loading: boolean,\n  gists: GistIdMap,\n  checks: Set<string>,\n  filter: string,  // TODO: move up\n  sortKey: string, // TODO: move up\n  sortDir: string, // TODO: move up\n  shift: boolean,\n};\n\nfunction getSortFn(sortKey: string, checks: Set<string>): (a: Gist, b: Gist) => number {\n  switch (sortKey) {\n    case 'name':\n      return (a: Gist, b: Gist) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : (a.name.toLowerCase() > b.name.toLowerCase() ? 1 : 0);\n    case 'date':\n      return (a: Gist, b: Gist) => a.date < b.date ? -1 : (a.date > b.date ? 1 : 0);\n    case 'public':\n      return (a: Gist, b: Gist) => {\n        const ap = a.public ? 1 : 0;\n        const bp = b.public ? 1 : 0;\n        return Math.sign(ap - bp);\n      };\n    case 'check':\n      return (a: Gist, b: Gist) => {\n        const ap = checks.has(a.id) ? 1 : 0;\n        const bp = checks.has(b.id) ? 1 : 0;\n        return Math.sign(ap - bp);\n      };\n    default:\n      throw new Error('unknown sortKey');\n  }\n}\n\nfunction gistsToSortedArray(gists: GistIdMap, checks: Set<string>, sortKey: string, sortDir: string) {\n  const compareDirMult = sortDir === 'down' ? 1 : -1;\n  const compFn = getSortFn(sortKey, checks);\n  return Object.entries(gists).map(([id, {name, date, public: _public}]) => {\n    return {id, name, date, public: _public};\n  }).sort((b, a) => compFn(a, b) * compareDirMult);\n}\n\nfunction matchFilter(filter: string) {\n  filter = filter.trim().toLowerCase();\n  return function(gist: Gist) {\n    const {name, date} = gist;\n    return filter === '' ||\n           name.toLowerCase().includes(filter) ||\n           date.substring(0, 10).includes(filter);\n  }\n}\n\n\ntype SortKeyInfo = {\n  sortDir: string,\n  selected: boolean,\n  update: (sortDir: string) => void,\n};\n\nfunction SortBy(props: SortKeyInfo) {\n  const {sortDir, selected, update} = props;\n  return (\n    <React.Fragment>\n      <span onClick={() => update(!selected ? sortDir : (sortDir === 'up' ? 'down' : 'up'))} className={selected ? 'current-sort-key' : ''}>{sortDir === 'up' ? '' : ''}</span>\n    </React.Fragment>\n  );\n}\n\nfunction getDateOfNewestNonLocallySavedGist(gistsById: GistIdMap) {\n  let since;\n  for (const {date, locallySaved} of Object.values(gistsById)) {\n    if (!locallySaved) {\n      if (!since || date > since) {\n        since = date;\n      }\n    }\n  }\n  return since;\n}\n\nexport default class LoadGist extends React.Component<{}, LoadGistState> {\n  constructor (props: {}) {\n    super(props);\n    const _gists = gists.getGists();\n    this.state = {\n      loading: false,\n      gists: _gists,\n      checks: new Set(),\n      filter: '',\n      sortKey: 'date',\n      sortDir: 'down',\n      shift: false,\n    };\n  }\n  handleNewGists = (gists: GistIdMap) => {\n    this.setState({\n      gists,\n    });\n  }\n  toggleCheck = (id: string) => {\n    const checks = new Set(this.state.checks);\n    if (checks.has(id)) {\n      checks.delete(id);\n    } else {\n      checks.add(id);\n    }\n    this.setState({checks});\n  }\n  onUserStatusChange = () => {\n    this.forceUpdate();\n    const {userManager} = this.context;\n    if (userManager.getUserData()) {\n      this.loadGists();\n    }\n  }\n  updateSort = (sortKey: string, sortDir: string) => {\n    console.log('update:', sortKey, sortDir);\n    this.setState({sortDir, sortKey});\n  }\n  componentDidMount() {\n    const {userManager} = this.context;\n    gists.subscribe(this.handleNewGists);\n    userManager.subscribe(this.onUserStatusChange);\n    window.addEventListener('keydown', this.handleKeyDown);\n    window.addEventListener('keyup', this.handleKeyUp);\n  }\n  componentWillUnmount() {\n    const {userManager} = this.context;\n    gists.unsubscribe(this.handleNewGists);\n    userManager.unsubscribe(this.onUserStatusChange);\n    window.removeEventListener('keydown', this.handleKeyDown);\n    window.removeEventListener('keyup', this.handleKeyUp);\n  }\n  handleKeyDown = (e: KeyboardEvent) => {\n    this.setState({shift: e.shiftKey});\n  }\n  handleKeyUp = (e: KeyboardEvent) => {\n    this.setState({shift: e.shiftKey});\n  }\n  loadGists = async() => {\n    const {addError, github} = this.context;\n    this.setState({loading: true});\n    try {\n      // This doesn't belong here. It's not the UI's responsibility\n      // to manage this stuff.\n      // Find data of the newest gist that was not locally saved.\n      // then pass that to getUserGists so Github will return only\n      // newer gists.\n      const existingGists = this.state.shift ? {} : this.state.gists;\n      const since = getDateOfNewestNonLocallySavedGist(existingGists);\n      const gistArray = await github.getUserGists(since);\n      const gistsById = gistArray.reduce((gists: any[], gist: any) => {\n        gists[gist.id] = {\n          name: gist.description,\n          date: gist.updated_at,\n          public: gist.public,\n        };\n        return gists;\n      }, {...existingGists});\n      gists.setGists(gistsById);\n    } catch (e) {\n      addError(`could not load gists: ${e}`);\n    }\n    this.setState({loading: false});\n  }\n  deleteSelected = async() => {\n    const {checks, gists: _gists} = this.state;\n    const ids: string[] = [];\n    // just incase?\n    checks.forEach((id, ndx) => {\n      if (_gists[id]) {\n        ids.push(id);\n      }\n    });\n    const {addError, github} = this.context;\n    this.setState({loading: true});\n    for (const id of ids) {\n      try {\n        await github.deleteGist(id);\n        gists.removeGist(id);\n      } catch(e) {\n        addError(`could not delete gist: ${id}: ${e}`);\n      }\n    }\n    this.setState({loading: false});\n  }\n  clearBackup = () => {\n    const {backupManager} = this.context;\n    backupManager.clearBackup();\n  }\n  renderLogin() {\n    const {userManager} = this.context;\n    return (\n      <div>\n        <button\n          onClick={userManager.login}\n        >Login with github</button>\n      </div>\n    );\n  }\n  renderLoad() {\n    const {userManager} = this.context;\n    const {gists, checks, loading, filter, sortKey, sortDir, shift} = this.state;\n    const userData = userManager.getUserData();\n    const canLoad = !!userData && !loading;\n    const gistArray = gistsToSortedArray(gists, checks, sortKey, sortDir);\n    return (\n      <div>\n        <p>\n          <button\n            className={classNames({disabled: !canLoad})}\n            onClick={this.loadGists}\n          >{shift ? '(Force) ' : ''}Load New Gists</button>\n        </p>\n         {\n            gistArray.length >= 0 &&\n              <React.Fragment>\n              <p>\n                <EditLine className=\"foobar\" placeholder=\"search:\" value={filter} onChange={(filter:string) => {this.setState({filter})}} />\n              </p>\n              <div className=\"gists\">\n                <table>\n                  <thead>\n                    <tr>\n                      <th><SortBy selected={sortKey === 'check'} sortDir={sortDir} update={(dir: string) => this.updateSort('check', dir)}/></th>\n                      <th><SortBy selected={sortKey === 'name'} sortDir={sortDir} update={(dir: string) => this.updateSort('name', dir)}/></th>\n                      <th><SortBy selected={sortKey === 'date'} sortDir={sortDir} update={(dir: string) => this.updateSort('date', dir)}/></th>\n                      <th><SortBy selected={sortKey === 'public'} sortDir={sortDir} update={(dir: string) => this.updateSort('public', dir)}/></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                  {\n                    gistArray.filter(matchFilter(filter)).map((gist, ndx) => {\n                      return (\n                        <tr key={`g${ndx}`}>\n                          <td><input type=\"checkbox\" id={`gc${ndx}`} checked={checks.has(gist.id)} onChange={() => this.toggleCheck(gist.id)}/><label htmlFor={`gc${ndx}`}/></td>\n                          <td><a onClick={this.clearBackup} href={`${window.location.origin}?src=${encodeURIComponent(gist.id)}`}>{gist.name}</a></td>\n                          <td>{gist.date.substring(0, 10)}</td>\n                          <td>{gist.public ? '' : ''}</td>\n                        </tr>\n                      );\n                    })\n                  }\n                  </tbody>\n                </table>\n              </div>\n              <div><button onClick={this.deleteSelected}>Delete Selected Gists</button></div>\n              </React.Fragment>\n          }\n      </div>\n    );\n  }\n  render() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    return userData ? this.renderLoad() : this.renderLogin();\n  }\n}\n\nLoadGist.contextType = ServiceContext;\n","import React, {useContext, useState} from 'react';\nimport Code from './Code.js';\nimport * as model from '../libs/model.js';\nimport ServiceContext from '../ServiceContext.js';\n\nexport default function LoadJSON(props) {\n  const [json, setJSON] = useState('');\n  const {addError} = useContext(ServiceContext);\n  function load() {\n    const {onLoad} = props;\n    try {\n      const data = JSON.parse(json);\n      model.setData(data);\n      onLoad();\n    } catch (e) {\n      addError(`bad json: ${e}`);\n    }\n  }\n  return (\n    <div>\n      <div style={{height: '100px'}}>\n        <Code\n          value={json}\n          onValueChange={setJSON}\n\n        />\n      </div>\n      <p>\n        <button onClick={load}>Load JSON</button>\n      </p>\n    </div>\n  )\n}","import React, {useContext, useState} from 'react';\nimport EditLine from './EditLine';\nimport * as model from '../libs/model.js';\nimport ServiceContext from '../ServiceContext.js';\n\nexport default function LoadURL(props) {\n  const [url, setUrl] = useState('');\n  const {addError} = useContext(ServiceContext);\n  async function loadUrl() {\n    const {onLoad} = props;\n    try {\n      const req = await fetch(url);\n      const data = await req.json();\n      model.setData(data);\n      onLoad()\n    } catch(e) {\n      addError(`could not load url: ${e}`);\n    }\n  } \n  return (\n    <div>\n      <EditLine value={url} onChange={setUrl} placeholder=\"url-to-json\" />\n      <p>\n        <button onClick={loadUrl}>Load URL</button>\n      </p>\n    </div>\n  )\n}","import React from 'react';\n\nexport default function Section(props) {\n  const {heading, children} = props;\n  return (\n    <div className=\"section\">\n      <div className=\"section-heading\">{heading}</div>\n      <div className=\"section-content\">\n        {children}\n      </div>\n    </div>\n  );\n}","import React from 'react';\nimport Dialog from './Dialog.js';\nimport LoadGist from './LoadGist';\nimport LoadJSON from './LoadJSON.js';\nimport LoadURL from './LoadURL.js';\nimport Section from './Section.js';\n\nexport default function Load(props) {\n  const {data, onLoad, onClose} = props;\n  return (\n    <Dialog title=\"Load\" className=\"fixed-size-dialog\" onClose={onClose}>\n      <Section heading=\"Load Gist\">\n        <LoadGist data={data} onLoad={onLoad} />\n      </Section>\n      <Section heading=\"Load URL\">\n        <LoadURL data={data} onLoad={onLoad} />\n      </Section>\n      <Section heading=\"Load JSON\">\n        <LoadJSON data={data} onLoad={onLoad} />\n      </Section>\n    </Dialog>\n  )\n}\n","import {decode, encode} from 'base64-arraybuffer';\nimport {inflate, deflate} from 'uzip-module';\n\nconst utf8Encoder = new TextEncoder();\nconst utf8Decoder = new TextDecoder();\nconst compressedPrefix = 'cb64,';\nconst uncompressedPrefix = 'b64,';\n\nexport const isCompressedBase64 = s => s.startsWith(compressedPrefix) || s.startsWith(uncompressedPrefix);\nexport function compressedBase64ToJSON(src) {\n  const isCompressed = src.startsWith(compressedPrefix);\n  const prefix = isCompressed ? compressedPrefix : uncompressedPrefix;\n  const base64 = src.substr(prefix.length)\n     .replace(/-/g, '+')\n     .replace(/_/g, '/');\n  const raw = new Uint8Array(decode(base64));\n  const bin = isCompressed \n     ? inflate(raw)\n     : raw;\n  const json = utf8Decoder.decode(bin);\n  return JSON.parse(json);\n}\n\nexport function jsonToCompressedBase64(data) {\n  const json = JSON.stringify(data);\n  const bin = utf8Encoder.encode(json);\n  const compressed = deflate(bin);\n  const useCompressed = compressed.length < bin.length;\n  const base64 = encode(useCompressed ? compressed : bin)\n      .replace(/\\+/g, '-')    // better for URLs because + and / have to be escaped\n      .replace(/\\//g, '_');\n  const prefix = useCompressed ? compressedPrefix : uncompressedPrefix;\n  return `${prefix}${base64}`;\n}\n","\nimport {isCompressedBase64, compressedBase64ToJSON} from './compression.js';\n\nconst idRE = /^[a-z0-9]+$/i;\nexport const isGistId = s => idRE.test(s);\n\nexport async function loadGistFromSrc(src, github) {\n  if (isGistId(src)) {\n    const {data, rawData} = await github.getGist(src);\n    return {data, id: src, rawData};\n  } else if (isCompressedBase64(src)) {\n    return {data: compressedBase64ToJSON(src)};\n  } else {\n    const res = await fetch(src);\n    const data = await res.json();\n    return {data};\n  }\n}\n","import React from 'react';\n\nexport default function Embed(props) {\n  const {gistId} = props;\n  const exampleId = gistId || 'f793cb359f2571409983351a6099d5d1';\n  return (\n    <div>\n      <div className=\"markdown\">\n        <p>\n        You can embed a jsGist by creating an iframe pointing to\n        {' '}<code>https://jsgist.org/embed.html?src=&lt;src&gt;</code>{' '} where\n        {' '}<code>&lt;src&gt;</code>{' '} is one of the forms above. Either\n        {' '}<code>?src=&lt;gist_id&gt;</code>{' '}or\n        {' '}<code>?src=&lt;base64url&gt;</code>{' '}or\n        {' '}<code>?src=&lt;url_to_json&gt;</code>{' '}.\n        You can also add {' '}<code>noheader=true</code>{' '} if you don't want the header\n        to appear. You can also just run them directly rather\n        than put in an iframe. <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://jsgist.org/embed.html?src=${exampleId}`}>[example]</a>{' '}\n        <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://jsgist.org/embed.html?src=${exampleId}&noheader=true`}>[example no header]</a>\n        </p>\n        { !!gistId &&\n            <React.Fragment>\n              <p>\n              For example to embed the current gist:\n              </p>\n              <pre><code style={{userSelect: 'all'}}>\n      &lt;iframe src=\"https://jsgist.org/embed.html?src={gistId}\"&gt;&lt;/iframe&gt;\n              </code></pre>\n            </React.Fragment>\n        }\n        <p>\n        </p>\n      </div>\n    </div>\n  );\n}","import React from 'react';\n\nimport {escapeTextForHTMLContent, getOrFind} from '../libs/utils';\n\n/*\n\n<!-- begin snippet: js hide: false console: true babel: false -->\n\n<!-- language: lang-js -->\n\n    console.log();\n\n<!-- language: lang-css -->\n\n    h1 { color: red; }\n\n<!-- language: lang-html -->\n\n    <h1>foo</h1>  \n\n<!-- end snippet -->\n\n*/\n\nfunction indent4(s) {\n  return s.split('\\n').map(s => `    ${s}`).join('\\n');\n}\n\nfunction makeSnippet(data, asModule) {\n  const files = data.files;\n  const mainHTML = getOrFind(files, 'index.html', 'html');\n  const mainJS = getOrFind(files, 'index.js', 'js', 'js', 'javascript');\n  const mainCSS = getOrFind(files, 'index.css', 'css');\n  return asModule\n    ? `\n<!-- begin snippet: js hide: false console: true babel: false -->\n\n<!-- language: lang-js -->\n\n<!-- language: lang-css -->\n\n${indent4(mainCSS.content)}\n\n<!-- language: lang-html -->\n\n${indent4(mainHTML.content)}\n    <script type=\"module\">\n${indent4(mainJS.content)}\n    </script>\n\n<!-- end snippet -->\n`\n    : `\n<!-- begin snippet: js hide: false console: true babel: false -->\n\n<!-- language: lang-js -->\n\n${indent4(mainJS.content)}\n\n<!-- language: lang-css -->\n\n${indent4(mainCSS.content)}\n\n<!-- language: lang-html -->\n\n${indent4(mainHTML.content)}\n\n<!-- end snippet -->\n`;\n\n}\n\nfunction openInCodepen(data) {\n  const files = data.files;\n  const mainHTML = getOrFind(files, 'index.html', 'html');\n  const mainJS = getOrFind(files, 'index.js', 'js', 'js', 'javascript');\n  const mainCSS = getOrFind(files, 'index.css', 'css');\n\n  const pen = {\n    title                 : data.name,\n    description           : data.name,\n    editors               : '101',\n    html                  : mainHTML.content,\n    css                   : mainCSS.content,\n    js                    : mainJS.content,\n  };\n\n  const elem = document.createElement('div');\n  elem.innerHTML = `\n    <form method=\"POST\" target=\"_blank\" action=\"https://codepen.io/pen/define\" class=\"hidden\">'\n      <input type=\"hidden\" name=\"data\">\n      <input type=\"submit\" />\n    \"</form>\"\n  `;\n  elem.querySelector('input[name=data]').value = JSON.stringify(pen);\n  document.body.appendChild(elem);\n  elem.querySelector('form').submit();\n  document.body.removeChild(elem);\n}\n\nfunction openInJSFiddle(data) {\n  const files = data.files;\n  const mainHTML = getOrFind(files, 'index.html', 'html');\n  const mainJS = getOrFind(files, 'index.js', 'js', 'js', 'javascript');\n  const mainCSS = getOrFind(files, 'index.css', 'css');\n\n  const elem = document.createElement('div');\n  elem.innerHTML = `\n    <form method=\"POST\" target=\"_black\" action=\"https://jsfiddle.net/api/mdn/\" class=\"hidden\">\n      <input type=\"hidden\" name=\"html\" />\n      <input type=\"hidden\" name=\"css\" />\n      <input type=\"hidden\" name=\"js\" />\n      <input type=\"hidden\" name=\"title\" />\n      <input type=\"hidden\" name=\"wrap\" value=\"b\" />\n      <input type=\"submit\" />\n    </form>\n  `;\n  elem.querySelector('input[name=html]').value = mainHTML.content;\n  elem.querySelector('input[name=css]').value = mainCSS.content;\n  elem.querySelector('input[name=js]').value = mainJS.content;\n  elem.querySelector('input[name=title]').value = data.name;\n  document.body.appendChild(elem);\n  elem.querySelector('form').submit();\n  document.body.removeChild(elem);\n}\n\nfunction makeHTML(data, asModule) {\n  const files = data.files;\n  const mainHTML = getOrFind(files, 'index.html', 'html');\n  const mainJS = getOrFind(files, 'index.js', 'js', 'js', 'javascript');\n  const mainCSS = getOrFind(files, 'index.css', 'css');\n  const isModule = asModule !== undefined ? asModule : /\\bimport\\b/.test(mainJS.content);\n  const module = isModule\n    ? ' type=\"module\"'\n    : '';\n  return `<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n    <title>${escapeTextForHTMLContent(data.name)}</title>\n    <style>\n${mainCSS.content}\n    </style>\n  </head>\n  <body>\n${mainHTML.content}\n  </body>\n  <${'script'}${module}>\n${mainJS.content}\n  </${'script'}>\n</html>\n`;\n}\n\nexport default class Export extends React.Component {\n  constructor(props) {\n    super(props);\n    const mainJS = getOrFind(props.data.files, 'index.js', 'js', 'js', 'javascript');\n    this.state = {\n      asModule: /\\bimport\\b/.test(mainJS.content),  // random guess\n    }\n  }\n  onChange = (asModule) => {\n    this.setState({asModule});\n  }\n  exportToCodepen = () => {\n    openInCodepen(this.props.data);\n  }\n  exportToJSFiddle = () => {\n    openInJSFiddle(this.props.data);\n  }\n  render() {\n    const {data} = this.props;\n    const {asModule} = this.state;\n    return (\n      <div>\n        <button onClick={this.exportToCodepen}>Codepen</button>\n        <button onClick={this.exportToJSFiddle}>JSFiddle</button>\n        <p>StackOverflow Snippet (copy the code below paste into S.O.)</p>\n        <div>\n          <div><input type=\"radio\" id=\"export-as-module\" checked={asModule} onChange={_ => this.onChange(true)}/><label htmlFor=\"export-as-module\">As es6 module</label></div>\n          <div><input type=\"radio\" id=\"export-as-script\" checked={!asModule} onChange={_ => this.onChange(false)}/><label htmlFor=\"export-as-script\">As script</label></div>\n          <p>S.O. does not support es6 modules yet so picking \"As Module\" puts the code in a &lt;script&gt; in the HTML.</p>\n        </div>\n        <pre className=\"layout-scrollbar\" style={{userSelect: 'all', overflow: 'auto', height: '5em'}}>{makeSnippet(data, asModule)}</pre>\n        <p>HTML (copy the code below paste into a file)</p>\n        <div>\n          <div><input type=\"radio\" id=\"export-as-module\" checked={asModule} onChange={_ => this.onChange(true)}/><label htmlFor=\"export-as-module\">As es6 module</label></div>\n          <div><input type=\"radio\" id=\"export-as-script\" checked={!asModule} onChange={_ => this.onChange(false)}/><label htmlFor=\"export-as-script\">As script</label></div>\n        </div>\n        <pre className=\"layout-scrollbar\" style={{userSelect: 'all', overflow: 'auto', height: '5em'}}>{makeHTML(data, asModule)}</pre>\n      </div>\n    );\n  }\n}","import React from 'react';\nimport {classNames} from '../libs/css-utils.js';\nimport * as gists from '../libs/gists.js';\nimport ServiceContext from '../ServiceContext.js';\n\nexport default class SaveAsGist extends React.Component {\n  constructor () {\n    super();\n    this.state = {\n      saving: false,\n      secret: false,\n    };\n  }\n  componentDidMount() {\n    const {userManager} = this.context;\n    userManager.subscribe(this.onPatChange);\n  }\n  componentWillUnmount() {\n    const {userManager} = this.context;\n    userManager.unsubscribe(this.onPatChange);\n  }\n  onPatChange = () => {\n    this.forceUpdate();\n  }\n  toggleSecret = () => {\n    this.setState({secret: !this.state.secret});\n  }\n  saveNew = async() => {\n    const {github, addError} = this.context;\n    const {secret} = this.state;\n    this.setState({saving: true});\n    const {data, onSave, onClose} = this.props;\n    let success = false;\n    try {\n      const {id, name, date, public: _public} = await github.createGist(data, secret);\n      gists.addGist(id, name, date, _public);\n      onSave(id);\n      success = true;\n    } catch (e) {\n      addError(`could not create gist: ${e}`)\n    }\n    this.setState({saving: false});\n    if (success) {\n      onClose();\n    }\n  }\n  saveOverExisting = async() => {\n    const {github, addError} = this.context;\n    this.setState({saving: true});\n    const {data, gistId, onClose} = this.props;\n    let success = false;\n    try {\n      const {id, name, date, public: _public} = await github.updateGist(gistId, data);\n      gists.addGist(id, name, date, _public);\n      success = true;\n    } catch (e) {\n      addError(`could not update gist: ${e}`)\n    }\n    this.setState({saving: false});\n    if (success) {\n      onClose();\n    }\n  }\n  forkAndSave = async() => {\n    const {github, addError} = this.context;\n    const {data, gistId, onSave, onClose} = this.props;\n    const {secret} = this.state;\n    this.setState({saving: true});\n    let success = false;\n    try {\n      const {id: newId} = await github.forkGist(gistId, secret);\n      const {id, name, date, public: _public} = await github.updateGist(newId, data);\n      gists.addGist(id, name, date, _public);\n      onSave(id);\n      success = true\n    } catch (e) {\n      addError(`could not fork and update gist: ${e}`);\n    }\n    this.setState({saving: false});\n    if (success) {\n      onClose();\n    }\n  }\n  renderLogin() {\n    const {userManager} = this.context;\n    return (\n      <div>\n        <button\n          onClick={userManager.login}\n        >Login with github</button>\n      </div>\n    );\n  }\n  renderSave() {\n    const {saving, secret} = this.state;\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    const {gistId, gistOwnerId} = this.props;\n    const canUpdate = userData && gistId && userData.id === gistOwnerId;\n    const canFork = userData && gistId && userData.id !== gistOwnerId;\n    return (\n      <div>\n        <div>\n          <button\n            className={classNames({disabled: saving})}\n            data-type=\"new\"\n            onClick={this.saveNew}\n          >Save to New Gist</button>\n          <button\n            className={classNames({disabled: !canUpdate || saving})}\n            data-type=\"update\"\n            onClick={this.saveOverExisting}\n          >Update Current Gist</button>\n          <button\n            className={classNames({disabled: !canFork || saving})}\n            data-type=\"fork\"\n            onClick={this.forkAndSave}\n          >Fork and Save Gist</button>\n        </div>\n        <div>\n          <br/>\n          <input\n            type=\"checkbox\"\n            checked={secret}\n            id=\"save-secret\"\n            onChange={this.toggleSecret}\n          />\n          <label htmlFor=\"save-secret\">Secret (unlisted)</label>\n          <blockquote>Warning:\n            <ul>\n              <li>You can not change a gist from public to secret</li>\n              <li>Secret gists are still publicly accessible they're just unlisted</li>\n            </ul>\n            (<a href=\"https://docs.github.com/en/free-pro-team@latest/github/writing-on-github/creating-gists\" target=\"_blank\" rel=\"noopener noreferrer\">see docs</a>)\n          </blockquote>\n        </div>\n      </div>\n    );\n  }\n  render() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    return userData ? this.renderSave() : this.renderLogin();\n  }\n}\n\nSaveAsGist.contextType = ServiceContext;","import React from 'react';\n\nexport default function SaveAsJSON(props) {\n  const {data} = props;\n  return (\n    <div>\n      <div>\n        Copy the text below, paste into the load ui or put somewhere on the net\n        and make your own URL with <code>{window.location.origin}?src=url-to-json</code>.\n      </div>\n      <pre className=\"layout-scrollbar\" style={{userSelect: 'all'}}>{JSON.stringify(data)}</pre>\n      <div><a target=\"_blank\" rel=\"noopener noreferrer\" href={`${window.location.origin}?src=${encodeURIComponent(`${window.location.origin}/example.json`)}`}>Example</a></div>\n    </div>\n  );\n}","import React from 'react';\n\nimport {jsonToCompressedBase64} from '../libs/compression.js';\n\nexport default function SaveAsURL(props) {\n  const {data} = props;\n  const src = jsonToCompressedBase64(data);\n  const url = `${window.location.origin}?src=${encodeURIComponent(src)}`;\n  return url.length < 8000\n    ? (\n      <div>\n        <div>Copy / bookmark the link below</div>\n        <a className=\"bookmark\" href={url} target=\"_blank\" rel=\"noopener noreferrer\">{url}</a>\n      </div>\n      )\n    : (\n      <div class=\"error-msg\">\n        Too large to save as URL\n      </div>\n      )\n    ;\n}\n","import React from 'react';\nimport Dialog from './Dialog.js';\nimport Embed from './Embed.js';\nimport Export from './Export.js';\nimport SaveAsGist from './SaveAsGist.js';\nimport SaveAsJSON from './SaveAsJSON.js';\nimport SaveAsURL from './SaveAsURL.js';\nimport Section from './Section.js';\n\nexport default function Save(props) {\n  const {data, gistId, gistOwnerId, onSave, onClose} = props;\n  return (\n    <Dialog title=\"Save\" onClose={onClose}>\n      <Section heading=\"Save As Gist\">\n        <SaveAsGist gistId={gistId} gistOwnerId={gistOwnerId} data={data} onClose={onClose} onSave={onSave} />\n      </Section>\n      <Section heading=\"Save As URL\">\n        <SaveAsURL data={data} />\n      </Section>\n      <Section heading=\"Save As JSON\">\n        <SaveAsJSON data={data} />\n      </Section>\n      <Section heading=\"Embedding\">\n        <Embed gistId={gistId} />\n      </Section>\n      <Section heading=\"Export To\">\n        <Export data={data} />\n      </Section>\n    </Dialog>\n  )\n}\n","import React from 'react';\n\nimport Dialog from './Dialog.js';\nimport Section from './Section.js';\nimport ServiceContext from '../ServiceContext.js';\n\nimport verticalIcon from '../icons/vertical-layout.svg';\nimport horizontalIcon from '../icons/horizontal-layout.svg';\nimport twoByTwoIcon from '../icons/two-by-two-layout.svg';\nimport tabbedIcon from '../icons/tabbed-layout.svg';\n\nimport {classNames} from '../libs/css-utils.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nfunction RadioOption(props) {\n  const {children, onChange, selected} = props;\n  return (\n    <div className={classNames({radioSelected: selected})} onClick={onChange}>\n      {children}\n    </div>\n  );\n}\n\nfunction Radio(props) {\n  const {selected, onChange, children} = props;\n\n  const newChildren = React.Children.map(children, (child) => {\n    if (!React.isValidElement(child)) {\n      return null;\n    }\n\n    const {result} = child.props;\n    const isSelected = result === selected;\n\n    //const id = childNdx;\n    //childNdx += 1;\n    return React.cloneElement(child, {\n      //...child.props,\n      selected: isSelected,\n      onChange: () => onChange(result),\n    });\n  });\n\n  return (\n    <div className=\"radio\">\n      {newChildren}\n    </div>\n  );\n}\n\nfunction Checkbox(props) {\n  const {id, label, checked, onChange} = props;\n  const elemId = `checkbox-${id}`;\n  return (\n    <div>\n      <input \n        id={elemId} \n        type=\"checkbox\"\n        checked={checked}\n        onChange={(e) => onChange(e.target.checked)}\n      />\n      <label htmlFor={elemId}>{label}</label>\n    </div>\n  );\n}\n\nclass Logout extends React.Component {\n  componentDidMount() {\n    const {userManager} = this.context;\n    userManager.subscribe(this.handleChange);\n  }\n  componentWillUnmount() {\n    const {userManager} = this.context;\n    userManager.unsubscribe(this.handleChange);\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  handleLogout = () => {\n    const {userManager} = this.context;\n    userManager.logout();\n  }\n  render() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    return (!!userData &&\n      <Section heading=\"Logout\">\n        <div className=\"logout\">Logged in as:&nbsp;\n          {!!userData.login && <div className=\"username\"><a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/${userData.login}`}>{userData.login}</a></div>}\n          {!!userData.avatar_url && <a className=\"user-avatar\" target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/${userData.login}`}><img className=\"avatar\" src={userData.avatar_url} alt=\"avatar\"/></a>}\n        </div>\n        <button onClick={this.handleLogout}>Logout</button>\n      </Section>\n    );\n  }\n}\n\nLogout.contextType = ServiceContext;\n\nexport default class Settings extends React.Component {\n  //constructor(props) {\n  //  super(props);\n  //}\n  componentDidMount() {\n    uiModel.subscribe(this.handleChange);\n  }\n  componentWillUnmount() {\n    uiModel.unsubscribe(this.handleChange);\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  handleLayoutChange = (v) => {\n    uiModel.set('layout', v);\n  }\n  handleEditorChange = (v) => {\n    uiModel.set('editor', v);\n  }\n  handleLineNumbersChange = (v) => {\n    uiModel.set('lineNumbers', v);\n  }\n  handleTabsChange = (v) => {\n    uiModel.set('tabs', v);\n  }\n  handleShowWhitespaceChange = (v) => {\n    uiModel.set('showWhitespace', v);\n  }\n  render() {\n    const {onClose} = this.props;\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    return (\n      <Dialog title=\"Settings\" onClose={onClose}>\n        { !!userData && <Logout /> }\n        <Section heading=\"Layout\">\n          <div className=\"layout\">\n            <Radio selected={uiModel.get().layout} onChange={this.handleLayoutChange}>\n              <RadioOption result={0}><img src={verticalIcon} alt=\"vertical\"/></RadioOption>\n              <RadioOption result={1}><img src={horizontalIcon} alt=\"horizontal\"/></RadioOption>\n              <RadioOption result={2}><img src={twoByTwoIcon} alt=\"2x2\" /></RadioOption>\n              <RadioOption result={3}><img src={tabbedIcon} alt=\"tabbed\" /></RadioOption>\n            </Radio>\n          </div>\n        </Section>\n        <Section heading=\"Editor\">\n          <div className=\"settings\">\n            <Radio selected={uiModel.get().editor} onChange={this.handleEditorChange}>\n              <RadioOption result=\"monaco\"><div>Monaco</div></RadioOption>\n              <RadioOption result=\"codemirror\"><div>CodeMirror</div></RadioOption>\n            </Radio>\n            <Checkbox id=\"lineno\" label=\"Line Numbers\" checked={uiModel.get().lineNumbers} onChange={this.handleLineNumbersChange} />\n            <Checkbox id=\"tabs\" label=\"Indent with tabs\" checked={uiModel.get().tabs} onChange={this.handleTabsChange} />\n            <Checkbox id=\"whitespace\" label=\"Show Whitespace\" checked={uiModel.get().showWhitespace} onChange={this.handleShowWhitespaceChange} />\n          </div>\n        </Section>\n      </Dialog>\n    );\n  }\n}\n\nSettings.contextType = ServiceContext;\n","import React from 'react';\n\nexport default function Toolbar(props) {\n  const {\n    toolbarFns,\n    fullscreen,\n  } = props;\n  const {\n    handleRun,\n    handleStop,\n    handleSave,\n    handleNew,\n    handleLoad,\n    handleFullscreen,\n    handleSettings,\n    handleHelp,\n  } = toolbarFns;\n  return (\n    <div className=\"toolbar\">\n      <button tabIndex=\"1\" onClick={handleRun}>Run</button>\n      <button tabIndex=\"1\" onClick={handleStop}>Stop</button>\n      <button tabIndex=\"1\" onClick={handleSave}>Save</button>\n      <button tabIndex=\"1\" onClick={handleNew}>New</button>\n      <button tabIndex=\"1\" onClick={handleLoad}>Load</button>\n      <button tabIndex=\"1\" onClick={handleSettings} title=\"settings\"><img src={`${window.location.origin}/resources/images/gear.svg`} alt=\"settings\"></img></button>\n      <button tabIndex=\"1\" onClick={handleFullscreen} title=\"fullscreen\"><img src={`${window.location.origin}/resources/images/${fullscreen ? 'un-' : ''}fullscreen.svg`} alt=\"fullscreen\"></img></button>\n      <button tabIndex=\"1\" onClick={handleHelp} title=\"help\">?</button>\n    </div>\n  );\n}","import SubscriptionManager from './SubscriptionManager.ts';\n\nconst kUserManagerKey = 'foobar'; // not important\n\nexport default class UserManager {\n  constructor({\n    oauthManager,\n    github,\n    addError,\n  }) {\n    this.oauthManager = oauthManager;\n    this.github = github;\n    this.subscriptionManager = new SubscriptionManager();\n    this.addError = addError;\n    oauthManager.subscribe(this._handleNewAuth);\n    this._handleNewAuth();\n    this.userData = undefined;\n  }\n  /*\n  {\n    \"login\": \"greggman\",\n    \"id\": 234804,\n    \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n    \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n    \"gravatar_id\": \"\",\n    \"url\": \"https://api.github.com/users/greggman\",\n    \"html_url\": \"https://github.com/greggman\",\n    \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n    \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n    \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n    \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n    \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n    \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n    \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n    \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n    \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n    \"type\": \"User\",\n    \"site_admin\": false,\n    \"name\": \"Greggman\",\n    \"company\": null,\n    \"blog\": \"http://games.greggman.com\",\n    \"location\": \"Earth\",\n    \"email\": \"github@greggman.com\",\n    \"hireable\": null,\n    \"bio\": \"30 years of games\\r\\n5 years of Chrome\",\n    \"twitter_username\": null,\n    \"public_repos\": 283,\n    \"public_gists\": 80,\n    \"followers\": 1037,\n    \"following\": 3,\n    \"created_at\": \"2010-04-01T08:48:05Z\",\n    \"updated_at\": \"2020-10-24T06:05:24Z\"\n  }\n  */\n  getUserData() {\n    return this.userData;\n  }\n  _handleNewAuth = async() => {\n    this.userData = undefined;\n    const pat = this.oauthManager.pat();\n    this.github.setPat(pat);\n    if (pat) {\n      try {\n        const data = await this.github.getAuthenticatedUser();\n        this.userData = data;\n      } catch (e) {\n        this.addError(e);\n      }\n    }\n    this.subscriptionManager.notify(kUserManagerKey);\n  }\n  login = () => {\n    this.oauthManager.login();\n  }\n  logout = () => {\n    this.oauthManager.logout();\n    this.github.setPat()\n  }\n  subscribe(fn) {\n    this.subscriptionManager.subscribe(kUserManagerKey, fn);\n  }\n  unsubscribe(fn) {\n    this.subscriptionManager.unsubscribe(kUserManagerKey, fn);\n  }\n  cleanup() {\n    this.oauthManager.unsubscribe(this._handleNewAuth);\n  }\n}\n\n","import React from 'react';\n\nimport EditLine from './EditLine.js';\n// import Footer from './Footer.js';\nimport {storageManager} from '../globals.js';\nimport GitHub from '../libs/GitHub.js';\nimport Head from './Head.js';\nimport Help from './Help.js';\nimport IDE from './IDE.js';\nimport Load from './Load.js';\nimport {isGistId, loadGistFromSrc} from '../libs/loader.js';\nimport {LogManager} from './Log.js';\nimport * as model from '../libs/model.js';\nimport Save from './Save.js';\nimport ServiceContext from '../ServiceContext.js';\nimport Settings from './Settings.js';\nimport Toolbar from './Toolbar.js';\nimport * as uiModel from '../libs/ui-model.js';\nimport UserManager from '../libs/UserManager.js';\nimport * as winMsgMgr from '../libs/WindowMessageManager';\nimport query from '../libs/start-query.js';\n\nimport './App.css';\nimport { classNames } from '../libs/css-utils.js';\n\nconst noJSX = () => [];\nconst darkMatcher = window.matchMedia('(prefers-color-scheme: dark)');\n\nclass App extends React.Component {\n  constructor(props) {\n    super();\n    this.state = {\n      path: window.location.pathname,\n      dark: darkMatcher.matches,\n      fullscreen: !!query.fullscreen,\n      loading: false,\n      dialog: noJSX,\n      gistId: '',\n      messages: [],\n      userData: {},\n      updateVersion: 0,\n    };\n    this.github = new GitHub();\n    this.oauthManager = props.oauthManager;\n    this.backupManager = props.backupManager;\n    this.logManager = new LogManager();\n    this.userManager = new UserManager({\n      oauthManager: this.oauthManager,\n      github: this.github,\n      addError: this.addError,\n    });\n    this.toolbarFns = {\n      handleRun: this.handleRun,\n      handleStop: this.handleStop,\n      handleSave: this.handleSave,\n      handleNew: this.handleNew,\n      handleLoad: this.handleLoad,\n      handleSettings: this.handleSettings,\n      handleFullscreen: this.handleFullscreen,\n      handleHelp: this.handleHelp,\n    };\n  }\n  componentWillUnmount() {\n    uiModel.unsubscribe(this.handleUIChange);\n    this.userManager.cleanup();\n  }\n  componentDidMount() {\n    uiModel.subscribe(this.handleUIChange);\n    winMsgMgr.on('newGist', null, this.handleNewGist);\n    this.github.addEventListener('userdata', (e) => {\n      this.setState({\n        userData: e.data,\n      });\n    });\n    model.add('path', window.location.pathname);\n    model.subscribe('path', (newValue) => {\n      window.history.pushState({}, '', newValue);\n      this.setState({\n        path: newValue,\n      });\n    });\n    // I still am not sure how I'm supposed to handle this.\n    // Putting my model in the state itself seems wrong\n    // and doesn't actually help since I'd have to \n    // generate an entirely new state object to change any\n    // nested property.\n    //\n    // Storing the data outside I see no way to tell\n    // components to re-render except to call forceUpdate\n    // which all the documentation says \"if you call this\n    // you're doing it wrong\".\n    //\n    // Redux is a joke. 50 lines code needed to set\n    // a single field. Repeat those 50 lines for every field.\n    // Things like redux-tools make it less to type those\n    // 50 lines but they still execute 50 to 500 lines of code\n    // just to set a single value.\n    model.subscribe(model.filesVersionKey, _ => {\n      this.forceUpdate();\n    });\n    // this is a hack because I can't figure out how to\n    // update the CodeMirror areas\n    model.subscribe('updateVersion', _ => {\n      this.setState({updateVersion: this.state.updateVersion + 1});\n    });\n\n    darkMatcher.addEventListener('change', () => {\n      this.setState({dark: darkMatcher.matches});\n    });\n\n    if (query.newGist) {\n      window.history.pushState({}, '', `${window.location.origin}`);\n      window.opener.postMessage({type: 'gimmeDaCodez'}, '*');\n      return;\n    }\n\n    const backup = this.backupManager.getBackup();\n    let loaded = false;\n    if (backup) {\n      try {\n        const data = JSON.parse(backup);\n        if (data.href === window.location.href) {\n          model.setData(data.data);\n          const url = new URL(data.href);\n          const {src} = Object.fromEntries(new URLSearchParams(url.search).entries());\n          if (isGistId(src)) {\n            this.setState({gistId: src, gistOwnerId: data.gistOwnerId});\n          }\n          loaded = true;\n          this.addInfo('loaded backup from local storage')\n        }\n      } catch (e) {\n        console.log('bad backup')\n      }\n      this.backupManager.clearBackup();\n    }\n    if (!loaded) {\n      if (query.src) {\n        this.loadData(query.src);\n      }\n    }\n    this.updateTitle();\n  }\n  componentDidUpdate() {\n    this.updateTitle();\n  }\n  updateTitle() {\n    const data = model.getData();\n    document.title = data.name || 'jsGist';\n  }\n  async loadData(src) {\n    this.setState({loading: true});\n    let success = true;\n    let firstTry = true;\n    for (;;) {\n      try {\n        const {data, id, rawData} = await loadGistFromSrc(src, this.github);\n        model.setData(data);\n        if (id) {\n          this.setState({\n            gistId: src,\n            gistOwnerId: rawData?.owner?.id,\n          });\n        }\n        break;\n      } catch (e) {\n        if (firstTry) {\n          this.userManager.logout();\n          firstTry = false;\n        } else {\n          success = false;\n          console.warn(e);\n          this.addError(`could not load jsGist: src=${src} ${e}`);\n          break;\n        }\n      }\n    }\n    this.setState({loading: false});\n    if (success) {\n      this.handleRun();\n    }\n  }\n  handleUIChange = () => {\n    this.forceUpdate();\n  }\n  handleNewGist = (data) => {\n    let success = true;\n    try {\n      model.setData(data);\n      this.backupManager.clearBackup();\n    } catch (e) {\n      success = false;\n      console.warn(e);\n      this.addError(`could create new jsGist: ${e}`);\n    }\n    if (success) {\n      this.handleRun();\n    }\n  };\n  addMsg = (msg, className) => {\n    switch (className) {\n      case 'error':\n        console.error(msg);\n        break;\n      default:\n        console.log(msg);\n        break;\n    }\n    this.setState({messages: [{msg: msg.toString(), className}, ...this.state.messages]});\n    setTimeout(() => {\n      this.setState({messages: this.state.messages.slice(0, this.state.messages.length - 1)});\n    }, 5000);\n  }\n  addInfo = (msg) => this.addMsg(msg, 'info');\n  addError = (msg) => this.addMsg(msg, 'error');\n  closeDialog = () => {\n    this.setState({dialog: noJSX});\n  }\n  registerRunnerAPI = (api) => {\n    this.runnerAPI = api;\n    this.handleStop();\n  }\n  handleNew = async() => {\n    this.backupManager.clearBackup();\n    window.location.href = window.location.origin;  // causes a reload\n  }\n  handleRun = async () => {\n    this.backupManager.setBackup(JSON.stringify({\n      href: window.location.href,\n      data: model.getData(),\n      gistOwnerId: this.state.gistOwnerId,\n    }));\n    this.logManager.clear();\n    console.clear();\n    this.runnerAPI.run(model.getData());\n  }\n  handleStop = async () => {\n    this.runnerAPI.run(model.getBlankData(), true);\n  }\n  handleSave = async () => {\n    this.setState({dialog: this.renderSave});\n  }\n  handleSettings = () => {\n    this.setState({dialog: this.renderSettings});\n  }\n  handleFullscreen = () => {\n    this.setState({fullscreen: !this.state.fullscreen});\n  }\n  handleHelp = () => {\n    this.setState({dialog: this.renderHelp});\n  }\n  handleLoad = () => {\n    this.setState({dialog: this.renderLoad});\n  }\n  handleOnLoad = async() => {\n    this.setState({dialog: noJSX});\n    this.handleRun();\n  }\n  handleOnSave = (gistId) => {\n    window.history.pushState({}, '', `${window.location.origin}?src=${gistId}`);\n    this.setState({\n      gistId,\n      gistOwnerId: this.userManager.getUserData().id,\n    });\n  }\n  handleAbort = () => {\n    this.abort();\n  };\n  renderHelp = () => {\n    return (<Help onClose={this.closeDialog} />);\n  }\n  renderSettings = () => {\n    return (\n      <Settings onClose={this.closeDialog} />\n    );\n  }\n  renderLoad = () => {\n    return (\n      <Load\n        onLoad={this.handleOnLoad}\n        onClose={this.closeDialog}\n      />\n    );\n  }\n  renderSave = () => {\n    const data = model.getData();\n    return (\n      <Save\n        onSave={this.handleOnSave}\n        onClose={this.closeDialog}\n        gistId={this.state.gistId}\n        gistOwnerId={this.state.gistOwnerId}\n        data={data} />\n    );\n  }\n  render() {\n    const data = model.getData();\n    const {\n      loading,\n      dialog,\n      updateVersion: hackKey,\n      userData,\n      fullscreen,\n    } = this.state;\n    const editor = uiModel.get().editor;\n    return (\n      <div className={classNames('App', `editor-${editor}`)}>\n        <ServiceContext.Provider value={{\n          github: this.github,\n          addError: this.addError,\n          addInfo: this.addInfo,\n          storageManager,\n          logManager: this.logManager,\n          userManager: this.userManager,\n          backupManager: this.backupManager,\n        }}>\n        <div className=\"content\">\n          <div className=\"top\">\n            <div className=\"left\">\n              <div className=\"name\">\n                <EditLine value={data.name} onChange={v => model.setName(v)} />\n                {!!userData.name && <div className=\"username\"><a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/${userData.name}`}>{userData.name}</a></div>}\n                {!!userData.avatarURL && <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/${userData.name}`}><img className=\"avatar\" src={userData.avatarURL} alt=\"avatar\"/></a>}\n              </div>\n            </div>\n            <div className=\"right\">\n              <Toolbar toolbarFns={this.toolbarFns} fullscreen={fullscreen} />\n              <Head />\n            </div>\n          </div>\n          {\n            !loading &&\n              <div className=\"bottom\">\n                <IDE\n                  hackKey={hackKey}\n                  data={data}\n                  registerRunnerAPI={this.registerRunnerAPI}\n                  fullscreen={fullscreen}\n                />\n              </div>\n          }\n        </div>\n        {/*\n        <Footer\n          gistId={gistId}\n          title={data.name}\n        />\n        */}\n        {dialog()}\n        <div className=\"messages\">\n          {\n            this.state.messages.map(({msg, className}, i) => (<div className={className} key={`err${i}`}>{msg}</div>))\n          }\n        </div>\n        </ServiceContext.Provider>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","const backupKey = 'backup';\r\n\r\nexport default class BackupManager {\r\n  #storageManager;\r\n\r\n  constructor(storageManager) {\r\n    this.#storageManager = storageManager;\r\n  }\r\n  getBackup() {\r\n    return this.#storageManager.get(backupKey);\r\n  }\r\n  setBackup(data) {\r\n    this.#storageManager.set(backupKey, data);\r\n  }\r\n  clearBackup() {\r\n    this.#storageManager.delete(backupKey);\r\n  }\r\n}","\nimport {clientId} from '../globals.js';\nimport {createURL} from './url.js';\nimport {createPopup} from './utils';\nimport StorageManager from './StorageManager';\nimport * as winMsgMgr from './WindowMessageManager';\n\nconst patKey = 'pat';\n\nconst getTokenURL = process.env.REACT_APP_OAUTH_HELPER_URL;\nif (!getTokenURL) {\n  throw Error ('must set environment variable: OAUTH_HELPER_URL');\n}\n\nexport default class OAuthManager {\n  private _popup?: Window;\n  private _state?: string;\n  private _storageManager: StorageManager;\n\n  constructor(storageManager: StorageManager) {\n    this._popup = undefined;\n    this._state = undefined;  // last state sent to auth\n    this._storageManager = storageManager;\n    winMsgMgr.on('auth', null, (data: any) => {\n      this._closePopup();\n      if (data.state === this._state) {\n        this.requestToken(data);\n      }\n    });\n  }\n  // TODO: rename this and decide if Github should be connected\n  pat() {\n    return this._storageManager.get(patKey);\n  }\n  subscribe(fn: () => void) {\n    this._storageManager.subscribe(patKey, fn);\n  }\n  unsubscribe(fn: () => void) {\n    this._storageManager.unsubscribe(patKey, fn);\n  }\n  _closePopup() {\n    if (this._popup) {\n      this._popup.close();\n      this._popup = undefined;\n    }\n  }\n  requestToken = async (auth: any) => {\n    try {\n      const params = {\n        client: clientId,\n        code: auth.code,\n      };\n      const url = createURL(getTokenURL, params);\n      const req = await fetch(url);\n      const data = await req.json();\n      if (!data.access_token) {\n        throw new Error(JSON.stringify(data));\n      }\n      this._storageManager.set(patKey, data.access_token);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  logout = () => {\n    this._storageManager.delete(patKey);\n  }\n  login = () => {\n    this._closePopup();\n    this._state = `${Date.now()}-${Math.random()}`;  // does this need to special? Seems like no\n    const url = createURL('https://github.com/login/oauth/authorize', {\n      client_id: clientId,\n      scope: 'gist',\n      state: this._state,\n    });\n    this._popup = createPopup(url);\n  }\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {storageManager} from './globals.js';\nimport './index.css';\nimport './scrollbars.js';\nimport App from './components/App';\nimport BackupManager from './components/BackupManager.js';\nimport OAuthManager from './libs/OAuthManager';\nimport * as serviceWorker from './serviceWorker';\n\nconst oauthManager = new OAuthManager(storageManager);\nconst backupManager = new BackupManager(storageManager);\n\nReactDOM.render(\n  <React.StrictMode>\n    <App oauthManager={oauthManager} backupManager={backupManager} />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/vertical-layout.f248a432.svg\";","module.exports = __webpack_public_path__ + \"static/media/horizontal-layout.e3f3298b.svg\";","module.exports = __webpack_public_path__ + \"static/media/two-by-two-layout.23605ce8.svg\";","module.exports = __webpack_public_path__ + \"static/media/tabbed-layout.8a8b9bc8.svg\";"],"sourceRoot":""}